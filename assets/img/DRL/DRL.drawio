<mxfile host="Electron" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/28.2.5 Chrome/138.0.7204.251 Electron/37.6.1 Safari/537.36" version="28.2.5" pages="2">
  <diagram name="第 1 页" id="y9LEz4xKixKy7bdXyOA4">
    <mxGraphModel dx="1981" dy="1886" grid="1" gridSize="5" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="0" pageScale="1" pageWidth="1169" pageHeight="827" math="1" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="TIY0aofVLOKIE5Fzi-hh-1" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=none;strokeWidth=4;movable=0;resizable=0;rotatable=0;deletable=0;editable=0;locked=1;connectable=0;" parent="1" vertex="1">
          <mxGeometry x="-760" y="-980" width="4760" height="2120" as="geometry" />
        </mxCell>
        <mxCell id="balq-lUvnQ9j7pNHZ8tI-1" value="深度强化学习" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=25;strokeColor=default;strokeWidth=4;horizontal=1;" parent="1" vertex="1">
          <mxGeometry x="-20" width="40" height="250" as="geometry" />
        </mxCell>
        <mxCell id="balq-lUvnQ9j7pNHZ8tI-9" value="术语" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;fontSize=15;fontFamily=更纱黑体 SC;" parent="1" vertex="1">
          <mxGeometry x="40" y="100" width="100" height="150" as="geometry" />
        </mxCell>
        <mxCell id="balq-lUvnQ9j7pNHZ8tI-10" value="状态 \(\textcolor{green}{s \in \mathcal{S}}\)" style="text;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;fontFamily=更纱黑体 SC;fontSize=15;" parent="balq-lUvnQ9j7pNHZ8tI-9" vertex="1">
          <mxGeometry y="30" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="balq-lUvnQ9j7pNHZ8tI-11" value="动作 \(\textcolor{red}{a \in \mathcal{A}}\)" style="text;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;fontSize=15;fontFamily=更纱黑体 SC;" parent="balq-lUvnQ9j7pNHZ8tI-9" vertex="1">
          <mxGeometry y="60" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="balq-lUvnQ9j7pNHZ8tI-12" value="策略 \(\textcolor{purple}{\pi}(\textcolor{red}{a}&amp;nbsp;|\textcolor{green}{s})\)" style="text;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;fontSize=15;fontFamily=更纱黑体 SC;" parent="balq-lUvnQ9j7pNHZ8tI-9" vertex="1">
          <mxGeometry y="90" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="balq-lUvnQ9j7pNHZ8tI-13" value="奖励 \(\textcolor{blue}{r}\)" style="text;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;fontSize=15;fontFamily=更纱黑体 SC;" parent="balq-lUvnQ9j7pNHZ8tI-9" vertex="1">
          <mxGeometry y="120" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="balq-lUvnQ9j7pNHZ8tI-14" value="未观测时使用随机变量" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;fontSize=15;fontFamily=更纱黑体 SC;" parent="1" vertex="1">
          <mxGeometry x="170" y="100" width="170" height="150" as="geometry" />
        </mxCell>
        <mxCell id="balq-lUvnQ9j7pNHZ8tI-15" value="状态 \(\textcolor{green}{S}\)" style="text;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;fontFamily=更纱黑体 SC;fontSize=15;" parent="balq-lUvnQ9j7pNHZ8tI-14" vertex="1">
          <mxGeometry y="30" width="170" height="30" as="geometry" />
        </mxCell>
        <mxCell id="balq-lUvnQ9j7pNHZ8tI-16" value="动作 \(\textcolor{red}{A}\)" style="text;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;fontSize=15;fontFamily=更纱黑体 SC;" parent="balq-lUvnQ9j7pNHZ8tI-14" vertex="1">
          <mxGeometry y="60" width="170" height="30" as="geometry" />
        </mxCell>
        <mxCell id="balq-lUvnQ9j7pNHZ8tI-19" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;fontSize=15;fontFamily=更纱黑体 SC;" parent="balq-lUvnQ9j7pNHZ8tI-14" vertex="1">
          <mxGeometry y="90" width="170" height="30" as="geometry" />
        </mxCell>
        <mxCell id="balq-lUvnQ9j7pNHZ8tI-18" value="奖励 \(\textcolor{blue}{R}\)" style="text;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;fontSize=15;fontFamily=更纱黑体 SC;" parent="balq-lUvnQ9j7pNHZ8tI-14" vertex="1">
          <mxGeometry y="120" width="170" height="30" as="geometry" />
        </mxCell>
        <mxCell id="balq-lUvnQ9j7pNHZ8tI-20" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="balq-lUvnQ9j7pNHZ8tI-10" target="balq-lUvnQ9j7pNHZ8tI-15" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="balq-lUvnQ9j7pNHZ8tI-21" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="balq-lUvnQ9j7pNHZ8tI-11" target="balq-lUvnQ9j7pNHZ8tI-16" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="balq-lUvnQ9j7pNHZ8tI-22" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="balq-lUvnQ9j7pNHZ8tI-13" target="balq-lUvnQ9j7pNHZ8tI-18" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="balq-lUvnQ9j7pNHZ8tI-23" value="&lt;b style=&quot;&quot;&gt;&lt;font color=&quot;#7f00ff&quot;&gt;折扣回报&lt;/font&gt;&lt;/b&gt; \(U_t = \textcolor{blue}{R_t} + \gamma&amp;nbsp; \textcolor{blue}{R_{t+1}} + \gamma ^2&amp;nbsp; \textcolor{blue}{R_{t+2}} + \gamma ^3&amp;nbsp; \textcolor{blue}{R_{t+3}} + \cdots \)&lt;br&gt;\(\gamma\) ：折扣率" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeWidth=1;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="460" y="215" width="420" height="40" as="geometry" />
        </mxCell>
        <mxCell id="balq-lUvnQ9j7pNHZ8tI-26" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="balq-lUvnQ9j7pNHZ8tI-18" target="balq-lUvnQ9j7pNHZ8tI-23" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="395" y="220" as="sourcePoint" />
            <mxPoint x="445" y="290" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="P27bC8qoyPHywM3mTXsK-1" value="&lt;span style=&quot;font-family: &amp;quot;更纱黑体 SC&amp;quot;; font-size: 12px;&quot;&gt;奖励的累加&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="balq-lUvnQ9j7pNHZ8tI-26" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="PvOujxNg_PI-_giluGQt-7" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="balq-lUvnQ9j7pNHZ8tI-28" target="PvOujxNg_PI-_giluGQt-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="30Su1pwD8mxFyu5cslVr-1" value="在 \(t\) 时刻根据观测到的状态 \(\textcolor{green}{s_t}\) 做出动作 \(\textcolor{red}{a_t}\)，并在后续选择“最优策略”决策" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;" vertex="1" connectable="0" parent="PvOujxNg_PI-_giluGQt-7">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="balq-lUvnQ9j7pNHZ8tI-28" value="&lt;font color=&quot;#7f00ff&quot;&gt;&lt;b&gt;动作价值函数&lt;/b&gt;&lt;/font&gt; \(Q_{\pi}(\textcolor{green}{s_t}, \textcolor{red}{a_t}) = \mathbb{E}_{\textcolor{green}{S_{t+1}, S_{t+2}, \cdots}, \textcolor{red}{A_{t+1}, A_{t+2}, \cdots}}\left[U_t \middle| \textcolor{green}{S_t = s_t}, \textcolor{red}{A_t = a_t}\right]\)&lt;div&gt;表示后续动作根据策略 \(\pi\) 生成时，当前状态 \(\textcolor{green}{s_t}\) 下动作 \(\textcolor{red}{a_t}\) 的评分&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeWidth=1;strokeColor=#CCCCCC;points=[[0,0,0,0,0],[0,0.25,0,0,0],[0,0.5,0,0,0],[0,0.75,0,0,0],[0,1,0,0,0],[0.25,0,0,0,0],[0.25,1,0,0,0],[0.5,0,0,0,0],[0.5,1,0,0,0],[0.75,0,0,0,0],[0.9,1,0,0,0],[1,0,0,0,0],[1,0.25,0,0,0],[1,0.5,0,0,0],[1,0.75,0,0,0],[1,1,0,0,0]];" parent="1" vertex="1">
          <mxGeometry x="405" y="330" width="530" height="50" as="geometry" />
        </mxCell>
        <mxCell id="balq-lUvnQ9j7pNHZ8tI-31" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="balq-lUvnQ9j7pNHZ8tI-23" target="balq-lUvnQ9j7pNHZ8tI-28" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="635" y="40" as="sourcePoint" />
            <mxPoint x="745" y="120" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="P27bC8qoyPHywM3mTXsK-2" value="&lt;span&gt;在 \(t\) 时刻根据观测到的状态 \(\textcolor{green}{s_t}\) 做出动作 \(\textcolor{red}{a_t}\)，并在后续始终按策略 \(\pi\) 决策&lt;/span&gt;&lt;br&gt;&lt;span&gt;对未来的状态和动作 \(\textcolor{green}{S_{t+1}, S_{t+2}, \cdots}, \textcolor{red}{A_{t+1}, A_{t+2}, \cdots}\) 求期望&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;" parent="balq-lUvnQ9j7pNHZ8tI-31" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="PvOujxNg_PI-_giluGQt-1" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="balq-lUvnQ9j7pNHZ8tI-33" target="balq-lUvnQ9j7pNHZ8tI-23" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="balq-lUvnQ9j7pNHZ8tI-33" value="奖励 \(\textcolor{blue}{R_t}&lt;br&gt;\) 与当前状态 \(\textcolor{green}{S_t}&lt;br&gt;\) 和做出的动作 \(\textcolor{red}{A_t}&lt;br&gt;\) 有关" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;fontColor=default;strokeWidth=1;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="460" y="150" width="420" height="30" as="geometry" />
        </mxCell>
        <mxCell id="PvOujxNg_PI-_giluGQt-5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="PvOujxNg_PI-_giluGQt-2" target="balq-lUvnQ9j7pNHZ8tI-16" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="390" y="20" />
              <mxPoint x="390" y="175" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="PvOujxNg_PI-_giluGQt-2" value="动作的概率密度函数（策略函数）\(P\left\{\textcolor{red}{A=a}\middle|\textcolor{green}{S=s}\right\}= \pi (\textcolor{red}{a}&amp;nbsp;|\textcolor{green}{s})\)" style="text;html=1;align=right;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#B3B3B3;strokeWidth=0.5;" parent="1" vertex="1">
          <mxGeometry x="40" width="300" height="40" as="geometry" />
        </mxCell>
        <mxCell id="PvOujxNg_PI-_giluGQt-4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="PvOujxNg_PI-_giluGQt-3" target="balq-lUvnQ9j7pNHZ8tI-15" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="370" y="70" />
              <mxPoint x="370" y="145" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="PvOujxNg_PI-_giluGQt-3" value="状态的概率密度函数（状态转移函数）\(P\left\{\textcolor{green}{S&#39;=s&#39;}\middle|\textcolor{green}{S=s}, \textcolor{red}{A=a}\right\}= p(\textcolor{green}{s&#39;}&amp;nbsp;| \textcolor{green}{s}, \textcolor{red}{a})\)" style="text;html=1;align=right;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#B3B3B3;strokeWidth=0.5;" parent="1" vertex="1">
          <mxGeometry x="40" y="50" width="300" height="40" as="geometry" />
        </mxCell>
        <mxCell id="PvOujxNg_PI-_giluGQt-6" value="&lt;b&gt;&lt;font color=&quot;#7f00ff&quot;&gt;最优动作价值函数&lt;/font&gt;&lt;/b&gt; \(Q^{\star}(\textcolor{green}{s_t}, \textcolor{red}{a_t}) = \max\limits_{\pi} Q_{\pi}(\textcolor{green}{s_t}, \textcolor{red}{a_t})\)&lt;br&gt;表示状态 \(\textcolor{green}{s_t}\) 下做出动作 \(\textcolor{red}{a_t}\) 所能达到的最高分数，与策略 \(\pi\) 无关" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;fontColor=default;strokeColor=#CCCCCC;strokeWidth=1;" parent="1" vertex="1">
          <mxGeometry x="405" y="460" width="530" height="60" as="geometry" />
        </mxCell>
        <mxCell id="SyCfzCqmaqDro-8NCypD-2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" parent="1" source="PvOujxNg_PI-_giluGQt-8" target="SyCfzCqmaqDro-8NCypD-1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="eXLRdertSL_58YiXVpYG-2" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0;entryDx=0;entryDy=0;" parent="1" source="PvOujxNg_PI-_giluGQt-8" target="eXLRdertSL_58YiXVpYG-1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="l3KTNooECMtvP_L4lYXq-1" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="PvOujxNg_PI-_giluGQt-8" target="izn_Thb5sT5Ji-PQS5y_-1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="PvOujxNg_PI-_giluGQt-8" value="&lt;b&gt;&lt;font color=&quot;#7f00ff&quot;&gt;状态价值函数&lt;/font&gt;&lt;/b&gt; \(V_{\pi}(\textcolor{green}{s_t}) = \mathbb{E}_{\textcolor{red}{A}}\left[Q_{\pi}(\textcolor{green}{s_t}, \textcolor{red}{A})\right]\)&lt;br&gt;表示当前状态 \(\textcolor{green}{s_t}\) 的评分" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="1060" y="330" width="300" height="50" as="geometry" />
        </mxCell>
        <mxCell id="PvOujxNg_PI-_giluGQt-11" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="balq-lUvnQ9j7pNHZ8tI-28" target="PvOujxNg_PI-_giluGQt-8" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1220" y="170" as="sourcePoint" />
            <mxPoint x="1220" y="255" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="P27bC8qoyPHywM3mTXsK-6" value="&lt;span&gt;对动作 \(\textcolor{red}{A}\) 求期望&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;" parent="PvOujxNg_PI-_giluGQt-11" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="SyCfzCqmaqDro-8NCypD-9" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=1;entryY=1;entryDx=0;entryDy=0;" parent="1" source="PvOujxNg_PI-_giluGQt-13" target="SyCfzCqmaqDro-8NCypD-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="PvOujxNg_PI-_giluGQt-13" value="\(\mathbb{E}_{\textcolor{green}{S}}\left[V_{\pi}(\textcolor{green}{S})\right]\) 可以评估策略&amp;nbsp;\(\pi\) 的好坏" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="1500" y="330" width="260" height="50" as="geometry" />
        </mxCell>
        <mxCell id="PvOujxNg_PI-_giluGQt-14" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="PvOujxNg_PI-_giluGQt-8" target="PvOujxNg_PI-_giluGQt-13" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1475" y="335" as="sourcePoint" />
            <mxPoint x="1635" y="335" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="P27bC8qoyPHywM3mTXsK-11" value="&lt;span&gt;对状态 \(\textcolor{green}{S}\) 求期望&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;" parent="PvOujxNg_PI-_giluGQt-14" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="PvOujxNg_PI-_giluGQt-18" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="PvOujxNg_PI-_giluGQt-6" target="PvOujxNg_PI-_giluGQt-20" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="525" y="600" as="sourcePoint" />
            <mxPoint x="685" y="600" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="P27bC8qoyPHywM3mTXsK-3" value="&lt;span&gt;使用 \(Q^{\star}\) 决策&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;" parent="PvOujxNg_PI-_giluGQt-18" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="PvOujxNg_PI-_giluGQt-20" value="\(\textcolor{red}{a^{\star}} = \mathop{\text{argmax}}\limits_{\textcolor{red}{a}} \, Q^{\star}(\textcolor{green}{s}, \textcolor{red}{a})\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="60" y="465" width="180" height="50" as="geometry" />
        </mxCell>
        <mxCell id="PvOujxNg_PI-_giluGQt-23" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="PvOujxNg_PI-_giluGQt-20" target="P27bC8qoyPHywM3mTXsK-4" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="240" y="560" as="sourcePoint" />
            <mxPoint x="180" y="600" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="P27bC8qoyPHywM3mTXsK-5" value="&lt;span&gt;使用神经网络 \(Q(\textcolor{green}{s}, \textcolor{red}{a}; \omega)\) 近似 \(Q^{\star}(\textcolor{green}{s}, \textcolor{red}{a})\)&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;" parent="PvOujxNg_PI-_giluGQt-23" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="PvOujxNg_PI-_giluGQt-31" value="&lt;h1&gt;Deep Q-Network (DQN)&lt;/h1&gt;&lt;p&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;观察状态 \(\textcolor{green}{S_t = s_t}\) 并作出动作 \(\textcolor{red}{a_t} = \mathop{\text{argmax}}\limits_{\textcolor{red}{a}} \, Q(\textcolor{green}{s_t}, \textcolor{red}{a})\)&lt;/li&gt;&lt;li&gt;计算价值 \(q_t = Q(\textcolor{green}{s_t}, \textcolor{red}{a_t}; \omega_t)\)&lt;/li&gt;&lt;li&gt;环境给出奖励 \(\textcolor{blue}{r_t}\) 和新的状态 \(\textcolor{green}{s_{t+1}}\)&lt;/li&gt;&lt;li&gt;计算 TD target \(y_t = \textcolor{blue}{r_t} + \gamma \cdot Q(\textcolor{green}{s_{t+1}}, \textcolor{red}{a_{t+1}}; \omega_t) = \textcolor{blue}{r_t} + \gamma \cdot&amp;nbsp; \max\limits_{\textcolor{red}{a}} \, Q(\textcolor{green}{s_{t+1}}, \textcolor{red}{a}; \omega_t)\)&lt;/li&gt;&lt;li&gt;计算 TD error \(\delta_t = q_t - y_t\)&lt;/li&gt;&lt;li&gt;最小化 TD error，定义损失函数 \(L_t = \frac{1}{2} \delta_t^2\)&lt;/li&gt;&lt;li&gt;使用梯度下降最小化损失函数 \(\omega_{t+1} \leftarrow \omega_t - \alpha \cdot \frac{\partial L_t}{\partial \omega}|_{\omega = \omega_t}\)&lt;/li&gt;&lt;/ol&gt;其中 \(\frac{\partial L_t}{\partial \omega} = (q_t - y_t) \cdot \frac{\partial Q(\textcolor{green}{s_t}, \textcolor{red}{a_t}; \omega)}{\partial \omega}|_{\omega = \omega_t}\)&lt;br&gt;&lt;p&gt;&lt;/p&gt;" style="text;html=1;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;points=[[0,0,0,0,0],[0,0.25,0,0,0],[0,0.5,0,0,0],[0,0.75,0,0,0],[0,1,0,0,0],[0.25,0,0,0,0],[0.25,1,0,0,0],[0.5,0,0,0,0],[0.5,1,0,0,0],[0.75,0,0,0,0],[0.75,1,0,0,0],[1,0,0,0,0],[1,0.25,0,0,0],[1,0.5,0,0,0],[1,0.75,0,0,0],[1,1,0,0,0]];" parent="1" vertex="1">
          <mxGeometry x="-140" y="640" width="580" height="220" as="geometry" />
        </mxCell>
        <mxCell id="GTiSudV7kPfqIaCQHhIo-4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="P27bC8qoyPHywM3mTXsK-4" target="PvOujxNg_PI-_giluGQt-31" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="GTiSudV7kPfqIaCQHhIo-10" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=1;entryY=1;entryDx=0;entryDy=0;" parent="1" source="PvOujxNg_PI-_giluGQt-13" target="P27bC8qoyPHywM3mTXsK-9" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="915" y="-55" as="sourcePoint" />
            <mxPoint x="1390" y="-315" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="P27bC8qoyPHywM3mTXsK-12" value="&lt;span&gt;指导 \(\pi (\textcolor{red}{a}&amp;nbsp;|\textcolor{green}{s}; \theta)\) 的训练&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontStyle=0;fontFamily=更纱黑体 SC;fontSize=12;" parent="GTiSudV7kPfqIaCQHhIo-10" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="SyCfzCqmaqDro-8NCypD-1" value="\(V_{\pi}(\textcolor{green}{s_t}) = \mathbb{E}_{\textcolor{red}{A}}\left[Q_{\pi}(\textcolor{green}{s_t}, \textcolor{red}{A})\right] = \sum\limits_{\textcolor{red}{a}} \pi (\textcolor{red}{a}|\textcolor{green}{s_t}) \cdot Q_{\pi}(\textcolor{green}{s_t}, \textcolor{red}{a})\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="1020" y="215" width="380" height="40" as="geometry" />
        </mxCell>
        <mxCell id="SyCfzCqmaqDro-8NCypD-3" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" parent="1" source="SyCfzCqmaqDro-8NCypD-1" target="P27bC8qoyPHywM3mTXsK-9" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2015" y="195" as="sourcePoint" />
            <mxPoint x="845" y="-180" as="targetPoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="P27bC8qoyPHywM3mTXsK-10" value="&lt;span&gt;使用神经网络 \(\pi (\textcolor{red}{a}&amp;nbsp;|\textcolor{green}{s}; \theta)\) 近似策略函数 \(\pi (\textcolor{red}{a}&amp;nbsp;|\textcolor{green}{s})\)&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;" parent="SyCfzCqmaqDro-8NCypD-3" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="SyCfzCqmaqDro-8NCypD-8" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" parent="1" source="SyCfzCqmaqDro-8NCypD-5" target="SyCfzCqmaqDro-8NCypD-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="EvWbkenpNFQ4OY3uyWhH-4" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;" parent="1" source="SyCfzCqmaqDro-8NCypD-5" target="SyCfzCqmaqDro-8NCypD-13" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="FhUIJi_ACO7DtZTB_gNP-9" value="代入；交换求导和求和顺序" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;fillColor=none;gradientColor=none;" parent="EvWbkenpNFQ4OY3uyWhH-4" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="SvYFlbn8YFz6SzjA_q7s-5" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;" parent="1" source="SyCfzCqmaqDro-8NCypD-5" target="SvYFlbn8YFz6SzjA_q7s-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="l3KTNooECMtvP_L4lYXq-3" value="&lt;font style=&quot;font-size: 12px;&quot;&gt;等价变换&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;" parent="SvYFlbn8YFz6SzjA_q7s-5" vertex="1" connectable="0">
          <mxGeometry x="0.0462" y="1" relative="1" as="geometry">
            <mxPoint x="42" y="-1" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="SyCfzCqmaqDro-8NCypD-5" value="\(V(\textcolor{green}{s_t}; \theta) = \sum\limits_{\textcolor{red}{a}} \pi (\textcolor{red}{a}|\textcolor{green}{s_t}; \theta) \cdot Q_{\pi}(\textcolor{green}{s_t}, \textcolor{red}{a})\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="920" y="20" width="580" height="40" as="geometry" />
        </mxCell>
        <mxCell id="SyCfzCqmaqDro-8NCypD-6" value="更新策略网络参数 \(\theta\) 最大化 \(J(\theta) =\mathbb{E}_{\textcolor{green}{S}}\left[V(\textcolor{green}{S}; \theta)\right]\)（使策略函数最好）" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="920" y="-60" width="580" height="40" as="geometry" />
        </mxCell>
        <mxCell id="SyCfzCqmaqDro-8NCypD-11" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="SyCfzCqmaqDro-8NCypD-6" target="SyCfzCqmaqDro-8NCypD-13" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1740" y="5" as="sourcePoint" />
            <mxPoint x="1740" y="-130" as="targetPoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="FhUIJi_ACO7DtZTB_gNP-8" value="使用策略梯度上升最大化 \(J(\theta)\)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;fillColor=none;gradientColor=none;" parent="SyCfzCqmaqDro-8NCypD-11" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="EvWbkenpNFQ4OY3uyWhH-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.75;exitDx=0;exitDy=0;entryX=0;entryY=0.75;entryDx=0;entryDy=0;fontSize=10;" parent="1" source="SyCfzCqmaqDro-8NCypD-13" target="SyCfzCqmaqDro-8NCypD-17" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="EvWbkenpNFQ4OY3uyWhH-8" value="计算策略梯度" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontFamily=更纱黑体 SC;" parent="EvWbkenpNFQ4OY3uyWhH-6" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="SyCfzCqmaqDro-8NCypD-13" value="\(\theta_{t+1} \leftarrow \theta_t + \beta \cdot \frac{\partial V(\textcolor{green}{s}; \theta)}{\partial \theta}\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="1720" y="-65" width="200" height="50" as="geometry" />
        </mxCell>
        <mxCell id="SyCfzCqmaqDro-8NCypD-27" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="SyCfzCqmaqDro-8NCypD-16" target="SyCfzCqmaqDro-8NCypD-25" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="q9_H8KjKrdg0DEyqKkux-4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="SyCfzCqmaqDro-8NCypD-16" target="q9_H8KjKrdg0DEyqKkux-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UfZ2qnKndyfp9CoiRrid-21" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.25;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" parent="1" source="SyCfzCqmaqDro-8NCypD-16" target="UfZ2qnKndyfp9CoiRrid-19" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SyCfzCqmaqDro-8NCypD-16" value="\(\frac{\partial V(\textcolor{green}{s}; \theta)}{\partial \theta} = \mathbb{E}_{\textcolor{red}{A}}\left[\frac{\partial \ln \pi (\textcolor{red}{A}&amp;nbsp;| \textcolor{green}{s}; \theta)}{\partial \theta} \cdot&amp;nbsp;Q_{\pi}(\textcolor{green}{s}, \textcolor{red}{A})\right]\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="2240" y="150" width="460" height="50" as="geometry" />
        </mxCell>
        <mxCell id="EvWbkenpNFQ4OY3uyWhH-7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.25;exitDx=0;exitDy=0;entryX=1;entryY=0.25;entryDx=0;entryDy=0;fontSize=10;fontFamily=更纱黑体 SC;" parent="1" source="SyCfzCqmaqDro-8NCypD-17" target="SyCfzCqmaqDro-8NCypD-13" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="FhUIJi_ACO7DtZTB_gNP-13" value="使用策略梯度更新策略网络" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;fillColor=none;gradientColor=none;" parent="EvWbkenpNFQ4OY3uyWhH-7" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="SyCfzCqmaqDro-8NCypD-17" value="&lt;b&gt;&lt;font color=&quot;#7f00ff&quot;&gt;策略梯度&lt;/font&gt;&lt;/b&gt; \(\frac{\partial V(\textcolor{green}{s}; \theta)}{\partial \theta} =\sum\limits_{\textcolor{red}{a}} \frac{\partial \pi (\textcolor{red}{a}|\textcolor{green}{s}; \theta)}{\partial \theta} \cdot Q_{\pi}(\textcolor{green}{s}, \textcolor{red}{a})&lt;br&gt;\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="2240" y="-65" width="460" height="50" as="geometry" />
        </mxCell>
        <mxCell id="SyCfzCqmaqDro-8NCypD-19" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="SyCfzCqmaqDro-8NCypD-17" target="SyCfzCqmaqDro-8NCypD-21" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2025" y="165" as="sourcePoint" />
            <mxPoint x="2115" y="195" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="FhUIJi_ACO7DtZTB_gNP-12" value="\(\frac{\partial \ln \pi (\theta)}{\partial \theta} = \frac{1}{\pi (\theta)} \cdot \frac{\partial \pi (\theta)}{\partial \theta}\)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;fillColor=none;gradientColor=none;" parent="SyCfzCqmaqDro-8NCypD-19" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="SyCfzCqmaqDro-8NCypD-22" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="SyCfzCqmaqDro-8NCypD-21" target="SyCfzCqmaqDro-8NCypD-16" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SyCfzCqmaqDro-8NCypD-21" value="\(\frac{\partial V(\textcolor{green}{s}; \theta)}{\partial \theta} = \sum\limits_{\textcolor{red}{a}} \pi (\textcolor{red}{a}|\textcolor{green}{s}; \theta) \cdot&amp;nbsp;\frac{\partial \ln \pi (\textcolor{red}{a}&amp;nbsp;| \textcolor{green}{s}; \theta)}{\partial \theta} \cdot&amp;nbsp;Q_{\pi}(\textcolor{green}{s}, \textcolor{red}{a})\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="2240" y="60" width="460" height="50" as="geometry" />
        </mxCell>
        <mxCell id="SyCfzCqmaqDro-8NCypD-29" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="SyCfzCqmaqDro-8NCypD-25" target="SyCfzCqmaqDro-8NCypD-28" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SyCfzCqmaqDro-8NCypD-25" value="&lt;h1&gt;使用蒙特卡罗方法估计策略梯度&lt;/h1&gt;&lt;p&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;根据策略 \(\pi (\cdot |\textcolor{green}{s}; \theta)\) 随机抽样动作 \(\textcolor{red}{\hat{a}}\)&lt;/li&gt;&lt;li&gt;计算随机策略梯度 \(g(\textcolor{red}{\hat{a}}, \theta) =&amp;nbsp;\frac{\partial \ln \pi (\textcolor{red}{\hat{a}}&amp;nbsp;| \textcolor{green}{s}; \theta)}{\partial \theta} \cdot&amp;nbsp;Q_{\pi}(\textcolor{green}{s}, \textcolor{red}{\hat{a}})\)&lt;/li&gt;&lt;/ol&gt;因为 \(\mathbb{E}_{\textcolor{red}{A}}\left[g(\textcolor{red}{A}, \theta)\right] =\frac{\partial V(\textcolor{green}{s}; \theta)}{\partial \theta}\) 所以&amp;nbsp;\(g(\textcolor{red}{\hat{a}}, \theta)\) 是 \(\frac{\partial V(\textcolor{green}{s}; \theta)}{\partial \theta}\) 的无偏估计&lt;br&gt;&lt;p&gt;&lt;/p&gt;" style="text;html=1;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontFamily=更纱黑体 SC;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="2740" y="105" width="400" height="140" as="geometry" />
        </mxCell>
        <mxCell id="FhUIJi_ACO7DtZTB_gNP-35" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;resizable=0;" parent="1" source="SyCfzCqmaqDro-8NCypD-28" target="SyCfzCqmaqDro-8NCypD-30" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="FhUIJi_ACO7DtZTB_gNP-36" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;resizable=0;" parent="1" source="SyCfzCqmaqDro-8NCypD-28" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="3540" y="175" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="SyCfzCqmaqDro-8NCypD-28" value="如何计算 \(Q_{\pi}(\textcolor{green}{s}, \textcolor{red}{\hat{a}})\) ？" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="3180" y="155" width="220" height="40" as="geometry" />
        </mxCell>
        <mxCell id="SyCfzCqmaqDro-8NCypD-30" value="&lt;h1&gt;REINFORCE&lt;/h1&gt;&lt;p&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;完成一整局游戏 \(\textcolor{green}{s_1},\textcolor{red}{a_1}, \textcolor{blue}{r_1}, \textcolor{green}{s_2},\textcolor{red}{a_2}, \textcolor{blue}{r_2}, \cdots, \textcolor{green}{s_T},\textcolor{red}{a_T}, \textcolor{blue}{r_T}\)&lt;/li&gt;&lt;li&gt;使用 \(u_t = \sum\limits_{k=t}^{T} \gamma^{k-t} \textcolor{blue}{r_k}\) 近似 \(Q_{\pi}(\textcolor{green}{s_t}, \textcolor{red}{a_t})\)&lt;/li&gt;&lt;li&gt;梯度上升更新策略网络参数 \(\theta_{t+1} \leftarrow \theta_t + \beta \cdot g(\textcolor{red}{a_t}, \theta_t) = \theta_t + \beta \cdot u_t \cdot \frac{\partial \ln \pi (\textcolor{red}{a_t}|\textcolor{green}{s_t};\theta)}{\partial \theta}&amp;nbsp;|_{\theta = \theta_t}\)&lt;/li&gt;&lt;/ol&gt;&lt;div&gt;一整局游戏 \(\textcolor{green}{s_1},\textcolor{red}{a_1}, \textcolor{blue}{r_1}, \textcolor{green}{s_2},\textcolor{red}{a_2}, \textcolor{blue}{r_2}, \cdots, \textcolor{green}{s_T},\textcolor{red}{a_T}, \textcolor{blue}{r_T}\)&amp;nbsp;结束后，进行 \(T\) 轮更新，分别使用 \(t = 1, 2, \dots, T\) 更新策略网络；然后进行下一局游戏&lt;/div&gt;&lt;p&gt;&lt;/p&gt;" style="text;html=1;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;" parent="1" vertex="1">
          <mxGeometry x="3080" y="-110" width="420" height="190" as="geometry" />
        </mxCell>
        <mxCell id="SyCfzCqmaqDro-8NCypD-32" value="&lt;h1&gt;Actor-Critic&lt;/h1&gt;&lt;p&gt;&lt;/p&gt;使用神经网络 \(q(\textcolor{green}{s}, \textcolor{red}{a}; \omega)\) 近似&amp;nbsp;\(Q_{\pi}(\textcolor{green}{s}, \textcolor{red}{a})\) （将状态的特征向量和动作的特征向量拼接起来作为价值网络的输出&lt;br&gt;&lt;ul&gt;&lt;li&gt;Actor：策略网络 \(\pi (\textcolor{red}{a}|\textcolor{green}{s};\theta)\)&lt;/li&gt;&lt;li&gt;Critic：价值网络 \(q(\textcolor{green}{s}, \textcolor{red}{a}; \omega)\)&lt;/li&gt;&lt;/ul&gt;训练流程：&lt;br&gt;&lt;ol&gt;&lt;li&gt;观察状态 \(\textcolor{green}{s_t}\) 并随机抽样动作 \(\textcolor{red}{a_t} \sim \pi (\cdot | \textcolor{green}{s_t}; \theta_t)\)&lt;/li&gt;&lt;li&gt;执行动作 \(\textcolor{red}{a_t}\) 得到环境的新状态 \(\textcolor{green}{s_{t+1}}\) 和奖励 \(\textcolor{blue}{r_t}\)&lt;/li&gt;&lt;li&gt;针对新状态抽样下一个动作 \(\textcolor{red}{\tilde{a}_t} \sim \pi (\cdot | \textcolor{green}{s_{t+1}}; \theta_t)\) 但不执行&lt;/li&gt;&lt;li&gt;计算 \(q_t = q(\textcolor{green}{s_t}, \textcolor{red}{a_t}; \omega_t)\) 以及 \(q_{t+1} = q(\textcolor{green}{s_{t+1}}, \textcolor{red}{\tilde{a}_{t+1}}; \omega_t)\)&lt;/li&gt;&lt;li&gt;计算 TD target \(y_t = \textcolor{blue}{r_t} + \gamma \cdot q_{t+1}\)&lt;/li&gt;&lt;li&gt;计算 TD error \(\delta_t = q_t - y_t\)&lt;/li&gt;&lt;li&gt;计算价值网络的梯度 \(\text{d}_{\omega, t} = \frac{\partial q(\textcolor{green}{s_t}, \textcolor{red}{a_t}; \omega)}{\partial \omega} |_{\omega = \omega_t}\)&lt;/li&gt;&lt;li&gt;&lt;font color=&quot;#ff0000&quot;&gt;梯度下降更新价值网络参数&lt;/font&gt;&amp;nbsp;\(\omega_{t+1} = \omega_t - \alpha \cdot \delta_t \cdot \text{d}_{\omega, t}\)&lt;/li&gt;&lt;li&gt;计算策略网络的梯度 \(\text{d}_{\theta, t} = \frac{\partial \ln \pi (\textcolor{red}{a_t}|\textcolor{green}{s_t};\theta)}{\partial \theta} |_{\theta = \theta_t}\)&lt;/li&gt;&lt;li&gt;&lt;font color=&quot;#ff0000&quot;&gt;梯度上升更新策略网络参数&lt;/font&gt;&amp;nbsp;\(\theta_{t+1} = \theta_t + \beta \cdot q_t \cdot \text{d}_{\theta, t}\)&lt;/li&gt;&lt;/ol&gt;使用 TD 算法更新价值网络；使用策略梯度更新策略网络&lt;br&gt;&lt;p&gt;&lt;/p&gt;" style="text;html=1;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;movable=1;resizable=1;rotatable=1;deletable=1;editable=1;locked=0;connectable=1;" parent="1" vertex="1">
          <mxGeometry x="3540" y="-40" width="440" height="350" as="geometry" />
        </mxCell>
        <mxCell id="6BIXGAu9MWnwWbgmlWj4-17" value="TD 算法" style="shape=table;startSize=30;container=1;collapsible=0;childLayout=tableLayout;fontFamily=更纱黑体 SC;fontSize=15;" parent="1" vertex="1">
          <mxGeometry x="620" y="860" width="740" height="260" as="geometry" />
        </mxCell>
        <mxCell id="6BIXGAu9MWnwWbgmlWj4-18" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="6BIXGAu9MWnwWbgmlWj4-17" vertex="1">
          <mxGeometry y="30" width="740" height="58" as="geometry" />
        </mxCell>
        <mxCell id="6BIXGAu9MWnwWbgmlWj4-19" value="" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=更纱黑体 SC;fontSize=16;" parent="6BIXGAu9MWnwWbgmlWj4-18" vertex="1">
          <mxGeometry width="100" height="58" as="geometry">
            <mxRectangle width="100" height="58" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="6BIXGAu9MWnwWbgmlWj4-20" value="Sarsa 算法" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=更纱黑体 SC;fontSize=16;" parent="6BIXGAu9MWnwWbgmlWj4-18" vertex="1">
          <mxGeometry x="100" width="300" height="58" as="geometry">
            <mxRectangle width="300" height="58" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="6BIXGAu9MWnwWbgmlWj4-21" value="Q-Learning 算法" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=更纱黑体 SC;fontSize=16;" parent="6BIXGAu9MWnwWbgmlWj4-18" vertex="1">
          <mxGeometry x="400" width="340" height="58" as="geometry">
            <mxRectangle width="340" height="58" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="6BIXGAu9MWnwWbgmlWj4-23" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="6BIXGAu9MWnwWbgmlWj4-17" vertex="1">
          <mxGeometry y="88" width="740" height="58" as="geometry" />
        </mxCell>
        <mxCell id="6BIXGAu9MWnwWbgmlWj4-24" value="特点" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=更纱黑体 SC;fontSize=16;" parent="6BIXGAu9MWnwWbgmlWj4-23" vertex="1">
          <mxGeometry width="100" height="58" as="geometry">
            <mxRectangle width="100" height="58" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="6BIXGAu9MWnwWbgmlWj4-25" value="计算 TD target 使用的动作来自策略函数&lt;br style=&quot;font-size: 16px;&quot;&gt;\(\textcolor{red}{a_{t+1}} \sim \pi (\cdot | \textcolor{green}{s_{t+1}})\)" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=更纱黑体 SC;fontSize=16;" parent="6BIXGAu9MWnwWbgmlWj4-23" vertex="1">
          <mxGeometry x="100" width="300" height="58" as="geometry">
            <mxRectangle width="300" height="58" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="6BIXGAu9MWnwWbgmlWj4-26" value="计算 TD target 使用的动作为价值最高的动作&lt;div style=&quot;font-size: 16px;&quot;&gt;\(\textcolor{red}{a_{t+1}} = \mathop{\text{argmax}}\limits_{\textcolor{red}{a}} \, Q^{\star}(\textcolor{green}{s_{t+1}}, \textcolor{red}{a})\)&lt;br style=&quot;font-size: 16px;&quot;&gt;&lt;/div&gt;" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=更纱黑体 SC;fontSize=16;" parent="6BIXGAu9MWnwWbgmlWj4-23" vertex="1">
          <mxGeometry x="400" width="340" height="58" as="geometry">
            <mxRectangle width="340" height="58" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="6BIXGAu9MWnwWbgmlWj4-28" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="6BIXGAu9MWnwWbgmlWj4-17" vertex="1">
          <mxGeometry y="146" width="740" height="57" as="geometry" />
        </mxCell>
        <mxCell id="6BIXGAu9MWnwWbgmlWj4-29" value="TD target" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=更纱黑体 SC;fontSize=16;" parent="6BIXGAu9MWnwWbgmlWj4-28" vertex="1">
          <mxGeometry width="100" height="57" as="geometry">
            <mxRectangle width="100" height="57" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="6BIXGAu9MWnwWbgmlWj4-30" value="\(y_t = \textcolor{blue}{r_t} + \gamma \cdot&amp;nbsp;q(\textcolor{green}{s_{t+1}}, \textcolor{red}{a_{t+1}}; \omega_t)\)" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=更纱黑体 SC;fontSize=16;" parent="6BIXGAu9MWnwWbgmlWj4-28" vertex="1">
          <mxGeometry x="100" width="300" height="57" as="geometry">
            <mxRectangle width="300" height="57" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="6BIXGAu9MWnwWbgmlWj4-31" value="\(y_t = \textcolor{blue}{r_t} + \gamma \cdot&amp;nbsp; \max\limits_{\textcolor{red}{a}} \, Q(\textcolor{green}{s_{t+1}}, \textcolor{red}{a}; \omega_t)\)" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=更纱黑体 SC;fontSize=16;" parent="6BIXGAu9MWnwWbgmlWj4-28" vertex="1">
          <mxGeometry x="400" width="340" height="57" as="geometry">
            <mxRectangle width="340" height="57" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="6BIXGAu9MWnwWbgmlWj4-33" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="6BIXGAu9MWnwWbgmlWj4-17" vertex="1">
          <mxGeometry y="203" width="740" height="57" as="geometry" />
        </mxCell>
        <mxCell id="6BIXGAu9MWnwWbgmlWj4-34" value="应用" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=更纱黑体 SC;fontSize=16;" parent="6BIXGAu9MWnwWbgmlWj4-33" vertex="1">
          <mxGeometry width="100" height="57" as="geometry">
            <mxRectangle width="100" height="57" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="6BIXGAu9MWnwWbgmlWj4-35" value="Actor-Critic" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=更纱黑体 SC;fontSize=16;" parent="6BIXGAu9MWnwWbgmlWj4-33" vertex="1">
          <mxGeometry x="100" width="300" height="57" as="geometry">
            <mxRectangle width="300" height="57" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="6BIXGAu9MWnwWbgmlWj4-36" value="DQN" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=更纱黑体 SC;fontSize=16;" parent="6BIXGAu9MWnwWbgmlWj4-33" vertex="1">
          <mxGeometry x="400" width="340" height="57" as="geometry">
            <mxRectangle width="340" height="57" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="xWbyx14W-sS9poavNBE--2" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.25;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="xWbyx14W-sS9poavNBE--1" target="PvOujxNg_PI-_giluGQt-31" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="xWbyx14W-sS9poavNBE--1" value="&lt;b&gt;DQN高级技巧：Experience Replay&lt;/b&gt;&lt;br&gt;&lt;ul&gt;&lt;li&gt;将轨迹 \((\textcolor{green}{s_i}, \textcolor{red}{a_i}, \textcolor{blue}{r_i}, \textcolor{green}{s_{t+i}})\) 存入 Replay Buffer 中&lt;/li&gt;&lt;li&gt;Replay Buffer 中储存最新的 \(N (10^5 \sim 10^6)\) 条轨迹&lt;/li&gt;&lt;li&gt;从 Replay Buffer 中随机抽样 \(T\) (batch size) 条轨迹&lt;/li&gt;&lt;li&gt;使用所有轨迹的均方误差（TD error 平方的平均值）作为损失函数：\(L = \frac{1}{T} \sum\limits_{t=1}^{T} \frac{1}{2} \delta_t^2\)&lt;/li&gt;&lt;/ul&gt;提高轨迹的利用率；消除轨迹之间的相关性" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;dashed=1;" parent="1" vertex="1">
          <mxGeometry x="-720" y="530" width="500" height="140" as="geometry" />
        </mxCell>
        <mxCell id="IHrG76bQpzaMnzpT1RNZ-1" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="xWbyx14W-sS9poavNBE--3" target="PvOujxNg_PI-_giluGQt-31" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="xWbyx14W-sS9poavNBE--3" value="&lt;b&gt;DQN高级技巧：target network&lt;/b&gt;&lt;br&gt;&lt;ul&gt;&lt;li&gt;定义 target network \(Q(\textcolor{green}{s}, \textcolor{red}{a}; \omega^-)\)&lt;/li&gt;&lt;li&gt;初始将 DQN 的网络参数赋值给 target network: \(\omega^- \leftarrow \omega\)&lt;/li&gt;&lt;li&gt;每 \(N_{update}\) 个 step 后更新 target network 的参数&lt;/li&gt;&lt;ul&gt;&lt;li&gt;直接使用 DQN 的参数：\(\omega^- \leftarrow \omega\)&lt;/li&gt;&lt;li&gt;使用 DQN 和 target network 的加权平均：\(\omega^- \leftarrow \tau \cdot \omega + (1-\tau) \cdot \omega^-\)&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;在计算 TD target 时使用 target network: \(y_t = \textcolor{blue}{r_t} + \gamma \cdot&amp;nbsp; \max\limits_{\textcolor{red}{a}} \, Q(\textcolor{green}{s_{t+1}}, \textcolor{red}{a}; \omega_t^-)\)&lt;/li&gt;&lt;/ul&gt;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;dashed=1;" parent="1" vertex="1">
          <mxGeometry x="-720" y="680" width="500" height="140" as="geometry" />
        </mxCell>
        <mxCell id="izn_Thb5sT5Ji-PQS5y_-1" value="&lt;b&gt;&lt;font color=&quot;#7f00ff&quot;&gt;最优状态价值函数&lt;/font&gt;&lt;/b&gt; \(V^{\star}(\textcolor{green}{s_t}) = \max\limits_{\pi} V_{\pi}(\textcolor{green}{s_t})\)&lt;br&gt;表示状态 \(\textcolor{green}{s_t}\) 的好坏程度，与策略 \(\pi\) 无关" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="1060" y="460" width="300" height="60" as="geometry" />
        </mxCell>
        <mxCell id="izn_Thb5sT5Ji-PQS5y_-12" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0.75;entryY=0;entryDx=0;entryDy=0;" parent="1" source="izn_Thb5sT5Ji-PQS5y_-2" target="izn_Thb5sT5Ji-PQS5y_-11" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="855" y="735" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="P27bC8qoyPHywM3mTXsK-8" value="&lt;span&gt;等式变形&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;" parent="izn_Thb5sT5Ji-PQS5y_-12" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="sJqLkv-XOYl5UadH0FZE-13" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;dashed=1;" parent="1" source="izn_Thb5sT5Ji-PQS5y_-2" target="sJqLkv-XOYl5UadH0FZE-10" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1240" y="600" />
              <mxPoint x="2255" y="600" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="izn_Thb5sT5Ji-PQS5y_-2" value="&lt;b&gt;&lt;font color=&quot;#7f00ff&quot;&gt;最优优势函数&lt;/font&gt;&lt;/b&gt; \(A^{\star}(\textcolor{green}{s_t}, \textcolor{red}{a_t}) = Q^{\star}(\textcolor{green}{s_t}, \textcolor{red}{a_t})&amp;nbsp;- V^{\star}(\textcolor{green}{s_t})\)&lt;br&gt;表示动作 \(\textcolor{red}{a_t}\) 相对于 baseline \(V^{\star}(\textcolor{green}{s_t})\) 的优势大小" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;points=[[0,0,0,0,0],[0,0.25,0,0,0],[0,0.5,0,0,0],[0,0.75,0,0,0],[0,1,0,0,0],[0.25,1,0,0,0],[0.33,0,0,0,0],[0.5,0,0,0,0],[0.5,1,0,0,0],[0.66,0,0,0,0],[0.75,1,0,0,0],[1,0,0,0,0],[1,0.25,0,0,0],[1,0.5,0,0,0],[1,0.75,0,0,0],[1,1,0,0,0]];" parent="1" vertex="1">
          <mxGeometry x="830" y="575" width="370" height="50" as="geometry" />
        </mxCell>
        <mxCell id="izn_Thb5sT5Ji-PQS5y_-5" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="izn_Thb5sT5Ji-PQS5y_-2" target="izn_Thb5sT5Ji-PQS5y_-7" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1045" y="695" as="sourcePoint" />
            <mxPoint x="1110" y="655" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="izn_Thb5sT5Ji-PQS5y_-6" value="对动作 \(\textcolor{red}{a_t}\) 求最大值" style="edgeLabel;resizable=0;html=1;;align=center;verticalAlign=middle;fontSize=12;fontFamily=更纱黑体 SC;" parent="izn_Thb5sT5Ji-PQS5y_-5" connectable="0" vertex="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="izn_Thb5sT5Ji-PQS5y_-7" value="\(\max\limits_{\textcolor{red}{a}} \,&amp;nbsp;A^{\star}(\textcolor{green}{s}, \textcolor{red}{a}) = \max\limits_{\textcolor{red}{a}} \,&amp;nbsp;Q^{\star}(\textcolor{green}{s}, \textcolor{red}{a})&amp;nbsp;- V^{\star}(\textcolor{green}{s})\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="860" y="690" width="310" height="50" as="geometry" />
        </mxCell>
        <mxCell id="izn_Thb5sT5Ji-PQS5y_-8" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="izn_Thb5sT5Ji-PQS5y_-7" target="izn_Thb5sT5Ji-PQS5y_-10" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1109.58" y="760" as="sourcePoint" />
            <mxPoint x="1109.58" y="830" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="izn_Thb5sT5Ji-PQS5y_-9" value="使用已知结论 \(V^{\star}(\textcolor{green}{s}) =&amp;nbsp;\max\limits_{\textcolor{red}{a}} \,&amp;nbsp;Q^{\star}(\textcolor{green}{s}, \textcolor{red}{a})\)" style="edgeLabel;resizable=0;html=1;;align=center;verticalAlign=middle;fontSize=12;fontFamily=更纱黑体 SC;" parent="izn_Thb5sT5Ji-PQS5y_-8" connectable="0" vertex="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="izn_Thb5sT5Ji-PQS5y_-13" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0.75;entryY=1;entryDx=0;entryDy=0;" parent="1" source="izn_Thb5sT5Ji-PQS5y_-10" target="izn_Thb5sT5Ji-PQS5y_-11" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="850" y="770" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="P27bC8qoyPHywM3mTXsK-7" value="&lt;span&gt;减 \(0\)&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;" parent="izn_Thb5sT5Ji-PQS5y_-13" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="izn_Thb5sT5Ji-PQS5y_-10" value="\(\max\limits_{\textcolor{red}{a}} \,&amp;nbsp;A^{\star}(\textcolor{green}{s}, \textcolor{red}{a}) = 0\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="830" y="805" width="370" height="40" as="geometry" />
        </mxCell>
        <mxCell id="IHrG76bQpzaMnzpT1RNZ-5" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.25;exitY=1;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;" parent="1" source="izn_Thb5sT5Ji-PQS5y_-11" target="IHrG76bQpzaMnzpT1RNZ-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="izn_Thb5sT5Ji-PQS5y_-11" value="\(Q^{\star}(\textcolor{green}{s}, \textcolor{red}{a}) = V^{\star}(\textcolor{green}{s}) +&amp;nbsp;A^{\star}(\textcolor{green}{s}, \textcolor{red}{a}) -\max\limits_{\textcolor{red}{a}} \,&amp;nbsp;A^{\star}(\textcolor{green}{s}, \textcolor{red}{a})\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="480" y="690" width="360" height="50" as="geometry" />
        </mxCell>
        <mxCell id="IHrG76bQpzaMnzpT1RNZ-2" value="&lt;b&gt;&lt;font style=&quot;font-size: 24px;&quot;&gt;&amp;nbsp;Dueling Network&lt;/font&gt;&lt;/b&gt;&lt;br&gt;&lt;ul&gt;&lt;li&gt;使用神经网络 \(A(\textcolor{green}{s}, \textcolor{red}{a}; \omega^{A})\) 近似优势函数 \(A^{\star}(\textcolor{green}{s}, \textcolor{red}{a})\) ，其结构与 DQN 相同，输出所有动作的评分&lt;/li&gt;&lt;li&gt;使用神经网络 \(V(\textcolor{green}{s}; \omega^{V})\) 近似状态价值函数 \(V^{\star}(\textcolor{green}{s})\) ，输出一个标量&lt;/li&gt;&lt;li&gt;构建 Dueling Network \(Q(\textcolor{green}{s}, \textcolor{red}{a}; \omega^{A}, \omega^{V}) = V(\textcolor{green}{s}; \omega^{V}) + A(\textcolor{green}{s}, \textcolor{red}{a}; \omega^{A}) - \max\limits_{\textcolor{red}{a}} \, A(\textcolor{green}{s}, \textcolor{red}{a}; \omega^{A})\)&lt;/li&gt;&lt;ul&gt;&lt;li&gt;\(Q\) 输出的每一个分量等于 \(A\) 输出的各个分量加上 \(V\) 的值，再减去 \(A\) 输出的最大值&lt;/li&gt;&lt;li&gt;\(A\) 和 \(V\) 的参数需要同时训练&lt;br&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;Dueling Network 的训练方法与 DQN 完全相同，都是使用 TD 算法。经验回放、target network、Double DQN 这些高级技巧同样适用于 Dueling Network。&lt;br&gt;&lt;br&gt;\(Q(\textcolor{green}{s}, \textcolor{red}{a}; \omega^{A}, \omega^{V}) = V(\textcolor{green}{s}; \omega^{V}) + A(\textcolor{green}{s}, \textcolor{red}{a}; \omega^{A}) - \mathop{\text{mean}}\limits_{\textcolor{red}{a}} \, A(\textcolor{green}{s}, \textcolor{red}{a}; \omega^{A})\) 减去 \(A\) 输出的平均值比减去&amp;nbsp;\(A\) 输出的最大值效果更好" style="text;html=1;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;" parent="1" vertex="1">
          <mxGeometry x="-140" y="880" width="580" height="240" as="geometry" />
        </mxCell>
        <mxCell id="q9_H8KjKrdg0DEyqKkux-6" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.25;entryY=0;entryDx=0;entryDy=0;fontSize=10;edgeStyle=orthogonalEdgeStyle;" parent="1" source="q9_H8KjKrdg0DEyqKkux-2" target="q9_H8KjKrdg0DEyqKkux-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="FhUIJi_ACO7DtZTB_gNP-11" value="减 \(0\)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;fillColor=none;gradientColor=none;" parent="q9_H8KjKrdg0DEyqKkux-6" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="q9_H8KjKrdg0DEyqKkux-2" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;对于任意一个与动作 \(\textcolor{red}{A}\) 无关的 baseline 函数 \(\textcolor{magenta}{b}\) 具有下面的性质：&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;\(\begin{split} &amp;amp;\mathbb{E}_{\textcolor{red}{A}}\left[\textcolor{magenta}{b} \cdot \frac{\partial \ln \pi (\textcolor{red}{A} | \textcolor{green}{s}; \theta)}{\partial \theta}\right] \\ =&amp;amp; \textcolor{magenta}{b} \cdot \mathbb{E}_{\textcolor{red}{A}}\left[\frac{\partial \ln \pi (\textcolor{red}{A} | \textcolor{green}{s}; \theta)}{\partial \theta}\right] \\ =&amp;amp; \textcolor{magenta}{b} \cdot \sum\limits_{\textcolor{red}{a}} \pi (\textcolor{red}{a}|\textcolor{green}{s}; \theta) \cdot \frac{\partial \ln \pi (\textcolor{red}{a} | \textcolor{green}{s}; \theta)}{\partial \theta} \\ =&amp;amp; \textcolor{magenta}{b} \cdot \sum\limits_{\textcolor{red}{a}} \pi (\textcolor{red}{a}|\textcolor{green}{s}; \theta) \cdot \left[\frac{1}{\pi (\textcolor{red}{a}|\textcolor{green}{s}; \theta)} \cdot \frac{\partial \pi (\textcolor{red}{a}|\textcolor{green}{s}; \theta)}{\partial \theta}\right] \\ =&amp;amp; \textcolor{magenta}{b} \cdot \sum\limits_{\textcolor{red}{a}} \frac{\partial \pi (\textcolor{red}{a}|\textcolor{green}{s}; \theta)}{\partial \theta} = \textcolor{magenta}{b} \cdot \frac{\partial}{\partial \theta} \sum\limits_{\textcolor{red}{a}} \pi (\textcolor{red}{a}|\textcolor{green}{s}; \theta) \\ =&amp;amp; \textcolor{magenta}{b} \cdot \frac{\partial}{\partial \theta} 1 = 0 \end{split}\)&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=15;strokeColor=default;dashed=1;" parent="1" vertex="1">
          <mxGeometry x="1780" y="60" width="440" height="320" as="geometry" />
        </mxCell>
        <mxCell id="q9_H8KjKrdg0DEyqKkux-9" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="q9_H8KjKrdg0DEyqKkux-3" target="q9_H8KjKrdg0DEyqKkux-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="q9_H8KjKrdg0DEyqKkux-3" value="\(\frac{\partial V(\textcolor{green}{s}; \theta)}{\partial \theta} = \mathbb{E}_{\textcolor{red}{A}}\left[\frac{\partial \ln \pi (\textcolor{red}{A}&amp;nbsp;| \textcolor{green}{s}; \theta)}{\partial \theta} \cdot&amp;nbsp;Q_{\pi}(\textcolor{green}{s}, \textcolor{red}{A})\right] -\mathbb{E}_{\textcolor{red}{A}}\left[\textcolor{magenta}{b} \cdot \frac{\partial \ln \pi (\textcolor{red}{A} | \textcolor{green}{s}; \theta)}{\partial \theta}\right]\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="2240" y="270" width="460" height="50" as="geometry" />
        </mxCell>
        <mxCell id="q9_H8KjKrdg0DEyqKkux-8" value="\(\frac{\partial V(\textcolor{green}{s}; \theta)}{\partial \theta} = \mathbb{E}_{\textcolor{red}{A}}\left\{\frac{\partial \ln \pi (\textcolor{red}{A}&amp;nbsp;| \textcolor{green}{s}; \theta)}{\partial \theta} \cdot \left[Q_{\pi}(\textcolor{green}{s}, \textcolor{red}{A}) -\textcolor{magenta}{b}\right]\right\}\)&lt;br&gt;使用带基线的策略梯度可以降低方差，加快收敛速度" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="2240" y="360" width="460" height="60" as="geometry" />
        </mxCell>
        <mxCell id="sJqLkv-XOYl5UadH0FZE-1" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="q9_H8KjKrdg0DEyqKkux-8" target="sJqLkv-XOYl5UadH0FZE-3" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2395" y="755" as="sourcePoint" />
            <mxPoint x="2770" y="590" as="targetPoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="FhUIJi_ACO7DtZTB_gNP-10" value="使用状态价值函数作为 baseline&amp;nbsp;\(\textcolor{magenta}{b} =&amp;nbsp;V_{\pi}(\textcolor{green}{s})\)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;fillColor=none;gradientColor=none;" parent="sJqLkv-XOYl5UadH0FZE-1" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="sJqLkv-XOYl5UadH0FZE-5" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="sJqLkv-XOYl5UadH0FZE-3" target="sJqLkv-XOYl5UadH0FZE-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sJqLkv-XOYl5UadH0FZE-12" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="sJqLkv-XOYl5UadH0FZE-3" target="sJqLkv-XOYl5UadH0FZE-10" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sJqLkv-XOYl5UadH0FZE-3" value="\(\frac{\partial V(\textcolor{green}{s}; \theta)}{\partial \theta} = \mathbb{E}_{\textcolor{red}{A}}\left\{\frac{\partial \ln \pi (\textcolor{red}{A}&amp;nbsp;| \textcolor{green}{s}; \theta)}{\partial \theta} \cdot \left[Q_{\pi}(\textcolor{green}{s}, \textcolor{red}{A}) - V_{\pi}(\textcolor{green}{s})\right]\right\}\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="2240" y="470" width="460" height="50" as="geometry" />
        </mxCell>
        <mxCell id="sJqLkv-XOYl5UadH0FZE-7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="sJqLkv-XOYl5UadH0FZE-4" target="sJqLkv-XOYl5UadH0FZE-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sJqLkv-XOYl5UadH0FZE-4" value="&lt;h1&gt;使用蒙特卡罗方法估计策略梯度&lt;/h1&gt;&lt;p&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;根据策略 \(\pi (\cdot |\textcolor{green}{s}; \theta)\) 随机抽样动作 \(\textcolor{red}{\hat{a}}\)&lt;/li&gt;&lt;li&gt;计算随机策略梯度 \(g(\textcolor{red}{\hat{a}}, \theta) =&amp;nbsp;\frac{\partial \ln \pi (\textcolor{red}{\hat{a}}&amp;nbsp;| \textcolor{green}{s}; \theta)}{\partial \theta} \cdot \left[Q_{\pi}(\textcolor{green}{s}, \textcolor{red}{\hat{a}}) -&amp;nbsp;V_{\pi}(\textcolor{green}{s})\right]\)&lt;/li&gt;&lt;/ol&gt;&lt;br&gt;&lt;p&gt;&lt;/p&gt;" style="text;html=1;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontFamily=更纱黑体 SC;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="2740" y="445" width="400" height="100" as="geometry" />
        </mxCell>
        <mxCell id="FhUIJi_ACO7DtZTB_gNP-26" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;resizable=0;" parent="1" source="sJqLkv-XOYl5UadH0FZE-6" target="sJqLkv-XOYl5UadH0FZE-9" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="FhUIJi_ACO7DtZTB_gNP-29" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;resizable=0;" parent="1" source="sJqLkv-XOYl5UadH0FZE-6" target="sJqLkv-XOYl5UadH0FZE-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sJqLkv-XOYl5UadH0FZE-6" value="如何计算 \(Q_{\pi}(\textcolor{green}{s}, \textcolor{red}{\hat{a}})\) 以及 \(V_{\pi}(\textcolor{green}{s})\) ？" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="3180" y="475" width="240" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sJqLkv-XOYl5UadH0FZE-8" value="&lt;h1&gt;REINFORCE with baseline&lt;/h1&gt;&lt;p&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;完成一整局游戏 \(\textcolor{green}{s_1},\textcolor{red}{a_1}, \textcolor{blue}{r_1}, \textcolor{green}{s_2},\textcolor{red}{a_2}, \textcolor{blue}{r_2}, \cdots, \textcolor{green}{s_T},\textcolor{red}{a_T}, \textcolor{blue}{r_T}\)&lt;/li&gt;&lt;li&gt;使用 \(u_t = \sum\limits_{k=t}^{T} \gamma^{k-t} \textcolor{blue}{r_k}\) 近似 \(Q_{\pi}(\textcolor{green}{s_t}, \textcolor{red}{a_t})\)&lt;/li&gt;&lt;li&gt;使用神经网络 \(v(\textcolor{green}{s}; \omega)\) 近似 \(V_{\pi}(\textcolor{green}{s})\)&lt;/li&gt;&lt;/ol&gt;记 \(v(\textcolor{green}{s_t}; \omega_t) - u_t = \delta_t\)&lt;br&gt;&lt;br&gt;更新策略网络&amp;nbsp;\(\pi (\textcolor{red}{a}&amp;nbsp;|\textcolor{green}{s}; \theta)\) ：&lt;br&gt;&lt;ol&gt;&lt;li&gt;\(\theta_{t+1} \leftarrow \theta_t + \beta \cdot g(\textcolor{red}{a_t}, \theta_t) = \theta_t - \beta \cdot \delta_t \cdot \frac{\partial \ln \pi (\textcolor{red}{a_t}|\textcolor{green}{s_t};\theta)}{\partial \theta}&amp;nbsp;|_{\theta = \theta_t}\)&lt;br&gt;&lt;/li&gt;&lt;/ol&gt;更新价值网络 \(v(\textcolor{green}{s}; \omega)\) ：&lt;br&gt;&lt;ol&gt;&lt;li&gt;最小化损失函数 \(L_t = \frac{1}{2} \delta_t^2\) 使价值网络拟合价值函数（即：折扣回报）&lt;/li&gt;&lt;li&gt;梯度下降更新网络参数 \(\omega_{t+1} \leftarrow \omega_t - \alpha \cdot \frac{\partial}{\partial \omega} L_t = \omega_t - \alpha \cdot \delta_t \cdot \frac{\partial v(\textcolor{green}{s_t}; \omega)}{\partial \omega} |_{\omega = \omega_t}\)&lt;/li&gt;&lt;/ol&gt;一整局游戏 \(\textcolor{green}{s_1},\textcolor{red}{a_1}, \textcolor{blue}{r_1}, \textcolor{green}{s_2},\textcolor{red}{a_2}, \textcolor{blue}{r_2}, \cdots, \textcolor{green}{s_T},\textcolor{red}{a_T}, \textcolor{blue}{r_T}\)&amp;nbsp;结束后，进行 \(T\) 轮更新，分别使用 \(t = 1, 2, \dots, T\) 更新策略网络和价值网络；然后进行下一局游戏&lt;br&gt;&lt;p&gt;&lt;/p&gt;" style="text;html=1;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;" parent="1" vertex="1">
          <mxGeometry x="3540" y="320" width="440" height="350" as="geometry" />
        </mxCell>
        <mxCell id="sJqLkv-XOYl5UadH0FZE-9" value="&lt;h1&gt;Advantage Actor-Critic (A2C)&lt;/h1&gt;&lt;p&gt;&lt;/p&gt;使用 \(\textcolor{blue}{r_t} + \gamma \cdot&amp;nbsp;V_{\pi}(\textcolor{green}{s_{t+1}})\) 近似 \(Q_{\pi}(\textcolor{green}{s_t}, \textcolor{red}{a_t})\) ：&lt;br&gt;\(g(\textcolor{red}{a_t}, \theta) \approx \frac{\partial \ln \pi (\textcolor{red}{a_t}&amp;nbsp;| \textcolor{green}{s_t}; \theta)}{\partial \theta} \cdot \left[\textcolor{blue}{r_t} + \gamma \cdot&amp;nbsp;V_{\pi}(\textcolor{green}{s_{t+1}})&amp;nbsp;-&amp;nbsp;V_{\pi}(\textcolor{green}{s})\right]\)&lt;br&gt;使用神经网络 \(v(\textcolor{green}{s}; \omega)\) 近似&amp;nbsp;\(V_{\pi}(\textcolor{green}{s})\) ：&lt;br&gt;\(g(\textcolor{red}{a_t}, \theta) \approx \frac{\partial \ln \pi (\textcolor{red}{a_t}&amp;nbsp;| \textcolor{green}{s_t}; \theta)}{\partial \theta} \cdot \left[\textcolor{blue}{r_t} + \gamma \cdot v(\textcolor{green}{s_{t+1}}; \omega)&amp;nbsp;- v(\textcolor{green}{s_t}; \omega)\right]\)&lt;br&gt;&lt;br&gt;训练流程：&lt;br&gt;&lt;ol&gt;&lt;li&gt;观察得到轨迹 \((\textcolor{green}{s_t},\textcolor{red}{a_t}, \textcolor{blue}{r_t}, \textcolor{green}{s_{t+1}})\)&lt;/li&gt;&lt;li&gt;计算 TD target \(y_t = \textcolor{blue}{r_t} + \gamma \cdot v(\textcolor{green}{s_{t+1}}; \omega_t)\)&lt;/li&gt;&lt;li&gt;计算 TD error \(\delta_t = v(\textcolor{green}{s_t}; \omega_t) - y_t\)&lt;/li&gt;&lt;li&gt;使用梯度上升更新策略网络 \(\theta_{t+1} \leftarrow \theta_t + \beta \cdot g(\textcolor{red}{a_t}, \theta_t) = \theta_t - \beta \cdot \delta_t \cdot \frac{\partial \ln \pi (\textcolor{red}{a_t}|\textcolor{green}{s_t};\theta)}{\partial \theta}&amp;nbsp;|_{\theta = \theta_t}\)&lt;/li&gt;&lt;li&gt;使用梯度下降更新价值网络 \(\omega_{t+1} \leftarrow \omega_t - \alpha \cdot \frac{\partial}{\partial \omega} L_t = \omega_t - \alpha \cdot \delta_t \cdot \frac{\partial v(\textcolor{green}{s_t}; \omega)}{\partial \omega} |_{\omega = \omega_t}\) 其中损失函数 \(L_t = \frac{1}{2} \delta_t^2\)&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;/p&gt;" style="text;html=1;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;movable=1;resizable=1;rotatable=1;deletable=1;editable=1;locked=0;connectable=1;" parent="1" vertex="1">
          <mxGeometry x="3090" y="595" width="420" height="300" as="geometry" />
        </mxCell>
        <mxCell id="sJqLkv-XOYl5UadH0FZE-14" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;dashed=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="sJqLkv-XOYl5UadH0FZE-10" target="sJqLkv-XOYl5UadH0FZE-9" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="3760" y="880" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="sJqLkv-XOYl5UadH0FZE-10" value="记 \(Q_{\pi}(\textcolor{green}{s}, \textcolor{red}{a}) - V_{\pi}(\textcolor{green}{s}) = A_{\pi}(\textcolor{green}{s}, \textcolor{red}{a})\) 为&lt;b&gt;&lt;font color=&quot;#7f00ff&quot;&gt;优势函数&lt;/font&gt;&lt;/b&gt; (Advantage Function)&lt;div&gt;优势函数可以指出当前动作 \(\textcolor{red}{a_t}\) 所获得的回报 \(Q_{\pi}(\textcolor{green}{s_t}, \textcolor{red}{a_t})\) 与当前状态 \(\textcolor{green}{s_t}\) 所期待的回报 \(V_{\pi}(\textcolor{green}{s_t})\) 之间的差距&lt;/div&gt;&lt;div&gt;优势函数大于0说明当前动作比预期的效果好；优势函数小于0说明当前动作比预期的效果差&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="2115" y="560" width="710" height="80" as="geometry" />
        </mxCell>
        <mxCell id="sJqLkv-XOYl5UadH0FZE-17" value="\(Q_{\pi}(\textcolor{green}{s_t}, \textcolor{red}{a_t}) = \mathbb{E}_{\textcolor{green}{S_{t+1}}, \textcolor{red}{A_{t+1}}}\left[\textcolor{blue}{R_t} + \gamma \cdot Q_{\pi}(\textcolor{green}{S_{t+1}}, \textcolor{red}{A_{t+1}})&amp;nbsp;\middle| \textcolor{green}{S_t = s_t}, \textcolor{red}{A_t = a_t}\right]\)&lt;br&gt;使用了递归定义：\(U_t = \textcolor{blue}{R_t} + \gamma \cdot U_{t+1}\) 然后等式两边求期望" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="1500" y="400" width="520" height="50" as="geometry" />
        </mxCell>
        <mxCell id="sJqLkv-XOYl5UadH0FZE-18" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=0.9;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;exitPerimeter=0;" parent="1" source="balq-lUvnQ9j7pNHZ8tI-28" target="sJqLkv-XOYl5UadH0FZE-17" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="835" y="230" as="sourcePoint" />
            <mxPoint x="835" y="315" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="P27bC8qoyPHywM3mTXsK-13" value="&lt;span&gt;推导 A2C&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;" parent="sJqLkv-XOYl5UadH0FZE-18" vertex="1" connectable="0">
          <mxGeometry x="-0.5" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="sJqLkv-XOYl5UadH0FZE-20" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="sJqLkv-XOYl5UadH0FZE-17" target="sJqLkv-XOYl5UadH0FZE-22" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1860" y="905" as="sourcePoint" />
            <mxPoint x="1830" y="900" as="targetPoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="FhUIJi_ACO7DtZTB_gNP-3" value="\(\textcolor{blue}{R_t}\) 与 \(\textcolor{red}{A_{t+1}}\) 无关，对 \(\textcolor{red}{A_{t+1}}\) 求期望可以放到里面&lt;br&gt;省略 \( | \textcolor{green}{S_t = s_t}, \textcolor{red}{A_t = a_t}&lt;br&gt;\)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;fillColor=none;gradientColor=none;" parent="sJqLkv-XOYl5UadH0FZE-20" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="sJqLkv-XOYl5UadH0FZE-22" value="\(Q_{\pi}(\textcolor{green}{s_t}, \textcolor{red}{a_t}) = \mathbb{E}_{\textcolor{green}{S_{t+1}}}\left\{\textcolor{blue}{R_t} + \gamma \cdot \mathbb{E}_{\textcolor{red}{A_{t+1}}} \left[&amp;nbsp;Q_{\pi}(\textcolor{green}{S_{t+1}}, \textcolor{red}{A_{t+1}})\right]\right\}\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="1500" y="530" width="520" height="50" as="geometry" />
        </mxCell>
        <mxCell id="sJqLkv-XOYl5UadH0FZE-24" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="sJqLkv-XOYl5UadH0FZE-22" target="eXLRdertSL_58YiXVpYG-1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2185" y="920" as="sourcePoint" />
            <mxPoint x="1830" y="1035" as="targetPoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="FhUIJi_ACO7DtZTB_gNP-4" value="&lt;span style=&quot;font-size: 10px;&quot;&gt;\(V_{\pi}(\textcolor{green}{S_{t+1}}) = \mathbb{E}_{\textcolor{red}{A_{t+1}}}\left[Q_{\pi}(\textcolor{green}{S_{t+1}}, \textcolor{red}{A_{t+1}})\right]\)&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;fillColor=none;gradientColor=none;" parent="sJqLkv-XOYl5UadH0FZE-24" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="eXLRdertSL_58YiXVpYG-4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="eXLRdertSL_58YiXVpYG-1" target="eXLRdertSL_58YiXVpYG-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="eXLRdertSL_58YiXVpYG-1" value="\(Q_{\pi}(\textcolor{green}{s_t}, \textcolor{red}{a_t}) = \mathbb{E}_{\textcolor{green}{S_{t+1}}}\left[\textcolor{blue}{R_t} + \gamma \cdot&amp;nbsp;V_{\pi}(\textcolor{green}{S_{t+1}})\right]\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="1500" y="660" width="520" height="50" as="geometry" />
        </mxCell>
        <mxCell id="eXLRdertSL_58YiXVpYG-3" value="\(\begin{split}V_{\pi}(\textcolor{green}{s_t}) = \mathbb{E}_{\textcolor{red}{A_t}}\left[Q_{\pi}(\textcolor{green}{s_t}, \textcolor{red}{A_t})\right] &amp;amp;=\mathbb{E}_{\textcolor{red}{A_t}} \left\{\mathbb{E}_{\textcolor{green}{S_{t+1}}}\left[\textcolor{blue}{R_t} + \gamma \cdot V_{\pi}(\textcolor{green}{S_{t+1}})\right]\right\} \\ &amp;amp;=\mathbb{E}_{\textcolor{red}{A_t},&lt;br&gt;\textcolor{green}{S_{t+1}}}\left[\textcolor{blue}{R_t} + \gamma \cdot V_{\pi}(\textcolor{green}{S_{t+1}})\right]&lt;br&gt;\end{split}\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="1500" y="790" width="520" height="60" as="geometry" />
        </mxCell>
        <mxCell id="eXLRdertSL_58YiXVpYG-5" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="eXLRdertSL_58YiXVpYG-1" target="eXLRdertSL_58YiXVpYG-7" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2430" y="865" as="sourcePoint" />
            <mxPoint x="2585" y="1070" as="targetPoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="FhUIJi_ACO7DtZTB_gNP-5" value="根据轨迹 \((\textcolor{green}{s_t},\textcolor{red}{a_t}, \textcolor{blue}{r_t}, \textcolor{green}{s_{t+1}})\) 使用蒙特卡洛近似" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;fillColor=none;gradientColor=none;" parent="eXLRdertSL_58YiXVpYG-5" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="eXLRdertSL_58YiXVpYG-7" value="\(Q_{\pi}(\textcolor{green}{s_t}, \textcolor{red}{a_t}) \approx \textcolor{blue}{r_t} + \gamma \cdot&amp;nbsp;V_{\pi}(\textcolor{green}{s_{t+1}})\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="2320" y="660" width="260" height="50" as="geometry" />
        </mxCell>
        <mxCell id="eXLRdertSL_58YiXVpYG-8" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.75;entryDx=0;entryDy=0;" parent="1" source="eXLRdertSL_58YiXVpYG-7" target="sJqLkv-XOYl5UadH0FZE-9" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2440" y="900" as="sourcePoint" />
            <mxPoint x="2920" y="900" as="targetPoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="FhUIJi_ACO7DtZTB_gNP-27" value="用于近似 \(Q_{\pi}(\textcolor{green}{s_t}, \textcolor{red}{a_t})\)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;fillColor=none;gradientColor=none;" parent="eXLRdertSL_58YiXVpYG-8" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="eXLRdertSL_58YiXVpYG-10" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="eXLRdertSL_58YiXVpYG-3" target="eXLRdertSL_58YiXVpYG-12" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2145" y="1169.58" as="sourcePoint" />
            <mxPoint x="2570" y="1170" as="targetPoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="FhUIJi_ACO7DtZTB_gNP-6" value="根据轨迹 \((\textcolor{green}{s_t},\textcolor{red}{a_t}, \textcolor{blue}{r_t}, \textcolor{green}{s_{t+1}})\) 使用蒙特卡洛近似" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;fillColor=none;gradientColor=none;" parent="eXLRdertSL_58YiXVpYG-10" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="eXLRdertSL_58YiXVpYG-12" value="\(V_{\pi}(\textcolor{green}{s_t}) \approx \textcolor{blue}{r_t} + \gamma \cdot V_{\pi}(\textcolor{green}{s_{t+1}})\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="2320" y="795" width="260" height="50" as="geometry" />
        </mxCell>
        <mxCell id="eXLRdertSL_58YiXVpYG-13" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.75;entryDx=0;entryDy=0;" parent="1" source="eXLRdertSL_58YiXVpYG-12" target="sJqLkv-XOYl5UadH0FZE-9" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2955" y="1170" as="sourcePoint" />
            <mxPoint x="3875" y="1055" as="targetPoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="FhUIJi_ACO7DtZTB_gNP-28" value="用于 TD 算法更新 \(V_{\pi}(\textcolor{green}{s_t})\)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;fillColor=none;gradientColor=none;" parent="eXLRdertSL_58YiXVpYG-13" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="FhUIJi_ACO7DtZTB_gNP-33" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;resizable=0;" parent="1" source="eXLRdertSL_58YiXVpYG-15" target="sJqLkv-XOYl5UadH0FZE-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="FhUIJi_ACO7DtZTB_gNP-34" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;resizable=0;" parent="1" source="eXLRdertSL_58YiXVpYG-15" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="3510" y="710" as="targetPoint" />
            <Array as="points">
              <mxPoint x="3650" y="710" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="eXLRdertSL_58YiXVpYG-15" value="&lt;h1&gt;Multi-Step TD Target&lt;/h1&gt;&lt;p&gt;&lt;/p&gt;连续观察 \(m\) 条轨迹 \(\left\{(\textcolor{green}{s_{t+i}},\textcolor{red}{a_{t+i}}, \textcolor{blue}{r_{t+i}}, \textcolor{green}{s_{t+1+i}})\right\}_{i=0}^{m-1}\)&lt;br&gt;计算 TD target 时使用 \(m\) 个已知奖励 \(y_t = \sum\limits_{i=0}^{m-1} \gamma^i \cdot \textcolor{blue}{r_{t+i}} + \gamma^m \cdot v(\textcolor{green}{s_{t+m}}; \omega)\)&lt;br&gt;其他计算、更新公式均保持不变&lt;br&gt;&lt;p&gt;&lt;/p&gt;" style="text;html=1;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;dashed=1;" parent="1" vertex="1">
          <mxGeometry x="3540" y="755" width="440" height="140" as="geometry" />
        </mxCell>
        <mxCell id="tXlBBBqLK87PE_aL1Him-1" value="连续控制" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=20;fontStyle=1;strokeColor=default;" parent="1" vertex="1">
          <mxGeometry x="370" y="-375" width="180" height="50" as="geometry" />
        </mxCell>
        <mxCell id="tXlBBBqLK87PE_aL1Him-2" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;" parent="1" source="P27bC8qoyPHywM3mTXsK-9" target="tXlBBBqLK87PE_aL1Him-1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="145" y="170" as="sourcePoint" />
            <mxPoint x="1025" y="-90" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="tXlBBBqLK87PE_aL1Him-4" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="tXlBBBqLK87PE_aL1Him-1" target="tXlBBBqLK87PE_aL1Him-6" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1090" y="-305" as="sourcePoint" />
            <mxPoint x="1455" y="-635" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="tXlBBBqLK87PE_aL1Him-5" value="&lt;div style=&quot;font-size: 12px;&quot;&gt;策略函数直接输出动作值，而非概率分布&lt;br style=&quot;font-size: 12px;&quot;&gt;&lt;/div&gt;使用神经网络近似确定策略函数和动作价值函数" style="edgeLabel;resizable=0;html=1;;align=center;verticalAlign=middle;fontSize=12;fontFamily=更纱黑体 SC;" parent="tXlBBBqLK87PE_aL1Him-4" connectable="0" vertex="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="tXlBBBqLK87PE_aL1Him-6" value="\(\textcolor{red}{a} = \pi (\textcolor{green}{s}; \theta) \qquad q (\textcolor{green}{s}, \textcolor{red}{a}; \omega)\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="-270" y="-370" width="320" height="40" as="geometry" />
        </mxCell>
        <mxCell id="tXlBBBqLK87PE_aL1Him-7" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;entryX=0.5;entryY=1;entryDx=0;entryDy=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;" parent="1" source="tXlBBBqLK87PE_aL1Him-6" target="tXlBBBqLK87PE_aL1Him-9" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="735" y="-700" as="sourcePoint" />
            <mxPoint x="2040" y="-635" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="tXlBBBqLK87PE_aL1Him-8" value="使用确定策略梯度最大化&lt;div style=&quot;font-size: 12px;&quot;&gt;\(q (\textcolor{green}{s}, \textcolor{red}{a}; \omega) = q (\textcolor{green}{s}, \pi (\textcolor{green}{s}; \theta); \omega)\)&lt;/div&gt;&lt;div style=&quot;font-size: 12px;&quot;&gt;即：最大化动作的评分&lt;/div&gt;" style="edgeLabel;resizable=0;html=1;;align=center;verticalAlign=middle;fontSize=12;fontFamily=更纱黑体 SC;" parent="tXlBBBqLK87PE_aL1Him-7" connectable="0" vertex="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="tXlBBBqLK87PE_aL1Him-9" value="\(\theta_{t+1} \leftarrow \theta_t + \beta \cdot \frac{\partial&amp;nbsp;q (\textcolor{green}{s}, \pi (\textcolor{green}{s}; \theta); \omega)}{\partial \theta}\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="-270" y="-520" width="320" height="40" as="geometry" />
        </mxCell>
        <mxCell id="tXlBBBqLK87PE_aL1Him-10" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;entryX=0.5;entryY=1;entryDx=0;entryDy=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;" parent="1" source="tXlBBBqLK87PE_aL1Him-9" target="tXlBBBqLK87PE_aL1Him-12" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-255" y="-1105" as="sourcePoint" />
            <mxPoint x="2640" y="-640" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="tXlBBBqLK87PE_aL1Him-11" value="计算确定策略梯度" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontFamily=更纱黑体 SC;" parent="tXlBBBqLK87PE_aL1Him-10" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="FhUIJi_ACO7DtZTB_gNP-16" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;resizable=0;" parent="1" source="tXlBBBqLK87PE_aL1Him-12" target="tXlBBBqLK87PE_aL1Him-15" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tXlBBBqLK87PE_aL1Him-12" value="确定策略梯度 \(\frac{\partial&amp;nbsp;q (\textcolor{green}{s}, \pi (\textcolor{green}{s}; \theta); \omega)}{\partial \theta} = \frac{\partial \textcolor{red}{a}}{\partial \theta} \cdot \frac{\partial q (\textcolor{green}{s}, \textcolor{red}{a}; \omega)}{\partial \textcolor{red}{a}}\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="-270" y="-620" width="320" height="40" as="geometry" />
        </mxCell>
        <mxCell id="FhUIJi_ACO7DtZTB_gNP-17" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;resizable=0;" parent="1" source="tXlBBBqLK87PE_aL1Him-15" target="nFzaZGQqQUoIvIIh4y-_-1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="tXlBBBqLK87PE_aL1Him-15" value="&lt;h1&gt;深度确定策略梯度 (Deep Deterministic Policy Gradient, DDPG)&lt;/h1&gt;&lt;p&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;策略网络 \(\pi (\textcolor{green}{s}; \theta)\) ；价值网络&amp;nbsp;&lt;span style=&quot;text-align: center;&quot;&gt;\(q (\textcolor{green}{s}, \textcolor{red}{a}; \omega)\) ；target network&amp;nbsp;&lt;/span&gt;\(\pi (\textcolor{green}{s}; \theta^-)\) ，\(q (\textcolor{green}{s}, \textcolor{red}{a}; \omega^-)\) ；其中 \(\theta^- = \theta\) ，\(\omega^- = \omega\)&lt;/li&gt;&lt;li&gt;根据当前状态 \(\textcolor{green}{s_t}\) 执行动作 \(\textcolor{red}{a_t} = \pi (\textcolor{green}{s_t}; \theta_t)\) ，得到奖励 \(\textcolor{blue}{r_t}\) 和下一个状态 \(\textcolor{green}{s_{t+1}}\)&lt;/li&gt;&lt;li&gt;计算确定策略梯度&amp;nbsp;\(g= \frac{\partial \textcolor{red}{a}}{\partial \theta} \cdot \frac{\partial q (\textcolor{green}{s}, \textcolor{red}{a}; \omega)}{\partial \textcolor{red}{a}} = \frac{\partial&amp;nbsp;\pi (\textcolor{green}{s_t}; \theta)}{\partial \theta} |_{\theta = \theta_t} \cdot \frac{\partial q (\textcolor{green}{s_t}, \textcolor{red}{a}; \omega_t)}{\partial \textcolor{red}{a}} |_{\textcolor{red}{a} = \textcolor{red}{a_t}}\)&lt;/li&gt;&lt;li&gt;使用策略梯度上升更新策略网络 \(\theta_{t+1} \leftarrow \theta_t + \beta \cdot g\)&lt;/li&gt;&lt;li&gt;使用价值网络计算 \(q_t = q (\textcolor{green}{s_t}, \textcolor{red}{a_t}; \omega_t)\)&lt;/li&gt;&lt;li&gt;使用 target network 计算 \(q_{t+1} = q (\textcolor{green}{s_{t+1}}, \textcolor{red}{a&#39;_{t+1}}; \omega_t^-)\) ，其中 \(\textcolor{red}{a&#39;_{t+1}} = \pi (\textcolor{green}{s_{t+1}}; \theta_t^-)\)&lt;/li&gt;&lt;li&gt;计算 TD target \(y_t = \textcolor{blue}{r_t} + \gamma \cdot q_{t+1}\)&lt;/li&gt;&lt;li&gt;计算 TD error \(\delta_t = q_t - y_t\)&lt;/li&gt;&lt;li&gt;使用梯度下降更新价值网络 \(\omega_{t+1} \leftarrow \omega_t - \alpha \cdot \delta_t \cdot \frac{\partial q (\textcolor{green}{s_t}, \textcolor{red}{a_t}; \omega)}{\partial \omega} |_{\omega = \omega_t}\)&lt;/li&gt;&lt;/ol&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;每 \(N_{update}\) 个 step 后更新 target network 的参数：&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;ul&gt;&lt;li&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;\(\theta^- \leftarrow \tau \cdot \theta + (1-\tau) \cdot \theta^-\)&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;\(\omega^- \leftarrow \tau \cdot \omega&amp;nbsp;+ (1-\tau) \cdot \omega^-\)&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;" style="text;html=1;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;" parent="1" vertex="1">
          <mxGeometry x="-440" y="-960" width="660" height="300" as="geometry" />
        </mxCell>
        <mxCell id="SvYFlbn8YFz6SzjA_q7s-1" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" parent="1" source="SyCfzCqmaqDro-8NCypD-6" target="SvYFlbn8YFz6SzjA_q7s-3" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1445" y="-285" as="sourcePoint" />
            <mxPoint x="1670" y="-395" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="SvYFlbn8YFz6SzjA_q7s-2" value="使用置信域 (Trust Region) 最大化 \(J(\theta)\)" style="edgeLabel;resizable=0;html=1;;align=center;verticalAlign=middle;fontSize=12;fontFamily=更纱黑体 SC;" parent="SvYFlbn8YFz6SzjA_q7s-1" connectable="0" vertex="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint y="2" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="SvYFlbn8YFz6SzjA_q7s-9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="SvYFlbn8YFz6SzjA_q7s-3" target="SvYFlbn8YFz6SzjA_q7s-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SvYFlbn8YFz6SzjA_q7s-3" value="\(J(\theta) = \mathbb{E}_{\textcolor{green}{S}}\left\{\mathbb{E}_{\textcolor{red}{A}} \left[\frac{\pi (\textcolor{red}{A}|\textcolor{green}{S}; \theta)}{\pi (\textcolor{red}{A}|\textcolor{green}{S}; \theta_{\text{old}})} \cdot Q_{\pi}(\textcolor{green}{S}, \textcolor{red}{A})\right]\right\} = \mathbb{E}_{\textcolor{green}{S}, \textcolor{red}{A}} \left[\frac{\pi (\textcolor{red}{A}|\textcolor{green}{S}; \theta)}{\pi (\textcolor{red}{A}|\textcolor{green}{S}; \theta_{\text{old}})} \cdot Q_{\pi}(\textcolor{green}{S}, \textcolor{red}{A})\right]\)&lt;div&gt;其中 \(\textcolor{red}{A} \sim \pi (\textcolor{red}{\cdot}|\textcolor{green}{s}; \theta_{\text{old}})\)&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="920" y="-265" width="580" height="60" as="geometry" />
        </mxCell>
        <mxCell id="SvYFlbn8YFz6SzjA_q7s-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="SvYFlbn8YFz6SzjA_q7s-4" target="SvYFlbn8YFz6SzjA_q7s-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SvYFlbn8YFz6SzjA_q7s-7" value="&lt;font style=&quot;font-size: 12px;&quot;&gt;&lt;span style=&quot;font-size: 12px;&quot;&gt;代入 \(J(\theta)\)&lt;/span&gt;&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;" parent="SvYFlbn8YFz6SzjA_q7s-6" vertex="1" connectable="0">
          <mxGeometry x="0.0974" y="-2" relative="1" as="geometry">
            <mxPoint x="3" y="-2" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="SvYFlbn8YFz6SzjA_q7s-4" value="\(\begin{split}&lt;br&gt;V(\textcolor{green}{s}; \theta) =&amp;amp; \sum\limits_{\textcolor{red}{a}} \pi (\textcolor{red}{a}|\textcolor{green}{s}; \theta) \cdot Q_{\pi}(\textcolor{green}{s}, \textcolor{red}{a}) \\&lt;br&gt;=&amp;amp; \sum\limits_{\textcolor{red}{a}} \pi (\textcolor{red}{a}|\textcolor{green}{s}; \theta_{\text{old}}) \cdot \frac{\pi (\textcolor{red}{a}|\textcolor{green}{s}; \theta)}{\pi (\textcolor{red}{a}|\textcolor{green}{s}; \theta_{\text{old}})} \cdot Q_{\pi}(\textcolor{green}{s}, \textcolor{red}{a}) \\&lt;br&gt;=&amp;amp; \mathbb{E}_{\textcolor{red}{A} \sim \pi (\textcolor{red}{\cdot}|\textcolor{green}{s}; \theta_{\text{old}})} \left[\frac{\pi (\textcolor{red}{A}|\textcolor{green}{s}; \theta)}{\pi (\textcolor{red}{A}|\textcolor{green}{s}; \theta_{\text{old}})} \cdot Q_{\pi}(\textcolor{green}{s}, \textcolor{red}{A})\right]\end{split}\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="500" y="-180" width="400" height="160" as="geometry" />
        </mxCell>
        <mxCell id="SvYFlbn8YFz6SzjA_q7s-8" value="&lt;h1&gt;置信域策略优化 (Trust Region Policy Optimization, TRPO)&lt;/h1&gt;&lt;p&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;使用策略 \(\textcolor{red}{A} \sim \pi (\textcolor{red}{\cdot}|\textcolor{green}{s}; \theta_{\text{old}})\) 完成一整局游戏 \(\textcolor{green}{s_1},\textcolor{red}{a_1}, \textcolor{blue}{r_1}, \textcolor{green}{s_2},\textcolor{red}{a_2}, \textcolor{blue}{r_2}, \cdots, \textcolor{green}{s_T},\textcolor{red}{a_T}, \textcolor{blue}{r_T}\)&lt;/li&gt;&lt;li&gt;计算每一步 \(i = 1, 2, \dots, T\) 的折扣回报 \(\textcolor{blue}{u_i} = \sum\limits_{k=i}^{T} \gamma^{k-i} \cdot \textcolor{blue}{r_k}\)&lt;/li&gt;&lt;li&gt;使用均值估计期望近似目标函数 \(J(\theta) \approx L(\theta | \theta_{\text{old}}) = \frac{1}{T} \sum\limits_{i=1}^{T}&amp;nbsp;\frac{\pi (\textcolor{red}{a_i}|\textcolor{green}{s_i}; \theta)}{\pi (\textcolor{red}{a_i}|\textcolor{green}{s_i}; \theta_{\text{old}})} \cdot \textcolor{blue}{u_i}\)&lt;/li&gt;&lt;li&gt;求解带约束条件的优化问题 \(\theta_{\text{new}} \leftarrow \mathop{\text{argmax}}\limits_{\theta} L(\theta | \theta_{\text{old}}); \quad \text{s.t.} \theta \in \mathcal{N}(\theta_{\text{old}}).\) 其中邻域 \(\mathcal{N}(\theta_{\text{old}})\) 可以选择：&lt;/li&gt;&lt;ul&gt;&lt;li&gt;\(||\theta - \theta_{\text{old}}||_2 &amp;lt; \Delta\)&lt;/li&gt;&lt;li&gt;\(\frac{1}{T} \sum\limits_{i=1}^{T} D_{KL}\left[\pi(\cdot|\textcolor{green}{s_i}; \theta_{old}) || \pi(\cdot|\textcolor{green}{s_i}; \theta)\right] &amp;lt; \Delta\)&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;每个 Episode 重复迭代上述 4 步&lt;/li&gt;&lt;/ol&gt;&lt;div&gt;TRPO 限制了策略网络参数 \(\theta\) 的更新范围，使得策略网络不会因为更新幅度过大导致策略网络发散&lt;/div&gt;&lt;p&gt;&lt;/p&gt;" style="text;html=1;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;" parent="1" vertex="1">
          <mxGeometry x="1720" y="-390" width="540" height="310" as="geometry" />
        </mxCell>
        <mxCell id="SvYFlbn8YFz6SzjA_q7s-10" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" parent="1" source="tXlBBBqLK87PE_aL1Him-1" target="SvYFlbn8YFz6SzjA_q7s-12" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1140" y="-915" as="sourcePoint" />
            <mxPoint x="1450" y="-915" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="SvYFlbn8YFz6SzjA_q7s-11" value="使用高斯函数作为策略函数&lt;div style=&quot;font-size: 12px;&quot;&gt;每个动作分量从正态分布中采样得到&lt;/div&gt;" style="edgeLabel;resizable=0;html=1;;align=center;verticalAlign=middle;fontSize=12;fontFamily=更纱黑体 SC;" parent="SvYFlbn8YFz6SzjA_q7s-10" connectable="0" vertex="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="SvYFlbn8YFz6SzjA_q7s-12" value="&lt;div&gt;假设动作空间维度为 \(d\)&lt;/div&gt;&lt;div&gt;\(\mathbf{\textcolor{red}{a}} = \left[\textcolor{red}{a_1}, \textcolor{red}{a_2}, \dots, \textcolor{red}{a_d}\right]\)&lt;/div&gt;\(\textcolor{red}{a_i} \sim N(\mu_i, \sigma_i^2), \; i = 1, 2, \dots, d\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="320" y="-960" width="280" height="60" as="geometry" />
        </mxCell>
        <mxCell id="UfZ2qnKndyfp9CoiRrid-1" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="SvYFlbn8YFz6SzjA_q7s-12" target="UfZ2qnKndyfp9CoiRrid-3" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1720" y="-920" as="sourcePoint" />
            <mxPoint x="1860" y="-925" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UfZ2qnKndyfp9CoiRrid-2" value="动作 \(\textcolor{red}{a}\) 相互独立" style="edgeLabel;resizable=0;html=1;;align=center;verticalAlign=middle;fontSize=12;fontFamily=更纱黑体 SC;" parent="UfZ2qnKndyfp9CoiRrid-1" connectable="0" vertex="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UfZ2qnKndyfp9CoiRrid-3" value="\(\pi (\mathbf{\textcolor{red}{a}}|\textcolor{green}{s}) = \prod\limits_{i=1}^{d} \frac{1}{\sqrt{2 \pi} \sigma_i} \cdot \exp\left(-\frac{(\textcolor{red}{a_i} - \mu_i)^2}{2 \sigma_i^2}\right)\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="880" y="-960" width="300" height="60" as="geometry" />
        </mxCell>
        <mxCell id="UfZ2qnKndyfp9CoiRrid-7" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="UfZ2qnKndyfp9CoiRrid-3" target="UfZ2qnKndyfp9CoiRrid-9" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2170" y="-925.29" as="sourcePoint" />
            <mxPoint x="2315" y="-925.29" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UfZ2qnKndyfp9CoiRrid-8" value="为了求策略梯度&lt;div style=&quot;font-size: 12px;&quot;&gt;对策略函数取对数&lt;/div&gt;" style="edgeLabel;resizable=0;html=1;;align=center;verticalAlign=middle;fontSize=12;fontFamily=更纱黑体 SC;" parent="UfZ2qnKndyfp9CoiRrid-7" connectable="0" vertex="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UfZ2qnKndyfp9CoiRrid-9" value="\(\ln \pi (\mathbf{\textcolor{red}{a}}|\textcolor{green}{s}) = \sum\limits_{i=1}^{d} \left[- \ln \sigma_i - \frac{(\textcolor{red}{a_i} - \mu_i)^2}{2 \sigma_i^2}\right] + \text{const}\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="1400" y="-960" width="360" height="60" as="geometry" />
        </mxCell>
        <mxCell id="UfZ2qnKndyfp9CoiRrid-16" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="UfZ2qnKndyfp9CoiRrid-11" target="UfZ2qnKndyfp9CoiRrid-15" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UfZ2qnKndyfp9CoiRrid-11" value="\(\ln \pi (\mathbf{\textcolor{red}{a}}|\textcolor{green}{s}) = \sum\limits_{i=1}^{d} \left[- \frac{\rho_i}{2} - \frac{(\textcolor{red}{a_i} - \mu_i)^2}{2 \cdot \exp (\rho_i)}\right] + \text{const}\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="2030" y="-960" width="340" height="60" as="geometry" />
        </mxCell>
        <mxCell id="UfZ2qnKndyfp9CoiRrid-13" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="UfZ2qnKndyfp9CoiRrid-9" target="UfZ2qnKndyfp9CoiRrid-11" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2360" y="-1185" as="sourcePoint" />
            <mxPoint x="2710" y="-1155" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UfZ2qnKndyfp9CoiRrid-14" value="记 \(\rho_i = \ln \sigma_i^2, \; i = 1, 2, \dots, d\)" style="edgeLabel;resizable=0;html=1;;align=center;verticalAlign=middle;fontSize=12;fontFamily=更纱黑体 SC;" parent="UfZ2qnKndyfp9CoiRrid-13" connectable="0" vertex="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UfZ2qnKndyfp9CoiRrid-18" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="UfZ2qnKndyfp9CoiRrid-15" target="UfZ2qnKndyfp9CoiRrid-17" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UfZ2qnKndyfp9CoiRrid-15" value="定义辅助函数 \(f(\textcolor{green}{s}, \mathbf{\textcolor{red}{a}}) = \sum\limits_{i=1}^{d} \left[- \frac{\rho_i}{2} - \frac{(\textcolor{red}{a_i} - \mu_i)^2}{2 \cdot \exp (\rho_i)}\right]\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="2470" y="-960" width="360" height="60" as="geometry" />
        </mxCell>
        <mxCell id="UfZ2qnKndyfp9CoiRrid-20" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="UfZ2qnKndyfp9CoiRrid-17" target="UfZ2qnKndyfp9CoiRrid-19" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="l3KTNooECMtvP_L4lYXq-4" value="计算策略梯度" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontFamily=更纱黑体 SC;" parent="UfZ2qnKndyfp9CoiRrid-20" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UfZ2qnKndyfp9CoiRrid-17" value="\(\ln \pi (\mathbf{\textcolor{red}{a}}|\textcolor{green}{s}) = f(\textcolor{green}{s}, \mathbf{\textcolor{red}{a}})&amp;nbsp;+ \text{const}\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="2930" y="-960" width="240" height="60" as="geometry" />
        </mxCell>
        <mxCell id="UfZ2qnKndyfp9CoiRrid-19" value="&lt;h1&gt;随机高斯策略网络&lt;/h1&gt;&lt;div&gt;&lt;span style=&quot;text-align: center;&quot;&gt;使用神经网络 \(\mu(\textcolor{green}{s}; \theta^\mu)\) 输出给定状态下各个动作分量的均值&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;text-align: center;&quot;&gt;使用神经网络 \(\rho(\textcolor{green}{s}; \theta^\rho)\) 输出给定状态下各个动作分量的方差对数&lt;/span&gt;&lt;span style=&quot;text-align: center;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;text-align: center;&quot;&gt;记两个网络的参数为 \(\theta = (\theta^\mu,&amp;nbsp;\theta^\rho)\) 则&amp;nbsp;\(\ln \pi (\mathbf{\textcolor{red}{a}}|\textcolor{green}{s}; \theta) = f(\textcolor{green}{s},&amp;nbsp;\mathbf{\textcolor{red}{a}}; \theta)&amp;nbsp;+ \text{const}\)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;text-align: center;&quot;&gt;等式两边分别对 \(\theta\) 求偏导，可得策略梯度中对数策略函数对网络参数的偏导等于辅助函数对网络函数的偏导：&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;text-align: center;&quot;&gt;\(\frac{\partial \ln \pi (\mathbf{\textcolor{red}{a}}|\textcolor{green}{s}; \theta)}{\partial \theta} = \frac{\partial f(\textcolor{green}{s}, \mathbf{\textcolor{red}{a}}; \theta)}{\partial \theta}\)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;text-align: center;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;text-align: center;&quot;&gt;随机策略梯度 \(g(\mathbf{\textcolor{red}{a}}, \theta) = \frac{\partial \ln \pi (\mathbf{\textcolor{red}{a}} | \textcolor{green}{s}; \theta)}{\partial \theta} \cdot Q_{\pi}(\textcolor{green}{s}, \mathbf{\textcolor{red}{a}}) = \frac{\partial f(\textcolor{green}{s}, \mathbf{\textcolor{red}{a}}; \theta)}{\partial \theta} \cdot Q_{\pi}(\textcolor{green}{s}, \mathbf{\textcolor{red}{a}})\)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;ul&gt;&lt;li&gt;&lt;span style=&quot;text-align: center;&quot;&gt;使用 REINFORCE 更新参数 \(\theta\)&lt;/span&gt;&lt;/li&gt;&lt;li style=&quot;&quot;&gt;使用 Actor-Critic 更新参数 \(\theta\)&lt;/li&gt;&lt;/ul&gt;带基线的策略梯度 \(g(\mathbf{\textcolor{red}{a}}, \theta) = \frac{\partial \ln \pi (\mathbf{\textcolor{red}{a}} | \textcolor{green}{s}; \theta)}{\partial \theta} \cdot Q_{\pi}(\textcolor{green}{s}, \mathbf{\textcolor{red}{a}}) = \frac{\partial f(\textcolor{green}{s}, \mathbf{\textcolor{red}{a}}; \theta)}{\partial \theta} \cdot \left[Q_{\pi}(\textcolor{green}{s}, \mathbf{\textcolor{red}{a}}) - V_{\pi}(\textcolor{green}{s})\right]\)&lt;/div&gt;&lt;div&gt;&lt;ul&gt;&lt;li&gt;使用 REINFORCE with baseline 更新参数 \(\theta\)&lt;/li&gt;&lt;li&gt;使用 A2C 更新参数 \(\theta\)&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;" style="text;html=1;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;" parent="1" vertex="1">
          <mxGeometry x="2800" y="-800" width="500" height="300" as="geometry" />
        </mxCell>
        <mxCell id="xpwGKzMPdz4pf0MIEoXZ-4" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="xpwGKzMPdz4pf0MIEoXZ-3" target="SvYFlbn8YFz6SzjA_q7s-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="xpwGKzMPdz4pf0MIEoXZ-3" value="实际使用优势函数 \(J(\theta) = \mathbb{E}_{\textcolor{green}{S}, \textcolor{red}{A}} \left[\frac{\pi (\textcolor{red}{A}|\textcolor{green}{S}; \theta)}{\pi (\textcolor{red}{A}|\textcolor{green}{S}; \theta_{\text{old}})} \cdot A_{\pi}(\textcolor{green}{S}, \textcolor{red}{A})\right]\)&lt;div&gt;当 \(A_\pi &amp;gt; 0\) 时，\(\theta\) 的更新使 \(\pi (\textcolor{red}{a_t}|\textcolor{green}{s_t}; \theta)\) 的值增大，会让智能体在 \(\textcolor{green}{s_t}\) 状态下更倾向于选择动作 \(\textcolor{red}{a_t}\)&lt;/div&gt;&lt;div&gt;当 \(A_\pi &amp;lt; 0\) 时，\(\theta\) 的更新使 \(\pi (\textcolor{red}{a_t}|\textcolor{green}{s_t}; \theta)\) 的值减小，会让智能体在 \(\textcolor{green}{s_t}\) 状态下更不可能选择动作 \(\textcolor{red}{a_t}\)&lt;/div&gt;&lt;div&gt;（优势函数的含义参见紫色加粗定义处）&lt;/div&gt;&lt;div&gt;（ \(A_\pi\) 中的价值函数 \(V_\pi\) 使用神经网络近似，训练方法与带基线的策略梯度相同）&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=default;dashed=1;" parent="1" vertex="1">
          <mxGeometry x="2300" y="-325" width="470" height="180" as="geometry" />
        </mxCell>
        <mxCell id="5yZ8N9YkS_C3_jyF99Ot-1" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" parent="1" source="SvYFlbn8YFz6SzjA_q7s-3" target="5yZ8N9YkS_C3_jyF99Ot-3" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1380" y="-525" as="sourcePoint" />
            <mxPoint x="1405" y="-605" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="5yZ8N9YkS_C3_jyF99Ot-2" value="令 \(r(\theta) =&amp;nbsp;\frac{\pi (\textcolor{red}{A}|\textcolor{green}{S}; \theta)}{\pi (\textcolor{red}{A}|\textcolor{green}{S}; \theta_{\text{old}})}\), \(\theta\) 离 \(\theta_{\text{old}}\) 越远，\(r(\theta)\) 越远离\(1\), \(r(\theta_{\text{old}}) = 1\)&lt;div&gt;将动作价值函数 \(Q_{\pi}(\textcolor{green}{S}, \textcolor{red}{A})\) 替换为优势函数 \(A_{\pi}(\textcolor{green}{S}, \textcolor{red}{A})\)&lt;/div&gt;" style="edgeLabel;resizable=0;html=1;;align=center;verticalAlign=middle;fontSize=12;fontFamily=更纱黑体 SC;" parent="5yZ8N9YkS_C3_jyF99Ot-1" connectable="0" vertex="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="FhUIJi_ACO7DtZTB_gNP-14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;resizable=0;" parent="1" source="5yZ8N9YkS_C3_jyF99Ot-3" target="5yZ8N9YkS_C3_jyF99Ot-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="5yZ8N9YkS_C3_jyF99Ot-3" value="PPO 最大化目标函数 \(J(\theta) = \mathbb{E}_{\textcolor{green}{S}, \textcolor{red}{A}} \left\{\min \left[r(\theta) \cdot A_{\pi}(\textcolor{green}{S}, \textcolor{red}{A}), \text{clip}(r(\theta), 1-\epsilon, 1+\epsilon) \cdot A_{\pi}(\textcolor{green}{S}, \textcolor{red}{A})\right]\right\}\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="920" y="-630" width="580" height="60" as="geometry" />
        </mxCell>
        <mxCell id="5yZ8N9YkS_C3_jyF99Ot-4" value="&lt;h1&gt;近端策略优化 (Proximal Policy Optimization, PPO)&lt;/h1&gt;&lt;p&gt;&lt;/p&gt;目标函数中取最小值的第一项是 TRPO 中的目标函数&lt;div&gt;目标函数中取最小值的第二项是 TRPO 目标函数的 clipped version ( \(\epsilon\) 通常取 0.2)&lt;/div&gt;&lt;div&gt;\(\text{clip}(x, a, b) = \begin{cases}&lt;br&gt;a, &amp;amp; \text{if } x &amp;lt; a;\\&lt;br&gt;x, &amp;amp; \text{if } a \leq x \leq b;\\&lt;br&gt;b, &amp;amp; \text{if } x &amp;gt; b.\end{cases}\)&lt;br&gt;&lt;br&gt;训练流程：&lt;/div&gt;&lt;div&gt;&lt;ol&gt;&lt;li&gt;使用神经网络&amp;nbsp;\(v(\textcolor{green}{s}; \omega)\)&amp;nbsp;近似状态价值函数 \(V_{\pi}(\textcolor{green}{s})\)&lt;/li&gt;&lt;li&gt;使用策略 \(\textcolor{red}{A} \sim \pi (\textcolor{red}{\cdot}|\textcolor{green}{s}; \theta_{\text{old}})\) 完成一整局游戏 \(\textcolor{green}{s_1},\textcolor{red}{a_1}, \textcolor{blue}{r_1}, \textcolor{green}{s_2},\textcolor{red}{a_2}, \textcolor{blue}{r_2}, \cdots, \textcolor{green}{s_T},\textcolor{red}{a_T}, \textcolor{blue}{r_T}\)&lt;/li&gt;&lt;li&gt;使用 REINFORCE with baseline 或 A2C 的方法估计每一步的优势函数值 \(\hat{A}_i\) ，其中 \(i=1, 2, \dots, T\)&lt;/li&gt;&lt;li&gt;使用均值估计期望近似目标函数 \(J(\theta) \approx L(\theta) = \frac{1}{T} \sum\limits_{i=1}^{T} \min \left[r(\theta) \cdot \hat{A}_i, \text{clip}(r(\theta), 1-\epsilon, 1+\epsilon) \cdot \hat{A}_i\right]\)&lt;/li&gt;&lt;li&gt;求解无约束优化问题 \(\theta_{\text{new}} \leftarrow \mathop{\text{argmax}}\limits_{\theta} L(\theta)\)&lt;/li&gt;&lt;li&gt;每个 Episode 重复迭代 2-5 步&lt;/li&gt;&lt;/ol&gt;&lt;div&gt;PPO 无需计算&amp;nbsp;&lt;span style=&quot;text-align: center;&quot;&gt;KL 散度 \(D_{KL}\) ，因此与 TRPO 相比减少了计算量；&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;同时 PPO 目标函数中的 clip 函数同样限制了策略网络参数 \(\theta\) 的更新幅度&lt;/div&gt;&lt;p&gt;&lt;/p&gt;&lt;/div&gt;" style="text;html=1;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;" parent="1" vertex="1">
          <mxGeometry x="1720" y="-800" width="540" height="400" as="geometry" />
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-1" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" parent="1" source="5yZ8N9YkS_C3_jyF99Ot-3" target="0sy7PDOA3QsTIWjxpfF0-3" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1055" y="-1355" as="sourcePoint" />
            <mxPoint x="1405" y="-825" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-2" value="算法解读" style="edgeLabel;resizable=0;html=1;;align=center;verticalAlign=middle;fontSize=12;fontFamily=更纱黑体 SC;" parent="0sy7PDOA3QsTIWjxpfF0-1" connectable="0" vertex="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-3" value="使用 REINFORCE with baseline 或 A2C 的方法估计完优势函数 \(A_{\pi}(\textcolor{green}{s}, \textcolor{red}{a}) \approx A\) 后&lt;div&gt;目标函数 \(J\) 的值只与 \(r\) 有关 \(J = \min \left[r \cdot A, \text{clip}(r, 1-\epsilon, 1+\epsilon) \cdot A\right]\)&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;fillColor=none;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="920" y="-880" width="580" height="60" as="geometry" />
        </mxCell>
        <mxCell id="PKBRhwWGn7sbWwzWUMB2-2" value="" style="swimlane;startSize=0;" parent="1" vertex="1">
          <mxGeometry x="2300" y="-800" width="470" height="465" as="geometry" />
        </mxCell>
        <mxCell id="PKBRhwWGn7sbWwzWUMB2-1" value="" style="group" parent="PKBRhwWGn7sbWwzWUMB2-2" vertex="1" connectable="0">
          <mxGeometry x="5" y="5" width="455" height="225" as="geometry" />
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-4" value="" style="endArrow=classic;html=1;rounded=0;" parent="PKBRhwWGn7sbWwzWUMB2-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="55" y="165" as="sourcePoint" />
            <mxPoint x="55" y="5" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-5" value="" style="endArrow=classic;html=1;rounded=0;" parent="PKBRhwWGn7sbWwzWUMB2-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="55" y="165" as="sourcePoint" />
            <mxPoint x="235" y="165" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-6" value="\(r\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;" parent="PKBRhwWGn7sbWwzWUMB2-1" vertex="1">
          <mxGeometry x="235" y="155" width="15" height="20" as="geometry" />
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-7" value="" style="endArrow=none;html=1;rounded=0;" parent="PKBRhwWGn7sbWwzWUMB2-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="55" y="165" as="sourcePoint" />
            <mxPoint x="205" y="15" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-8" value="\(y_1=r \cdot A\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;" parent="PKBRhwWGn7sbWwzWUMB2-1" vertex="1">
          <mxGeometry x="175" width="60" height="15" as="geometry" />
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-9" value="\(A&amp;gt;0\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;" parent="PKBRhwWGn7sbWwzWUMB2-1" vertex="1">
          <mxGeometry x="302.5" y="75" width="50" height="20" as="geometry" />
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-10" value="" style="endArrow=none;html=1;rounded=0;" parent="PKBRhwWGn7sbWwzWUMB2-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="140" y="170" as="sourcePoint" />
            <mxPoint x="140" y="160" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-11" value="" style="endArrow=none;html=1;rounded=0;" parent="PKBRhwWGn7sbWwzWUMB2-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="94.96000000000004" y="170" as="sourcePoint" />
            <mxPoint x="94.96000000000004" y="160" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-12" value="" style="endArrow=none;html=1;rounded=0;" parent="PKBRhwWGn7sbWwzWUMB2-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="184.95000000000005" y="170" as="sourcePoint" />
            <mxPoint x="184.95000000000005" y="160" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-13" value="\(1\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;" parent="PKBRhwWGn7sbWwzWUMB2-1" vertex="1">
          <mxGeometry x="135" y="170" width="10" height="15" as="geometry" />
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-14" value="\(1-\epsilon\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;" parent="PKBRhwWGn7sbWwzWUMB2-1" vertex="1">
          <mxGeometry x="90" y="170" width="10" height="15" as="geometry" />
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-15" value="\(1+\epsilon\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;" parent="PKBRhwWGn7sbWwzWUMB2-1" vertex="1">
          <mxGeometry x="180" y="170" width="10" height="15" as="geometry" />
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-16" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;rounded=0;" parent="PKBRhwWGn7sbWwzWUMB2-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="94.96000000000004" y="165" as="sourcePoint" />
            <mxPoint x="95" y="125" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-18" value="" style="endArrow=none;html=1;rounded=0;dashed=1;strokeColor=#007FFF;strokeWidth=2;" parent="PKBRhwWGn7sbWwzWUMB2-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="95" y="125" as="sourcePoint" />
            <mxPoint x="55" y="125" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-19" value="\((1-\epsilon)A\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;" parent="PKBRhwWGn7sbWwzWUMB2-1" vertex="1">
          <mxGeometry y="115" width="50" height="20" as="geometry" />
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-20" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;rounded=0;" parent="PKBRhwWGn7sbWwzWUMB2-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="184.95000000000005" y="165" as="sourcePoint" />
            <mxPoint x="185" y="35" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-21" value="" style="endArrow=none;html=1;rounded=0;dashed=1;strokeColor=#007FFF;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;strokeWidth=2;" parent="PKBRhwWGn7sbWwzWUMB2-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="235" y="35" as="sourcePoint" />
            <mxPoint x="185" y="34.960000000000036" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-22" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;rounded=0;" parent="PKBRhwWGn7sbWwzWUMB2-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="55" y="35" as="sourcePoint" />
            <mxPoint x="185" y="35" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-23" value="\((1+\epsilon)A\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;" parent="PKBRhwWGn7sbWwzWUMB2-1" vertex="1">
          <mxGeometry y="25" width="50" height="20" as="geometry" />
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-24" value="" style="endArrow=none;html=1;rounded=0;dashed=1;strokeColor=#007FFF;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;strokeWidth=2;" parent="PKBRhwWGn7sbWwzWUMB2-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="95" y="125" as="sourcePoint" />
            <mxPoint x="185" y="35" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-25" value="\(y_2 = \text{clip}(r, 1-\epsilon, 1+\epsilon) \cdot A\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontColor=#007FFF;" parent="PKBRhwWGn7sbWwzWUMB2-1" vertex="1">
          <mxGeometry x="255" y="15" width="145" height="30" as="geometry" />
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-26" value="为了增大 \(J\) ，应当更新 \(\theta\) 的值使 \(r\) 增大；&lt;div&gt;如果&amp;nbsp;&lt;span style=&quot;background-color: initial;&quot;&gt;\(r\) 变得比 \(1+\epsilon\) 大，那么\(J\) 的梯度变为0；&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;\(r\)无法继续更新，从而限制了 \(\theta\) 更新的幅度。&lt;/span&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;" parent="PKBRhwWGn7sbWwzWUMB2-1" vertex="1">
          <mxGeometry x="200" y="95" width="255" height="50" as="geometry" />
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-27" value="\(r(\theta_{\text{old}})\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;" parent="PKBRhwWGn7sbWwzWUMB2-1" vertex="1">
          <mxGeometry x="112.5" y="210" width="55" height="15" as="geometry" />
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-28" value="" style="endArrow=classic;html=1;rounded=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="PKBRhwWGn7sbWwzWUMB2-1" source="0sy7PDOA3QsTIWjxpfF0-13" target="0sy7PDOA3QsTIWjxpfF0-27" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="150" y="230" as="sourcePoint" />
            <mxPoint x="200" y="180" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-30" value="" style="endArrow=none;html=1;rounded=0;fontColor=#000000;strokeColor=#FF0000;strokeWidth=1;" parent="PKBRhwWGn7sbWwzWUMB2-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="58" y="165" as="sourcePoint" />
            <mxPoint x="235" y="37" as="targetPoint" />
            <Array as="points">
              <mxPoint x="186" y="37" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-31" value="\(J=\min (y_1, y_2)\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontColor=#FF0000;" parent="PKBRhwWGn7sbWwzWUMB2-1" vertex="1">
          <mxGeometry x="190" y="35" width="105" height="30" as="geometry" />
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-32" value="" style="endArrow=classic;html=1;rounded=0;" parent="PKBRhwWGn7sbWwzWUMB2-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="140" y="155" as="sourcePoint" />
            <mxPoint x="180" y="155" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-33" value="\(r(\theta_{\text{new}})\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;" parent="PKBRhwWGn7sbWwzWUMB2-1" vertex="1">
          <mxGeometry x="135" y="135" width="45" height="15" as="geometry" />
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-67" value="" style="group;strokeColor=none;strokeWidth=2;" parent="PKBRhwWGn7sbWwzWUMB2-2" vertex="1" connectable="0">
          <mxGeometry x="5" y="240" width="460" height="220" as="geometry" />
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-38" value="" style="endArrow=classic;html=1;rounded=0;" parent="0sy7PDOA3QsTIWjxpfF0-67" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="55" y="220" as="sourcePoint" />
            <mxPoint x="55" y="40" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-39" value="" style="endArrow=classic;html=1;rounded=0;" parent="0sy7PDOA3QsTIWjxpfF0-67" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="55" y="60" as="sourcePoint" />
            <mxPoint x="235" y="60" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-40" value="\(r\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;" parent="0sy7PDOA3QsTIWjxpfF0-67" vertex="1">
          <mxGeometry x="235" y="50" width="15" height="20" as="geometry" />
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-41" value="" style="endArrow=none;html=1;rounded=0;" parent="0sy7PDOA3QsTIWjxpfF0-67" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="55" y="60" as="sourcePoint" />
            <mxPoint x="210" y="215" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-42" value="\(y_1=r \cdot A\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;" parent="0sy7PDOA3QsTIWjxpfF0-67" vertex="1">
          <mxGeometry x="227.5" y="205" width="30" height="15" as="geometry" />
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-43" value="\(A&amp;lt;0\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;" parent="0sy7PDOA3QsTIWjxpfF0-67" vertex="1">
          <mxGeometry x="302.5" y="90" width="50" height="20" as="geometry" />
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-44" value="" style="endArrow=none;html=1;rounded=0;" parent="0sy7PDOA3QsTIWjxpfF0-67" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="140" y="65" as="sourcePoint" />
            <mxPoint x="140" y="55" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-45" value="" style="endArrow=none;html=1;rounded=0;" parent="0sy7PDOA3QsTIWjxpfF0-67" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="94.96000000000004" y="65" as="sourcePoint" />
            <mxPoint x="94.96000000000004" y="55" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-46" value="" style="endArrow=none;html=1;rounded=0;" parent="0sy7PDOA3QsTIWjxpfF0-67" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="184.95000000000005" y="65" as="sourcePoint" />
            <mxPoint x="184.95000000000005" y="55" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-47" value="\(1\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;" parent="0sy7PDOA3QsTIWjxpfF0-67" vertex="1">
          <mxGeometry x="135" y="40" width="10" height="15" as="geometry" />
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-48" value="\(1-\epsilon\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;" parent="0sy7PDOA3QsTIWjxpfF0-67" vertex="1">
          <mxGeometry x="90" y="40" width="10" height="15" as="geometry" />
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-49" value="\(1+\epsilon\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;" parent="0sy7PDOA3QsTIWjxpfF0-67" vertex="1">
          <mxGeometry x="180" y="40" width="10" height="15" as="geometry" />
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-50" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;rounded=0;" parent="0sy7PDOA3QsTIWjxpfF0-67" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="95" y="60" as="sourcePoint" />
            <mxPoint x="95" y="100" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-51" value="" style="endArrow=none;html=1;rounded=0;dashed=1;strokeColor=#007FFF;strokeWidth=2;" parent="0sy7PDOA3QsTIWjxpfF0-67" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="95" y="100" as="sourcePoint" />
            <mxPoint x="55" y="100" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-52" value="\((1-\epsilon)A\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;" parent="0sy7PDOA3QsTIWjxpfF0-67" vertex="1">
          <mxGeometry y="90" width="50" height="20" as="geometry" />
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-53" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;rounded=0;" parent="0sy7PDOA3QsTIWjxpfF0-67" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="185" y="190" as="sourcePoint" />
            <mxPoint x="184.97000000000003" y="60" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-54" value="" style="endArrow=none;html=1;rounded=0;dashed=1;strokeColor=#007FFF;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;strokeWidth=2;" parent="0sy7PDOA3QsTIWjxpfF0-67" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="240" y="190" as="sourcePoint" />
            <mxPoint x="185" y="190" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-55" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;rounded=0;" parent="0sy7PDOA3QsTIWjxpfF0-67" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="55" y="190" as="sourcePoint" />
            <mxPoint x="185" y="190" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-56" value="\((1+\epsilon)A\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;" parent="0sy7PDOA3QsTIWjxpfF0-67" vertex="1">
          <mxGeometry y="180" width="50" height="20" as="geometry" />
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-57" value="" style="endArrow=none;html=1;rounded=0;dashed=1;strokeColor=#007FFF;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;strokeWidth=2;" parent="0sy7PDOA3QsTIWjxpfF0-67" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="95" y="100" as="sourcePoint" />
            <mxPoint x="185" y="190" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-58" value="\(y_2=\text{clip}(r, 1-\epsilon, 1+\epsilon) \cdot A\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontColor=#007FFF;" parent="0sy7PDOA3QsTIWjxpfF0-67" vertex="1">
          <mxGeometry x="257.5" y="165" width="145" height="30" as="geometry" />
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-59" value="为了增大 \(J\) ，应当更新 \(\theta\) 的值使 \(r\) 减小；&lt;div&gt;如果&amp;nbsp;&lt;span style=&quot;background-color: initial;&quot;&gt;\(r\) 变得比 \(1-\epsilon\) 小，那么\(J\) 的梯度变为 \(0\)；&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;\(r\)无法继续更新，从而限制了 \(\theta\) 更新的幅度&lt;/span&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fillColor=none;strokeColor=default;" parent="0sy7PDOA3QsTIWjxpfF0-67" vertex="1">
          <mxGeometry x="200" y="110" width="260" height="50" as="geometry" />
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-60" value="\(r(\theta_{\text{old}})\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;" parent="0sy7PDOA3QsTIWjxpfF0-67" vertex="1">
          <mxGeometry x="112.5" width="55" height="15" as="geometry" />
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-61" value="" style="endArrow=classic;html=1;rounded=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;" parent="0sy7PDOA3QsTIWjxpfF0-67" source="0sy7PDOA3QsTIWjxpfF0-47" target="0sy7PDOA3QsTIWjxpfF0-60" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="140" y="65" as="sourcePoint" />
            <mxPoint x="140" y="40" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-62" value="" style="endArrow=none;html=1;rounded=0;fontColor=#000000;strokeColor=#FF0000;strokeWidth=1;" parent="0sy7PDOA3QsTIWjxpfF0-67" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="56" y="102" as="sourcePoint" />
            <mxPoint x="208" y="216" as="targetPoint" />
            <Array as="points">
              <mxPoint x="94" y="102" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-63" value="\(J=\min (y_1, y_2)\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontColor=#FF0000;" parent="0sy7PDOA3QsTIWjxpfF0-67" vertex="1">
          <mxGeometry x="95" y="160" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-64" value="" style="endArrow=classic;html=1;rounded=0;" parent="0sy7PDOA3QsTIWjxpfF0-67" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="140" y="70" as="sourcePoint" />
            <mxPoint x="100" y="70" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="0sy7PDOA3QsTIWjxpfF0-65" value="\(r(\theta_{\text{new}})\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;" parent="0sy7PDOA3QsTIWjxpfF0-67" vertex="1">
          <mxGeometry x="100" y="75" width="45" height="15" as="geometry" />
        </mxCell>
        <mxCell id="FhUIJi_ACO7DtZTB_gNP-15" value="" style="endArrow=none;dashed=1;html=1;rounded=0;fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;resizable=0;" parent="PKBRhwWGn7sbWwzWUMB2-2" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="5" y="235" as="sourcePoint" />
            <mxPoint x="465" y="235" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="PKBRhwWGn7sbWwzWUMB2-5" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="0sy7PDOA3QsTIWjxpfF0-3" target="PKBRhwWGn7sbWwzWUMB2-7" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1410" y="-865" as="sourcePoint" />
            <mxPoint x="1400" y="-880" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="PKBRhwWGn7sbWwzWUMB2-6" value="等价形式" style="edgeLabel;resizable=0;html=1;;align=center;verticalAlign=middle;fontSize=12;fontFamily=更纱黑体 SC;" parent="PKBRhwWGn7sbWwzWUMB2-5" connectable="0" vertex="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="PKBRhwWGn7sbWwzWUMB2-8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="PKBRhwWGn7sbWwzWUMB2-7" target="PKBRhwWGn7sbWwzWUMB2-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="PKBRhwWGn7sbWwzWUMB2-7" value="\(J = \min \left[r \cdot A, h(\epsilon, A)\right], \quad \text{where} \, h(\epsilon, A) = \begin{cases}&lt;br&gt;&amp;nbsp; &amp;nbsp; (1 + \epsilon) \cdot A, &amp;amp; A \geqslant 0; \\&lt;br&gt;&amp;nbsp; &amp;nbsp; (1 - \epsilon) \cdot A, &amp;amp; A &amp;lt; 0.\end{cases}\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="1720" y="-880" width="540" height="60" as="geometry" />
        </mxCell>
        <mxCell id="FhUIJi_ACO7DtZTB_gNP-18" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;resizable=0;" parent="1" source="nFzaZGQqQUoIvIIh4y-_-1" target="nFzaZGQqQUoIvIIh4y-_-3" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="-740" y="-810" />
              <mxPoint x="-740" y="-575" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="FhUIJi_ACO7DtZTB_gNP-19" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;resizable=0;" parent="1" source="nFzaZGQqQUoIvIIh4y-_-1" target="nFzaZGQqQUoIvIIh4y-_-4" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="-740" y="-810" />
              <mxPoint x="-740" y="-440" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="FhUIJi_ACO7DtZTB_gNP-20" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;resizable=0;" parent="1" source="nFzaZGQqQUoIvIIh4y-_-1" target="nFzaZGQqQUoIvIIh4y-_-5" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="-740" y="-810" />
              <mxPoint x="-740" y="-290" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="nFzaZGQqQUoIvIIh4y-_-1" value="解决 DDPG 的高估问题" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="-680" y="-830" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="FhUIJi_ACO7DtZTB_gNP-21" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;resizable=0;" parent="1" source="nFzaZGQqQUoIvIIh4y-_-3" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-300" y="-180" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nFzaZGQqQUoIvIIh4y-_-3" value="&lt;h1&gt;&lt;span style=&quot;box-sizing: border-box;&quot;&gt;Clipped Double-Q Learning&lt;/span&gt;&lt;/h1&gt;&lt;div&gt;&lt;ul&gt;&lt;li&gt;&lt;span style=&quot;box-sizing: border-box;&quot;&gt;使用两个价值网络&amp;nbsp;\(q (\textcolor{green}{s}, \textcolor{red}{a}; \omega_1)\) 和&amp;nbsp;\(q (\textcolor{green}{s}, \textcolor{red}{a}; \omega_2)\)&lt;/span&gt;&lt;/li&gt;&lt;li&gt;对应两个 target network \(q (\textcolor{green}{s}, \textcolor{red}{a}; \omega_1^-)\) 和&amp;nbsp;\(q (\textcolor{green}{s}, \textcolor{red}{a}; \omega_2^-)\)&lt;/li&gt;&lt;li&gt;在计算 TD target 时，\(q_{t+1}\) 的值选取两个 target network 输出中较小的值 \(q_{t+1} = \min\limits_{i=1,2} q(\textcolor{green}{s_{t+1}},\textcolor{red}{a&#39;_{t+1}};\omega_i^-)\)&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;" style="text;html=1;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;dashed=1;" parent="1" vertex="1">
          <mxGeometry x="-720" y="-640" width="400" height="130" as="geometry" />
        </mxCell>
        <mxCell id="FhUIJi_ACO7DtZTB_gNP-22" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;resizable=0;" parent="1" source="nFzaZGQqQUoIvIIh4y-_-4" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-300" y="-180" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nFzaZGQqQUoIvIIh4y-_-4" value="&lt;h1&gt;&lt;span style=&quot;box-sizing: border-box;&quot;&gt;&quot;Delayed&quot; Policy Updates&lt;/span&gt;&lt;br&gt;&lt;/h1&gt;&lt;div&gt;&lt;ul&gt;&lt;li&gt;策略网络的更新频率比价值网络低&lt;/li&gt;&lt;li&gt;每更新两次价值网络之后，更新一次策略网络&lt;/li&gt;&lt;li&gt;每更新两次价值网络的 target network 之后，更新一次策略网络的 target network&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;" style="text;html=1;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;dashed=1;" parent="1" vertex="1">
          <mxGeometry x="-720" y="-500" width="400" height="120" as="geometry" />
        </mxCell>
        <mxCell id="FhUIJi_ACO7DtZTB_gNP-23" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;resizable=0;" parent="1" source="nFzaZGQqQUoIvIIh4y-_-5" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-300" y="-180" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nFzaZGQqQUoIvIIh4y-_-5" value="&lt;h1&gt;&lt;span style=&quot;box-sizing: border-box;&quot;&gt;Target Policy Smoothing&lt;/span&gt;&lt;br&gt;&lt;/h1&gt;&lt;div&gt;&lt;ul&gt;&lt;li&gt;在计算 \(q_{t+1}\) 时所用到的 target action \(\textcolor{red}{a&#39;_{t+1}}\) 上添加截断的高斯噪声 \(\textcolor{red}{a&#39;_{t+1}} =&amp;nbsp;\pi (\textcolor{green}{s_{t+1}}; \theta_t^-) + \text{clip}(\epsilon, -c, c)\) ，其中 \(\epsilon \sim N(0, \sigma^2)\)&lt;/li&gt;&lt;li&gt;通过给 \(\textcolor{red}{a&#39;_{t+1}}\) 添加噪声，可以避免由价值网络估计误差导致的过度自信的问题&lt;/li&gt;&lt;li&gt;如果价值网络在更新过程中对某个动作的评分过高，那么策略网络会误以为该动作最好。这时给策略网络输出的动作添加噪声可以避免选中该动作，从而规避该问题。&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;" style="text;html=1;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;dashed=1;" parent="1" vertex="1">
          <mxGeometry x="-720" y="-370" width="400" height="160" as="geometry" />
        </mxCell>
        <mxCell id="nFzaZGQqQUoIvIIh4y-_-8" value="&lt;h1&gt;孪生延迟深度确定性策略梯度&amp;nbsp;(Twin Delayed DDPG, TD3)&lt;/h1&gt;&lt;p&gt;&lt;/p&gt;初始化策略网络 \(\pi (\textcolor{green}{s}; \theta)\) ；两个价值网络&amp;nbsp;&lt;span style=&quot;text-align: center;&quot;&gt;\(q (\textcolor{green}{s}, \textcolor{red}{a}; \omega_1)\) ，&lt;/span&gt;&lt;span style=&quot;text-align: center;&quot;&gt;\(q (\textcolor{green}{s}, \textcolor{red}{a}; \omega_2)\)&lt;/span&gt;&lt;div&gt;&lt;span style=&quot;text-align: center;&quot;&gt;三个网络对应的 target network&amp;nbsp;&lt;/span&gt;\(\pi (\textcolor{green}{s}; \theta^-)\) ，\(q (\textcolor{green}{s}, \textcolor{red}{a}; \omega_1^-)\) ，\(q (\textcolor{green}{s}, \textcolor{red}{a}; \omega_2^-)\)；其中 \(\theta^- = \theta\) ，\(\omega_1^- = \omega_1\) ，\(\omega_2^- = \omega_2\)&lt;/div&gt;&lt;div&gt;设置策略网络、所有 target network 的更新频率为&lt;span style=&quot;background-color: initial;&quot;&gt;\(N_{update}\)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;ol&gt;&lt;li&gt;根据当前状态 \(\textcolor{green}{s_t}\) 执行动作 \(\textcolor{red}{a_t} = \pi (\textcolor{green}{s_t}; \theta_t)\) ，得到奖励 \(\textcolor{blue}{r_t}\) 和下一个状态 \(\textcolor{green}{s_{t+1}}\)&lt;/li&gt;&lt;li&gt;选择 target action&amp;nbsp;\(\textcolor{red}{a&#39;_{t+1}} =&amp;nbsp;\pi (\textcolor{green}{s_{t+1}}; \theta_t^-) + \text{clip}(\epsilon, -c, c)\) ，其中 \(\epsilon \sim N(0, \sigma^2)\)&lt;/li&gt;&lt;li&gt;使用 target network 计算&amp;nbsp;\(q_{t+1} = \min\limits_{i=1,2} q(\textcolor{green}{s_{t+1}},\textcolor{red}{a&#39;_{t+1}};\omega_{i,t}^-)\)&lt;br&gt;&lt;/li&gt;&lt;li&gt;计算 TD target \(y_t = \textcolor{blue}{r_t} + \gamma \cdot q_{t+1}\)&lt;/li&gt;&lt;li&gt;分别计算两个价值网络的 TD error \(\delta_{i,t} = q(\textcolor{green}{s_t}, \textcolor{red}{a_t}; \omega_{i,t}) - y_t\) ，其中 \(i=1,2\)&lt;/li&gt;&lt;li&gt;使用梯度下降更新两个价值网络 \(\omega_{i,t+1} \leftarrow \omega_{i,t} - \alpha \cdot \delta_{i,t} \cdot \frac{\partial q (\textcolor{green}{s_t}, \textcolor{red}{a_t}; \omega)}{\partial \omega} |_{\omega = \omega_{i,t}}\) ，其中 \(i=1,2\)&lt;/li&gt;&lt;li&gt;如果当前 step 计数 % \(N_{update}\) == 0&lt;/li&gt;&lt;ol&gt;&lt;li&gt;使用第一个价值网络计算确定策略梯度&amp;nbsp;\(g= \frac{\partial \textcolor{red}{a}}{\partial \theta} \cdot \frac{\partial q (\textcolor{green}{s}, \textcolor{red}{a}; \omega)}{\partial \textcolor{red}{a}} = \frac{\partial&amp;nbsp;\pi (\textcolor{green}{s_t}; \theta)}{\partial \theta} |_{\theta = \theta_t} \cdot \frac{\partial q (\textcolor{green}{s_t}, \textcolor{red}{a}; \omega_{1,t})}{\partial \textcolor{red}{a}} |_{\textcolor{red}{a} = \textcolor{red}{a_t}}\)&lt;/li&gt;&lt;li&gt;使用策略梯度上升更新策略网络 \(\theta_{t+1} \leftarrow \theta_t + \beta \cdot g\)&lt;/li&gt;&lt;li&gt;更新所有 target network 参数&lt;/li&gt;&lt;/ol&gt;&lt;ul&gt;&lt;ul&gt;&lt;li&gt;\(\theta^- \leftarrow \tau \cdot \theta + (1-\tau) \cdot \theta^-\)&lt;/li&gt;&lt;li&gt;\(\omega_i^- \leftarrow \tau \cdot \omega_i + (1-\tau) \cdot \omega_i^-\) ，其中 \(i=1,2\)&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;/ol&gt;&lt;div&gt;实现算法时应当先判断、更新策略网络，再更新价值网络。因为更新策略网络需要用到价值网络更新前的参数 \(\omega_{1,t}\)&lt;/div&gt;&lt;/div&gt;" style="text;html=1;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;movable=1;resizable=1;rotatable=1;deletable=1;editable=1;locked=0;connectable=1;" parent="1" vertex="1">
          <mxGeometry x="-720" y="-180" width="640" height="350" as="geometry" />
        </mxCell>
        <mxCell id="nFzaZGQqQUoIvIIh4y-_-17" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="nFzaZGQqQUoIvIIh4y-_-16" target="tXlBBBqLK87PE_aL1Him-1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="nFzaZGQqQUoIvIIh4y-_-16" value="注：对于有范围限制的动作 \(\textcolor{red}{a} \in \left[a_{Low}, a_{High}\right]\) ，&lt;div&gt;&lt;/div&gt;&lt;div&gt;在计算动作值时都应该使用 clip 函数限制范围：\(\textcolor{red}{a} = \text{clip} (\pi,&amp;nbsp;a_{Low},&amp;nbsp;a_{High})\) ；&lt;/div&gt;&lt;div&gt;无论是使用确定策略还是通过分布抽样，抑或是计算 target action 时。&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="1" vertex="1">
          <mxGeometry x="600" y="-400" width="340" height="100" as="geometry" />
        </mxCell>
        <mxCell id="TgyzTicbPKKycS4cvX0--5" value="&lt;h1&gt;&lt;span style=&quot;box-sizing: border-box; font-size: 25px;&quot;&gt;参考资料&lt;/span&gt;&lt;br&gt;&lt;/h1&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/wangshusen/DRL/tree/master/Notes_CN&quot;&gt;《深度强化学习》王树森&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/wangshusen/DRL&quot;&gt;深度强化学习课程&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://stable-baselines3.readthedocs.io/&quot;&gt;Stable-Baselines3&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://spinningup.openai.com/en/latest/index.html&quot;&gt;Open AI Spinning Up in Deep RL&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://www.youtube.com/watch?v=5P7I-xPq8u8&quot;&gt;PPO explanation&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;" style="text;html=1;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontFamily=更纱黑体 SC;strokeColor=#B3B3B3;" parent="1" vertex="1">
          <mxGeometry x="-720" y="300" width="360" height="180" as="geometry" />
        </mxCell>
        <mxCell id="oxRVo8cIm43kBPhRHE0V-1" value="&lt;p&gt;This work by &lt;a href=&quot;https://github.com/liuzhaoze&quot; rel=&quot;cc:attributionURL dct:creator&quot;&gt;liuzhaoze&lt;/a&gt; is licensed under &lt;a style=&quot;display:inline-block;&quot; rel=&quot;license noopener noreferrer&quot; target=&quot;_blank&quot; href=&quot;https://creativecommons.org/licenses/by-nc-nd/4.0/?ref=chooser-v1&quot;&gt;CC BY-NC-ND 4.0&lt;img alt=&quot;&quot; src=&quot;https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1&quot; style=&quot;height:25px!important;margin-left:3px;vertical-align:text-bottom;&quot;&gt;&lt;img alt=&quot;&quot; src=&quot;https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1&quot; style=&quot;height:25px!important;margin-left:3px;vertical-align:text-bottom;&quot;&gt;&lt;img alt=&quot;&quot; src=&quot;https://mirrors.creativecommons.org/presskit/icons/nc.svg?ref=chooser-v1&quot; style=&quot;height:25px!important;margin-left:3px;vertical-align:text-bottom;&quot;&gt;&lt;img alt=&quot;&quot; src=&quot;https://mirrors.creativecommons.org/presskit/icons/nd.svg?ref=chooser-v1&quot; style=&quot;height:25px!important;margin-left:3px;vertical-align:text-bottom;&quot;&gt;&lt;/a&gt;&lt;/p&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=25;strokeColor=default;" parent="1" vertex="1">
          <mxGeometry x="3080" y="1020" width="900" height="100" as="geometry" />
        </mxCell>
        <mxCell id="oxRVo8cIm43kBPhRHE0V-2" value="&lt;a href=&quot;https://liuzhaoze.github.io/&quot; style=&quot;font-size: 25px;&quot;&gt;个人主页&lt;/a&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=25;strokeColor=#B3B3B3;" parent="1" vertex="1">
          <mxGeometry x="-720" y="250" width="360" height="50" as="geometry" />
        </mxCell>
        <mxCell id="P27bC8qoyPHywM3mTXsK-4" value="价值学习" style="shape=ext;double=1;rounded=0;whiteSpace=wrap;html=1;fontFamily=更纱黑体 SC;fontStyle=1;fontSize=20;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="60" y="565" width="180" height="50" as="geometry" />
        </mxCell>
        <mxCell id="izn_Thb5sT5Ji-PQS5y_-4" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.66;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="izn_Thb5sT5Ji-PQS5y_-1" target="izn_Thb5sT5Ji-PQS5y_-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="izn_Thb5sT5Ji-PQS5y_-3" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.33;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="PvOujxNg_PI-_giluGQt-6" target="izn_Thb5sT5Ji-PQS5y_-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="FhUIJi_ACO7DtZTB_gNP-7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;resizable=0;" parent="1" source="P27bC8qoyPHywM3mTXsK-9" target="SyCfzCqmaqDro-8NCypD-5" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="P27bC8qoyPHywM3mTXsK-9" value="策略学习" style="shape=ext;double=1;rounded=0;whiteSpace=wrap;html=1;fontFamily=更纱黑体 SC;fontStyle=1;fontSize=20;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="1120" y="95" width="180" height="50" as="geometry" />
        </mxCell>
        <mxCell id="FhUIJi_ACO7DtZTB_gNP-24" value="&lt;b&gt;DQN高级技巧：Double DQN&lt;/b&gt;&lt;br&gt;在计算 TD target 时&lt;br&gt;&lt;ul&gt;&lt;li&gt;先使用 DQN 选择动作 \(\textcolor{red}{a^{\star}} = \mathop{\text{argmax}}\limits_{\textcolor{red}{a}} \, Q(\textcolor{green}{s_{t+1}}, \textcolor{red}{a}; \omega_t)\)&lt;/li&gt;&lt;li&gt;再使用 target network 计算 TD target \(y_t = \textcolor{blue}{r_t} + \gamma \cdot Q(\textcolor{green}{s_{t+1}}, \textcolor{red}{a^{\star}}; \omega_t^-)\)&lt;/li&gt;&lt;/ul&gt;缓解自举（bootstrap）更新网络参数导致的高估问题" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;dashed=1;" parent="1" vertex="1">
          <mxGeometry x="-720" y="830" width="500" height="120" as="geometry" />
        </mxCell>
        <mxCell id="FhUIJi_ACO7DtZTB_gNP-25" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.75;entryDx=0;entryDy=0;entryPerimeter=0;fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;resizable=0;" parent="1" source="FhUIJi_ACO7DtZTB_gNP-24" target="PvOujxNg_PI-_giluGQt-31" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram name="第 2 页" id="R_zPpQoCucMGlSv_RsUl">
    <mxGraphModel dx="6703" dy="4631" grid="1" gridSize="5" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="0" pageScale="1" pageWidth="1169" pageHeight="827" math="1" shadow="0">
      <root>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-0" />
        <mxCell id="KOUpriuUwOJteqnQQ4VB-1" parent="KOUpriuUwOJteqnQQ4VB-0" />
        <mxCell id="KOUpriuUwOJteqnQQ4VB-2" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=none;strokeWidth=4;movable=0;resizable=0;rotatable=0;deletable=0;editable=0;locked=1;connectable=0;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="-760" y="-980" width="4760" height="2120" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-3" value="深度强化学习" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=25;strokeColor=default;strokeWidth=4;horizontal=1;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="-20" width="40" height="250" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-4" value="术语" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;fontSize=15;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="40" y="100" width="100" height="150" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-5" value="状态 \(\textcolor{green}{s \in \mathcal{S}}\)" style="text;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;fontFamily=更纱黑体 SC;fontSize=15;" parent="KOUpriuUwOJteqnQQ4VB-4" vertex="1">
          <mxGeometry y="30" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-6" value="动作 \(\textcolor{red}{a \in \mathcal{A}}\)" style="text;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;fontSize=15;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-4" vertex="1">
          <mxGeometry y="60" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-7" value="策略 \(\textcolor{purple}{\pi}(\textcolor{red}{a}&amp;nbsp;|\textcolor{green}{s})\)" style="text;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;fontSize=15;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-4" vertex="1">
          <mxGeometry y="90" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-8" value="奖励 \(\textcolor{blue}{r}\)" style="text;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;fontSize=15;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-4" vertex="1">
          <mxGeometry y="120" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-9" value="未观测时使用随机变量" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;fontSize=15;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="170" y="100" width="170" height="150" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-10" value="状态 \(\textcolor{green}{S}\)" style="text;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;fontFamily=更纱黑体 SC;fontSize=15;" parent="KOUpriuUwOJteqnQQ4VB-9" vertex="1">
          <mxGeometry y="30" width="170" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-11" value="动作 \(\textcolor{red}{A}\)" style="text;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;fontSize=15;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-9" vertex="1">
          <mxGeometry y="60" width="170" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-12" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;fontSize=15;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-9" vertex="1">
          <mxGeometry y="90" width="170" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-13" value="奖励 \(\textcolor{blue}{R}\)" style="text;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;fontSize=15;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-9" vertex="1">
          <mxGeometry y="120" width="170" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-14" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-5" target="KOUpriuUwOJteqnQQ4VB-10" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-15" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-6" target="KOUpriuUwOJteqnQQ4VB-11" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-16" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-8" target="KOUpriuUwOJteqnQQ4VB-13" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-17" value="&lt;b style=&quot;&quot;&gt;&lt;font color=&quot;#7f00ff&quot;&gt;折扣回报&lt;/font&gt;&lt;/b&gt; \(U_t = \textcolor{blue}{R_t} + \gamma&amp;nbsp; \textcolor{blue}{R_{t+1}} + \gamma ^2&amp;nbsp; \textcolor{blue}{R_{t+2}} + \gamma ^3&amp;nbsp; \textcolor{blue}{R_{t+3}} + \cdots \)&lt;br&gt;\(\gamma\) ：折扣率" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeWidth=1;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="460" y="215" width="420" height="40" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-18" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-13" target="KOUpriuUwOJteqnQQ4VB-17" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="395" y="220" as="sourcePoint" />
            <mxPoint x="445" y="290" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-19" value="&lt;span style=&quot;font-family: &amp;quot;更纱黑体 SC&amp;quot;; font-size: 12px;&quot;&gt;奖励的累加&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="KOUpriuUwOJteqnQQ4VB-18" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-20" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-21" target="KOUpriuUwOJteqnQQ4VB-30" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ePppuBc8XawBLdEQSskw-0" value="&lt;span style=&quot;font-family: &amp;quot;更纱黑体 SC&amp;quot;; font-size: 12px;&quot;&gt;在 \(t\) 时刻根据观测到的状态 \(\textcolor{green}{s_t}\) 做出动作 \(\textcolor{red}{a_t}\)，并在后续选择“最优策略”决策&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="KOUpriuUwOJteqnQQ4VB-20">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-21" value="&lt;font color=&quot;#7f00ff&quot;&gt;&lt;b&gt;动作价值函数&lt;/b&gt;&lt;/font&gt;&amp;nbsp;\(Q_{\pi}(\textcolor{green}{s_t}, \textcolor{red}{a_t}) = \mathbb{E}_{\textcolor{green}{S_{t+1}, S_{t+2}, \cdots}, \textcolor{red}{A_{t+1}, A_{t+2}, \cdots}}\left[U_t \middle| \textcolor{green}{S_t = s_t}, \textcolor{red}{A_t = a_t}\right]\)&lt;div&gt;表示后续动作根据策略 \(\pi\) 生成时，当前状态 \(\textcolor{green}{s_t}\) 下动作 \(\textcolor{red}{a_t}\) 的评分&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeWidth=1;strokeColor=#CCCCCC;points=[[0,0,0,0,0],[0,0.25,0,0,0],[0,0.5,0,0,0],[0,0.75,0,0,0],[0,1,0,0,0],[0.25,0,0,0,0],[0.25,1,0,0,0],[0.5,0,0,0,0],[0.5,1,0,0,0],[0.75,0,0,0,0],[0.9,1,0,0,0],[1,0,0,0,0],[1,0.25,0,0,0],[1,0.5,0,0,0],[1,0.75,0,0,0],[1,1,0,0,0]];" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="405" y="330" width="530" height="50" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-22" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-17" target="KOUpriuUwOJteqnQQ4VB-21" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="635" y="40" as="sourcePoint" />
            <mxPoint x="745" y="120" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-23" value="在 \(t\) 时刻根据观测到的状态 \(\textcolor{green}{s_t}\) 做出动作 \(\textcolor{red}{a_t}\)，并在后续始终按策略 \(\pi\) 决策&lt;br&gt;对未来的状态和动作 \(\textcolor{green}{S_{t+1}, S_{t+2}, \cdots}, \textcolor{red}{A_{t+1}, A_{t+2}, \cdots}\) 求期望" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;" parent="KOUpriuUwOJteqnQQ4VB-22" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-24" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-25" target="KOUpriuUwOJteqnQQ4VB-17" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-25" value="奖励 \(\textcolor{blue}{R_t}&lt;br&gt;\) 与当前状态 \(\textcolor{green}{S_t}&lt;br&gt;\) 和做出的动作 \(\textcolor{red}{A_t}&lt;br&gt;\) 有关" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;fontColor=default;strokeWidth=1;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="460" y="150" width="420" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-26" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-27" target="KOUpriuUwOJteqnQQ4VB-11" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="390" y="20" />
              <mxPoint x="390" y="175" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-27" value="动作的概率密度函数（策略函数）\(P\left\{\textcolor{red}{A=a}\middle|\textcolor{green}{S=s}\right\}= \pi (\textcolor{red}{a}&amp;nbsp;|\textcolor{green}{s})\)" style="text;html=1;align=right;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#B3B3B3;strokeWidth=0.5;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="40" width="300" height="40" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-28" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-29" target="KOUpriuUwOJteqnQQ4VB-10" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="370" y="70" />
              <mxPoint x="370" y="145" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-29" value="状态的概率密度函数（状态转移函数）\(P\left\{\textcolor{green}{S&#39;=s&#39;}\middle|\textcolor{green}{S=s}, \textcolor{red}{A=a}\right\}= p(\textcolor{green}{s&#39;}&amp;nbsp;| \textcolor{green}{s}, \textcolor{red}{a})\)" style="text;html=1;align=right;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#B3B3B3;strokeWidth=0.5;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="40" y="50" width="300" height="40" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-30" value="&lt;b&gt;&lt;font color=&quot;#7f00ff&quot;&gt;最优动作价值函数&lt;/font&gt;&lt;/b&gt; \(Q^{\star}(\textcolor{green}{s_t}, \textcolor{red}{a_t}) = \max\limits_{\pi} Q_{\pi}(\textcolor{green}{s_t}, \textcolor{red}{a_t})\)&lt;br&gt;表示状态 \(\textcolor{green}{s_t}\) 下做出动作 \(\textcolor{red}{a_t}\) 所能达到的最高分数，与策略 \(\pi\) 无关" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;fontColor=default;strokeColor=#CCCCCC;strokeWidth=1;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="405" y="460" width="530" height="60" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-31" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-34" target="KOUpriuUwOJteqnQQ4VB-50" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-32" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-34" target="KOUpriuUwOJteqnQQ4VB-149" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-33" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-34" target="KOUpriuUwOJteqnQQ4VB-104" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-34" value="&lt;b&gt;&lt;font color=&quot;#7f00ff&quot;&gt;状态价值函数&lt;/font&gt;&lt;/b&gt; \(V_{\pi}(\textcolor{green}{s_t}) = \mathbb{E}_{\textcolor{red}{A}}\left[Q_{\pi}(\textcolor{green}{s_t}, \textcolor{red}{A})\right]\)&lt;br&gt;表示当前状态 \(\textcolor{green}{s_t}\) 的评分" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="1060" y="330" width="300" height="50" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-35" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-21" target="KOUpriuUwOJteqnQQ4VB-34" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1220" y="170" as="sourcePoint" />
            <mxPoint x="1220" y="255" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-36" value="&lt;span&gt;对动作 \(\textcolor{red}{A}\) 求期望&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;" parent="KOUpriuUwOJteqnQQ4VB-35" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-37" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=1;entryY=1;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-38" target="KOUpriuUwOJteqnQQ4VB-59" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-38" value="\(\mathbb{E}_{\textcolor{green}{S}}\left[V_{\pi}(\textcolor{green}{S})\right]\) 可以评估策略&amp;nbsp;\(\pi\) 的好坏" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="1500" y="330" width="260" height="50" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-39" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-34" target="KOUpriuUwOJteqnQQ4VB-38" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1475" y="335" as="sourcePoint" />
            <mxPoint x="1635" y="335" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-40" value="&lt;span&gt;对状态 \(\textcolor{green}{S}\) 求期望&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;" parent="KOUpriuUwOJteqnQQ4VB-39" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-41" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-30" target="KOUpriuUwOJteqnQQ4VB-43" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="525" y="600" as="sourcePoint" />
            <mxPoint x="685" y="600" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-42" value="&lt;span&gt;使用 \(Q^{\star}\) 决策&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;" parent="KOUpriuUwOJteqnQQ4VB-41" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-43" value="\(\textcolor{red}{a^{\star}} = \mathop{\text{argmax}}\limits_{\textcolor{red}{a}} \, Q^{\star}(\textcolor{green}{s}, \textcolor{red}{a})\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="60" y="465" width="180" height="50" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-44" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-43" target="KOUpriuUwOJteqnQQ4VB-295" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="240" y="560" as="sourcePoint" />
            <mxPoint x="180" y="600" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-45" value="&lt;span&gt;使用神经网络 \(Q(\textcolor{green}{s}, \textcolor{red}{a}; \omega)\) 近似 \(Q^{\star}(\textcolor{green}{s}, \textcolor{red}{a})\)&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;" parent="KOUpriuUwOJteqnQQ4VB-44" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-46" value="&lt;h1&gt;Deep Q-Network (DQN)&lt;/h1&gt;&lt;p&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;观察状态 \(\textcolor{green}{S_t = s_t}\) 并作出动作 \(\textcolor{red}{a_t} = \mathop{\text{argmax}}\limits_{\textcolor{red}{a}} \, Q(\textcolor{green}{s_t}, \textcolor{red}{a})\)&lt;/li&gt;&lt;li&gt;计算价值 \(q_t = Q(\textcolor{green}{s_t}, \textcolor{red}{a_t}; \omega_t)\)&lt;/li&gt;&lt;li&gt;环境给出奖励 \(\textcolor{blue}{r_t}\) 和新的状态 \(\textcolor{green}{s_{t+1}}\)&lt;/li&gt;&lt;li&gt;计算 TD target \(y_t = \textcolor{blue}{r_t} + \gamma \cdot Q(\textcolor{green}{s_{t+1}}, \textcolor{red}{a_{t+1}}; \omega_t) = \textcolor{blue}{r_t} + \gamma \cdot&amp;nbsp; \max\limits_{\textcolor{red}{a}} \, Q(\textcolor{green}{s_{t+1}}, \textcolor{red}{a}; \omega_t)\)&lt;/li&gt;&lt;li&gt;计算 TD error \(\delta_t = q_t - y_t\)&lt;/li&gt;&lt;li&gt;最小化 TD error，定义损失函数 \(L_t = \frac{1}{2} \delta_t^2\)&lt;/li&gt;&lt;li&gt;使用梯度下降最小化损失函数 \(\omega_{t+1} \leftarrow \omega_t - \alpha \cdot \frac{\partial L_t}{\partial \omega}|_{\omega = \omega_t}\)&lt;/li&gt;&lt;/ol&gt;其中 \(\frac{\partial L_t}{\partial \omega} = (q_t - y_t) \cdot \frac{\partial Q(\textcolor{green}{s_t}, \textcolor{red}{a_t}; \omega)}{\partial \omega}|_{\omega = \omega_t}\)&lt;br&gt;&lt;p&gt;&lt;/p&gt;" style="text;html=1;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;points=[[0,0,0,0,0],[0,0.25,0,0,0],[0,0.5,0,0,0],[0,0.75,0,0,0],[0,1,0,0,0],[0.25,0,0,0,0],[0.25,1,0,0,0],[0.5,0,0,0,0],[0.5,1,0,0,0],[0.75,0,0,0,0],[0.75,1,0,0,0],[1,0,0,0,0],[1,0.25,0,0,0],[1,0.5,0,0,0],[1,0.75,0,0,0],[1,1,0,0,0]];" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="-140" y="640" width="580" height="220" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-47" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-295" target="KOUpriuUwOJteqnQQ4VB-46" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-48" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=1;entryY=1;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-38" target="KOUpriuUwOJteqnQQ4VB-299" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="915" y="-55" as="sourcePoint" />
            <mxPoint x="1390" y="-315" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-49" value="&lt;span&gt;指导 \(\pi (\textcolor{red}{a}&amp;nbsp;|\textcolor{green}{s}; \theta)\) 的训练&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontStyle=0;fontFamily=更纱黑体 SC;fontSize=12;" parent="KOUpriuUwOJteqnQQ4VB-48" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-50" value="\(V_{\pi}(\textcolor{green}{s_t}) = \mathbb{E}_{\textcolor{red}{A}}\left[Q_{\pi}(\textcolor{green}{s_t}, \textcolor{red}{A})\right] = \sum\limits_{\textcolor{red}{a}} \pi (\textcolor{red}{a}|\textcolor{green}{s_t}) \cdot Q_{\pi}(\textcolor{green}{s_t}, \textcolor{red}{a})\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="1020" y="215" width="380" height="40" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-51" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-50" target="KOUpriuUwOJteqnQQ4VB-299" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2015" y="195" as="sourcePoint" />
            <mxPoint x="845" y="-180" as="targetPoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-52" value="&lt;span&gt;使用神经网络 \(\pi (\textcolor{red}{a}&amp;nbsp;|\textcolor{green}{s}; \theta)\) 近似策略函数 \(\pi (\textcolor{red}{a}&amp;nbsp;|\textcolor{green}{s})\)&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;" parent="KOUpriuUwOJteqnQQ4VB-51" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-53" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-58" target="KOUpriuUwOJteqnQQ4VB-59" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-54" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-58" target="KOUpriuUwOJteqnQQ4VB-64" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-55" value="代入；交换求导和求和顺序" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;fillColor=none;gradientColor=none;" parent="KOUpriuUwOJteqnQQ4VB-54" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-56" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-58" target="KOUpriuUwOJteqnQQ4VB-184" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-57" value="&lt;font style=&quot;font-size: 12px;&quot;&gt;等价变换&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;" parent="KOUpriuUwOJteqnQQ4VB-56" vertex="1" connectable="0">
          <mxGeometry x="0.0462" y="1" relative="1" as="geometry">
            <mxPoint x="42" y="-1" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-58" value="\(V(\textcolor{green}{s_t}; \theta) = \sum\limits_{\textcolor{red}{a}} \pi (\textcolor{red}{a}|\textcolor{green}{s_t}; \theta) \cdot Q_{\pi}(\textcolor{green}{s_t}, \textcolor{red}{a})\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="920" y="20" width="580" height="40" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-59" value="更新策略网络参数 \(\theta\) 最大化 \(J(\theta) =\mathbb{E}_{\textcolor{green}{S}}\left[V(\textcolor{green}{S}; \theta)\right]\)（使策略函数最好）" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="920" y="-60" width="580" height="40" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-60" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-59" target="KOUpriuUwOJteqnQQ4VB-64" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1740" y="5" as="sourcePoint" />
            <mxPoint x="1740" y="-130" as="targetPoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-61" value="使用策略梯度上升最大化 \(J(\theta)\)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;fillColor=none;gradientColor=none;" parent="KOUpriuUwOJteqnQQ4VB-60" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-62" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.75;exitDx=0;exitDy=0;entryX=0;entryY=0.75;entryDx=0;entryDy=0;fontSize=10;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-64" target="KOUpriuUwOJteqnQQ4VB-71" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-63" value="计算策略梯度" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-62" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-64" value="\(\theta_{t+1} \leftarrow \theta_t + \beta \cdot \frac{\partial V(\textcolor{green}{s}; \theta)}{\partial \theta}\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="1720" y="-65" width="200" height="50" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-65" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-68" target="KOUpriuUwOJteqnQQ4VB-77" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-66" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-68" target="KOUpriuUwOJteqnQQ4VB-124" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-67" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.25;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-68" target="KOUpriuUwOJteqnQQ4VB-204" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-68" value="\(\frac{\partial V(\textcolor{green}{s}; \theta)}{\partial \theta} = \mathbb{E}_{\textcolor{red}{A}}\left[\frac{\partial \ln \pi (\textcolor{red}{A}&amp;nbsp;| \textcolor{green}{s}; \theta)}{\partial \theta} \cdot&amp;nbsp;Q_{\pi}(\textcolor{green}{s}, \textcolor{red}{A})\right]\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="2240" y="150" width="460" height="50" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-69" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.25;exitDx=0;exitDy=0;entryX=1;entryY=0.25;entryDx=0;entryDy=0;fontSize=10;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-71" target="KOUpriuUwOJteqnQQ4VB-64" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-70" value="使用策略梯度更新策略网络" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;fillColor=none;gradientColor=none;" parent="KOUpriuUwOJteqnQQ4VB-69" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-71" value="&lt;b&gt;&lt;font color=&quot;#7f00ff&quot;&gt;策略梯度&lt;/font&gt;&lt;/b&gt; \(\frac{\partial V(\textcolor{green}{s}; \theta)}{\partial \theta} =\sum\limits_{\textcolor{red}{a}} \frac{\partial \pi (\textcolor{red}{a}|\textcolor{green}{s}; \theta)}{\partial \theta} \cdot Q_{\pi}(\textcolor{green}{s}, \textcolor{red}{a})&lt;br&gt;\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="2240" y="-65" width="460" height="50" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-72" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-71" target="KOUpriuUwOJteqnQQ4VB-75" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2025" y="165" as="sourcePoint" />
            <mxPoint x="2115" y="195" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-73" value="\(\frac{\partial \ln \pi (\theta)}{\partial \theta} = \frac{1}{\pi (\theta)} \cdot \frac{\partial \pi (\theta)}{\partial \theta}\)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;fillColor=none;gradientColor=none;" parent="KOUpriuUwOJteqnQQ4VB-72" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-74" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-75" target="KOUpriuUwOJteqnQQ4VB-68" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-75" value="\(\frac{\partial V(\textcolor{green}{s}; \theta)}{\partial \theta} = \sum\limits_{\textcolor{red}{a}} \pi (\textcolor{red}{a}|\textcolor{green}{s}; \theta) \cdot&amp;nbsp;\frac{\partial \ln \pi (\textcolor{red}{a}&amp;nbsp;| \textcolor{green}{s}; \theta)}{\partial \theta} \cdot&amp;nbsp;Q_{\pi}(\textcolor{green}{s}, \textcolor{red}{a})\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="2240" y="60" width="460" height="50" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-76" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-77" target="KOUpriuUwOJteqnQQ4VB-80" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-77" value="&lt;h1&gt;使用蒙特卡罗方法估计策略梯度&lt;/h1&gt;&lt;p&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;根据策略 \(\pi (\cdot |\textcolor{green}{s}; \theta)\) 随机抽样动作 \(\textcolor{red}{\hat{a}}\)&lt;/li&gt;&lt;li&gt;计算随机策略梯度 \(g(\textcolor{red}{\hat{a}}, \theta) =&amp;nbsp;\frac{\partial \ln \pi (\textcolor{red}{\hat{a}}&amp;nbsp;| \textcolor{green}{s}; \theta)}{\partial \theta} \cdot&amp;nbsp;Q_{\pi}(\textcolor{green}{s}, \textcolor{red}{\hat{a}})\)&lt;/li&gt;&lt;/ol&gt;因为 \(\mathbb{E}_{\textcolor{red}{A}}\left[g(\textcolor{red}{A}, \theta)\right] =\frac{\partial V(\textcolor{green}{s}; \theta)}{\partial \theta}\) 所以&amp;nbsp;\(g(\textcolor{red}{\hat{a}}, \theta)\) 是 \(\frac{\partial V(\textcolor{green}{s}; \theta)}{\partial \theta}\) 的无偏估计&lt;br&gt;&lt;p&gt;&lt;/p&gt;" style="text;html=1;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontFamily=更纱黑体 SC;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="2740" y="105" width="400" height="140" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-78" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;resizable=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-80" target="KOUpriuUwOJteqnQQ4VB-81" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-79" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;resizable=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-80" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="3540" y="175" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-80" value="如何计算 \(Q_{\pi}(\textcolor{green}{s}, \textcolor{red}{\hat{a}})\) ？" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="3180" y="155" width="220" height="40" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-81" value="&lt;h1&gt;REINFORCE&lt;/h1&gt;&lt;p&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;完成一整局游戏 \(\textcolor{green}{s_1},\textcolor{red}{a_1}, \textcolor{blue}{r_1}, \textcolor{green}{s_2},\textcolor{red}{a_2}, \textcolor{blue}{r_2}, \cdots, \textcolor{green}{s_T},\textcolor{red}{a_T}, \textcolor{blue}{r_T}\)&lt;/li&gt;&lt;li&gt;使用 \(u_t = \sum\limits_{k=t}^{T} \gamma^{k-t} \textcolor{blue}{r_k}\) 近似 \(Q_{\pi}(\textcolor{green}{s_t}, \textcolor{red}{a_t})\)&lt;/li&gt;&lt;li&gt;梯度上升更新策略网络参数 \(\theta_{t+1} \leftarrow \theta_t + \beta \cdot g(\textcolor{red}{a_t}, \theta_t) = \theta_t + \beta \cdot u_t \cdot \frac{\partial \ln \pi (\textcolor{red}{a_t}|\textcolor{green}{s_t};\theta)}{\partial \theta}&amp;nbsp;|_{\theta = \theta_t}\)&lt;/li&gt;&lt;/ol&gt;&lt;div&gt;一整局游戏 \(\textcolor{green}{s_1},\textcolor{red}{a_1}, \textcolor{blue}{r_1}, \textcolor{green}{s_2},\textcolor{red}{a_2}, \textcolor{blue}{r_2}, \cdots, \textcolor{green}{s_T},\textcolor{red}{a_T}, \textcolor{blue}{r_T}\)&amp;nbsp;结束后，进行 \(T\) 轮更新，分别使用 \(t = 1, 2, \dots, T\) 更新策略网络；然后进行下一局游戏&lt;/div&gt;&lt;p&gt;&lt;/p&gt;" style="text;html=1;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="3080" y="-110" width="420" height="190" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-82" value="&lt;h1&gt;Actor-Critic&lt;/h1&gt;&lt;p&gt;&lt;/p&gt;使用神经网络 \(q(\textcolor{green}{s}, \textcolor{red}{a}; \omega)\) 近似&amp;nbsp;\(Q_{\pi}(\textcolor{green}{s}, \textcolor{red}{a})\) （将状态的特征向量和动作的特征向量拼接起来作为价值网络的输出&lt;br&gt;&lt;ul&gt;&lt;li&gt;Actor：策略网络 \(\pi (\textcolor{red}{a}|\textcolor{green}{s};\theta)\)&lt;/li&gt;&lt;li&gt;Critic：价值网络 \(q(\textcolor{green}{s}, \textcolor{red}{a}; \omega)\)&lt;/li&gt;&lt;/ul&gt;训练流程：&lt;br&gt;&lt;ol&gt;&lt;li&gt;观察状态 \(\textcolor{green}{s_t}\) 并随机抽样动作 \(\textcolor{red}{a_t} \sim \pi (\cdot | \textcolor{green}{s_t}; \theta_t)\)&lt;/li&gt;&lt;li&gt;执行动作 \(\textcolor{red}{a_t}\) 得到环境的新状态 \(\textcolor{green}{s_{t+1}}\) 和奖励 \(\textcolor{blue}{r_t}\)&lt;/li&gt;&lt;li&gt;针对新状态抽样下一个动作 \(\textcolor{red}{\tilde{a}_t} \sim \pi (\cdot | \textcolor{green}{s_{t+1}}; \theta_t)\) 但不执行&lt;/li&gt;&lt;li&gt;计算 \(q_t = q(\textcolor{green}{s_t}, \textcolor{red}{a_t}; \omega_t)\) 以及 \(q_{t+1} = q(\textcolor{green}{s_{t+1}}, \textcolor{red}{\tilde{a}_{t+1}}; \omega_t)\)&lt;/li&gt;&lt;li&gt;计算 TD target \(y_t = \textcolor{blue}{r_t} + \gamma \cdot q_{t+1}\)&lt;/li&gt;&lt;li&gt;计算 TD error \(\delta_t = q_t - y_t\)&lt;/li&gt;&lt;li&gt;计算价值网络的梯度 \(\text{d}_{\omega, t} = \frac{\partial q(\textcolor{green}{s_t}, \textcolor{red}{a_t}; \omega)}{\partial \omega} |_{\omega = \omega_t}\)&lt;/li&gt;&lt;li&gt;&lt;font color=&quot;#ff0000&quot;&gt;梯度下降更新价值网络参数&lt;/font&gt;&amp;nbsp;\(\omega_{t+1} = \omega_t - \alpha \cdot \delta_t \cdot \text{d}_{\omega, t}\)&lt;/li&gt;&lt;li&gt;计算策略网络的梯度 \(\text{d}_{\theta, t} = \frac{\partial \ln \pi (\textcolor{red}{a_t}|\textcolor{green}{s_t};\theta)}{\partial \theta} |_{\theta = \theta_t}\)&lt;/li&gt;&lt;li&gt;&lt;font color=&quot;#ff0000&quot;&gt;梯度上升更新策略网络参数&lt;/font&gt;&amp;nbsp;\(\theta_{t+1} = \theta_t + \beta \cdot q_t \cdot \text{d}_{\theta, t}\)&lt;/li&gt;&lt;/ol&gt;使用 TD 算法更新价值网络；使用策略梯度更新策略网络&lt;br&gt;&lt;p&gt;&lt;/p&gt;" style="text;html=1;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;movable=1;resizable=1;rotatable=1;deletable=1;editable=1;locked=0;connectable=1;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="3540" y="-40" width="440" height="350" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-83" value="TD 算法" style="shape=table;startSize=30;container=1;collapsible=0;childLayout=tableLayout;fontFamily=更纱黑体 SC;fontSize=15;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="620" y="860" width="740" height="260" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-84" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="KOUpriuUwOJteqnQQ4VB-83" vertex="1">
          <mxGeometry y="30" width="740" height="58" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-85" value="" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=更纱黑体 SC;fontSize=16;" parent="KOUpriuUwOJteqnQQ4VB-84" vertex="1">
          <mxGeometry width="100" height="58" as="geometry">
            <mxRectangle width="100" height="58" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-86" value="Sarsa 算法" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=更纱黑体 SC;fontSize=16;" parent="KOUpriuUwOJteqnQQ4VB-84" vertex="1">
          <mxGeometry x="100" width="300" height="58" as="geometry">
            <mxRectangle width="300" height="58" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-87" value="Q-Learning 算法" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=更纱黑体 SC;fontSize=16;" parent="KOUpriuUwOJteqnQQ4VB-84" vertex="1">
          <mxGeometry x="400" width="340" height="58" as="geometry">
            <mxRectangle width="340" height="58" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-88" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="KOUpriuUwOJteqnQQ4VB-83" vertex="1">
          <mxGeometry y="88" width="740" height="58" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-89" value="特点" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=更纱黑体 SC;fontSize=16;" parent="KOUpriuUwOJteqnQQ4VB-88" vertex="1">
          <mxGeometry width="100" height="58" as="geometry">
            <mxRectangle width="100" height="58" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-90" value="计算 TD target 使用的动作来自策略函数&lt;br style=&quot;font-size: 16px;&quot;&gt;\(\textcolor{red}{a_{t+1}} \sim \pi (\cdot | \textcolor{green}{s_{t+1}})\)" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=更纱黑体 SC;fontSize=16;" parent="KOUpriuUwOJteqnQQ4VB-88" vertex="1">
          <mxGeometry x="100" width="300" height="58" as="geometry">
            <mxRectangle width="300" height="58" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-91" value="计算 TD target 使用的动作为价值最高的动作&lt;div style=&quot;font-size: 16px;&quot;&gt;\(\textcolor{red}{a_{t+1}} = \mathop{\text{argmax}}\limits_{\textcolor{red}{a}} \, Q^{\star}(\textcolor{green}{s_{t+1}}, \textcolor{red}{a})\)&lt;br style=&quot;font-size: 16px;&quot;&gt;&lt;/div&gt;" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=更纱黑体 SC;fontSize=16;" parent="KOUpriuUwOJteqnQQ4VB-88" vertex="1">
          <mxGeometry x="400" width="340" height="58" as="geometry">
            <mxRectangle width="340" height="58" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-92" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="KOUpriuUwOJteqnQQ4VB-83" vertex="1">
          <mxGeometry y="146" width="740" height="57" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-93" value="TD target" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=更纱黑体 SC;fontSize=16;" parent="KOUpriuUwOJteqnQQ4VB-92" vertex="1">
          <mxGeometry width="100" height="57" as="geometry">
            <mxRectangle width="100" height="57" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-94" value="\(y_t = \textcolor{blue}{r_t} + \gamma \cdot&amp;nbsp;q(\textcolor{green}{s_{t+1}}, \textcolor{red}{a_{t+1}}; \omega_t)\)" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=更纱黑体 SC;fontSize=16;" parent="KOUpriuUwOJteqnQQ4VB-92" vertex="1">
          <mxGeometry x="100" width="300" height="57" as="geometry">
            <mxRectangle width="300" height="57" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-95" value="\(y_t = \textcolor{blue}{r_t} + \gamma \cdot&amp;nbsp; \max\limits_{\textcolor{red}{a}} \, Q(\textcolor{green}{s_{t+1}}, \textcolor{red}{a}; \omega_t)\)" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=更纱黑体 SC;fontSize=16;" parent="KOUpriuUwOJteqnQQ4VB-92" vertex="1">
          <mxGeometry x="400" width="340" height="57" as="geometry">
            <mxRectangle width="340" height="57" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-96" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="KOUpriuUwOJteqnQQ4VB-83" vertex="1">
          <mxGeometry y="203" width="740" height="57" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-97" value="应用" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=更纱黑体 SC;fontSize=16;" parent="KOUpriuUwOJteqnQQ4VB-96" vertex="1">
          <mxGeometry width="100" height="57" as="geometry">
            <mxRectangle width="100" height="57" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-98" value="Actor-Critic" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=更纱黑体 SC;fontSize=16;" parent="KOUpriuUwOJteqnQQ4VB-96" vertex="1">
          <mxGeometry x="100" width="300" height="57" as="geometry">
            <mxRectangle width="300" height="57" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-99" value="DQN" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=更纱黑体 SC;fontSize=16;" parent="KOUpriuUwOJteqnQQ4VB-96" vertex="1">
          <mxGeometry x="400" width="340" height="57" as="geometry">
            <mxRectangle width="340" height="57" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-100" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.25;entryDx=0;entryDy=0;entryPerimeter=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-101" target="KOUpriuUwOJteqnQQ4VB-46" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-101" value="&lt;b&gt;DQN高级技巧：Experience Replay&lt;/b&gt;&lt;br&gt;&lt;ul&gt;&lt;li&gt;将轨迹 \((\textcolor{green}{s_i}, \textcolor{red}{a_i}, \textcolor{blue}{r_i}, \textcolor{green}{s_{t+i}})\) 存入 Replay Buffer 中&lt;/li&gt;&lt;li&gt;Replay Buffer 中储存最新的 \(N (10^5 \sim 10^6)\) 条轨迹&lt;/li&gt;&lt;li&gt;从 Replay Buffer 中随机抽样 \(T\) (batch size) 条轨迹&lt;/li&gt;&lt;li&gt;使用所有轨迹的均方误差（TD error 平方的平均值）作为损失函数：\(L = \frac{1}{T} \sum\limits_{t=1}^{T} \frac{1}{2} \delta_t^2\)&lt;/li&gt;&lt;/ul&gt;提高轨迹的利用率；消除轨迹之间的相关性" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;dashed=1;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="-720" y="530" width="500" height="140" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-102" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-103" target="KOUpriuUwOJteqnQQ4VB-46" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-103" value="&lt;b&gt;DQN高级技巧：target network&lt;/b&gt;&lt;br&gt;&lt;ul&gt;&lt;li&gt;定义 target network \(Q(\textcolor{green}{s}, \textcolor{red}{a}; \omega^-)\)&lt;/li&gt;&lt;li&gt;初始将 DQN 的网络参数赋值给 target network: \(\omega^- \leftarrow \omega\)&lt;/li&gt;&lt;li&gt;每 \(N_{update}\) 个 step 后更新 target network 的参数&lt;/li&gt;&lt;ul&gt;&lt;li&gt;直接使用 DQN 的参数：\(\omega^- \leftarrow \omega\)&lt;/li&gt;&lt;li&gt;使用 DQN 和 target network 的加权平均：\(\omega^- \leftarrow \tau \cdot \omega + (1-\tau) \cdot \omega^-\)&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;在计算 TD target 时使用 target network: \(y_t = \textcolor{blue}{r_t} + \gamma \cdot&amp;nbsp; \max\limits_{\textcolor{red}{a}} \, Q(\textcolor{green}{s_{t+1}}, \textcolor{red}{a}; \omega_t^-)\)&lt;/li&gt;&lt;/ul&gt;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;dashed=1;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="-720" y="680" width="500" height="140" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-104" value="&lt;b&gt;&lt;font color=&quot;#7f00ff&quot;&gt;最优状态价值函数&lt;/font&gt;&lt;/b&gt; \(V^{\star}(\textcolor{green}{s_t}) = \max\limits_{\pi} V_{\pi}(\textcolor{green}{s_t})\)&lt;br&gt;表示状态 \(\textcolor{green}{s_t}\) 的好坏程度，与策略 \(\pi\) 无关" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="1060" y="460" width="300" height="60" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-105" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0.75;entryY=0;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-108" target="KOUpriuUwOJteqnQQ4VB-118" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="855" y="735" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-106" value="&lt;span&gt;等式变形&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;" parent="KOUpriuUwOJteqnQQ4VB-105" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-107" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;dashed=1;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-108" target="KOUpriuUwOJteqnQQ4VB-139" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1240" y="600" />
              <mxPoint x="2255" y="600" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-108" value="&lt;b&gt;&lt;font color=&quot;#7f00ff&quot;&gt;最优优势函数&lt;/font&gt;&lt;/b&gt; \(A^{\star}(\textcolor{green}{s_t}, \textcolor{red}{a_t}) = Q^{\star}(\textcolor{green}{s_t}, \textcolor{red}{a_t})&amp;nbsp;- V^{\star}(\textcolor{green}{s_t})\)&lt;br&gt;表示动作 \(\textcolor{red}{a_t}\) 相对于 baseline \(V^{\star}(\textcolor{green}{s_t})\) 的优势大小" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;points=[[0,0,0,0,0],[0,0.25,0,0,0],[0,0.5,0,0,0],[0,0.75,0,0,0],[0,1,0,0,0],[0.25,1,0,0,0],[0.33,0,0,0,0],[0.5,0,0,0,0],[0.5,1,0,0,0],[0.66,0,0,0,0],[0.75,1,0,0,0],[1,0,0,0,0],[1,0.25,0,0,0],[1,0.5,0,0,0],[1,0.75,0,0,0],[1,1,0,0,0]];" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="830" y="575" width="370" height="50" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-109" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-108" target="KOUpriuUwOJteqnQQ4VB-111" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1045" y="695" as="sourcePoint" />
            <mxPoint x="1110" y="655" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-110" value="对动作 \(\textcolor{red}{a_t}\) 求最大值" style="edgeLabel;resizable=0;html=1;;align=center;verticalAlign=middle;fontSize=12;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-109" connectable="0" vertex="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-111" value="\(\max\limits_{\textcolor{red}{a}} \,&amp;nbsp;A^{\star}(\textcolor{green}{s}, \textcolor{red}{a}) = \max\limits_{\textcolor{red}{a}} \,&amp;nbsp;Q^{\star}(\textcolor{green}{s}, \textcolor{red}{a})&amp;nbsp;- V^{\star}(\textcolor{green}{s})\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="860" y="690" width="310" height="50" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-112" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-111" target="KOUpriuUwOJteqnQQ4VB-116" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1109.58" y="760" as="sourcePoint" />
            <mxPoint x="1109.58" y="830" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-113" value="使用已知结论 \(V^{\star}(\textcolor{green}{s}) =&amp;nbsp;\max\limits_{\textcolor{red}{a}} \,&amp;nbsp;Q^{\star}(\textcolor{green}{s}, \textcolor{red}{a})\)" style="edgeLabel;resizable=0;html=1;;align=center;verticalAlign=middle;fontSize=12;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-112" connectable="0" vertex="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-114" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0.75;entryY=1;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-116" target="KOUpriuUwOJteqnQQ4VB-118" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="850" y="770" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-115" value="&lt;span&gt;减 \(0\)&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;" parent="KOUpriuUwOJteqnQQ4VB-114" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-116" value="\(\max\limits_{\textcolor{red}{a}} \,&amp;nbsp;A^{\star}(\textcolor{green}{s}, \textcolor{red}{a}) = 0\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="830" y="805" width="370" height="40" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-117" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.25;exitY=1;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-118" target="KOUpriuUwOJteqnQQ4VB-119" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-118" value="\(Q^{\star}(\textcolor{green}{s}, \textcolor{red}{a}) = V^{\star}(\textcolor{green}{s}) +&amp;nbsp;A^{\star}(\textcolor{green}{s}, \textcolor{red}{a}) -\max\limits_{\textcolor{red}{a}} \,&amp;nbsp;A^{\star}(\textcolor{green}{s}, \textcolor{red}{a})\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="480" y="690" width="360" height="50" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-119" value="&lt;b&gt;&lt;font style=&quot;font-size: 24px;&quot;&gt;&amp;nbsp;Dueling Network&lt;/font&gt;&lt;/b&gt;&lt;br&gt;&lt;ul&gt;&lt;li&gt;使用神经网络 \(A(\textcolor{green}{s}, \textcolor{red}{a}; \omega^{A})\) 近似优势函数 \(A^{\star}(\textcolor{green}{s}, \textcolor{red}{a})\) ，其结构与 DQN 相同，输出所有动作的评分&lt;/li&gt;&lt;li&gt;使用神经网络 \(V(\textcolor{green}{s}; \omega^{V})\) 近似状态价值函数 \(V^{\star}(\textcolor{green}{s})\) ，输出一个标量&lt;/li&gt;&lt;li&gt;构建 Dueling Network \(Q(\textcolor{green}{s}, \textcolor{red}{a}; \omega^{A}, \omega^{V}) = V(\textcolor{green}{s}; \omega^{V}) + A(\textcolor{green}{s}, \textcolor{red}{a}; \omega^{A}) - \max\limits_{\textcolor{red}{a}} \, A(\textcolor{green}{s}, \textcolor{red}{a}; \omega^{A})\)&lt;/li&gt;&lt;ul&gt;&lt;li&gt;\(Q\) 输出的每一个分量等于 \(A\) 输出的各个分量加上 \(V\) 的值，再减去 \(A\) 输出的最大值&lt;/li&gt;&lt;li&gt;\(A\) 和 \(V\) 的参数需要同时训练&lt;br&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;Dueling Network 的训练方法与 DQN 完全相同，都是使用 TD 算法。经验回放、target network、Double DQN 这些高级技巧同样适用于 Dueling Network。&lt;br&gt;&lt;br&gt;\(Q(\textcolor{green}{s}, \textcolor{red}{a}; \omega^{A}, \omega^{V}) = V(\textcolor{green}{s}; \omega^{V}) + A(\textcolor{green}{s}, \textcolor{red}{a}; \omega^{A}) - \mathop{\text{mean}}\limits_{\textcolor{red}{a}} \, A(\textcolor{green}{s}, \textcolor{red}{a}; \omega^{A})\) 减去 \(A\) 输出的平均值比减去&amp;nbsp;\(A\) 输出的最大值效果更好" style="text;html=1;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="-140" y="880" width="580" height="240" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-120" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.25;entryY=0;entryDx=0;entryDy=0;fontSize=10;edgeStyle=orthogonalEdgeStyle;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-122" target="KOUpriuUwOJteqnQQ4VB-124" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-121" value="减 \(0\)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;fillColor=none;gradientColor=none;" parent="KOUpriuUwOJteqnQQ4VB-120" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-122" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;对于任意一个与动作 \(\textcolor{red}{A}\) 无关的 baseline 函数 \(\textcolor{magenta}{b}\) 具有下面的性质：&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;\(\begin{split} &amp;amp;\mathbb{E}_{\textcolor{red}{A}}\left[\textcolor{magenta}{b} \cdot \frac{\partial \ln \pi (\textcolor{red}{A} | \textcolor{green}{s}; \theta)}{\partial \theta}\right] \\ =&amp;amp; \textcolor{magenta}{b} \cdot \mathbb{E}_{\textcolor{red}{A}}\left[\frac{\partial \ln \pi (\textcolor{red}{A} | \textcolor{green}{s}; \theta)}{\partial \theta}\right] \\ =&amp;amp; \textcolor{magenta}{b} \cdot \sum\limits_{\textcolor{red}{a}} \pi (\textcolor{red}{a}|\textcolor{green}{s}; \theta) \cdot \frac{\partial \ln \pi (\textcolor{red}{a} | \textcolor{green}{s}; \theta)}{\partial \theta} \\ =&amp;amp; \textcolor{magenta}{b} \cdot \sum\limits_{\textcolor{red}{a}} \pi (\textcolor{red}{a}|\textcolor{green}{s}; \theta) \cdot \left[\frac{1}{\pi (\textcolor{red}{a}|\textcolor{green}{s}; \theta)} \cdot \frac{\partial \pi (\textcolor{red}{a}|\textcolor{green}{s}; \theta)}{\partial \theta}\right] \\ =&amp;amp; \textcolor{magenta}{b} \cdot \sum\limits_{\textcolor{red}{a}} \frac{\partial \pi (\textcolor{red}{a}|\textcolor{green}{s}; \theta)}{\partial \theta} = \textcolor{magenta}{b} \cdot \frac{\partial}{\partial \theta} \sum\limits_{\textcolor{red}{a}} \pi (\textcolor{red}{a}|\textcolor{green}{s}; \theta) \\ =&amp;amp; \textcolor{magenta}{b} \cdot \frac{\partial}{\partial \theta} 1 = 0 \end{split}\)&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=15;strokeColor=default;dashed=1;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="1780" y="60" width="440" height="320" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-123" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-124" target="KOUpriuUwOJteqnQQ4VB-125" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-124" value="\(\frac{\partial V(\textcolor{green}{s}; \theta)}{\partial \theta} = \mathbb{E}_{\textcolor{red}{A}}\left[\frac{\partial \ln \pi (\textcolor{red}{A}&amp;nbsp;| \textcolor{green}{s}; \theta)}{\partial \theta} \cdot&amp;nbsp;Q_{\pi}(\textcolor{green}{s}, \textcolor{red}{A})\right] -\mathbb{E}_{\textcolor{red}{A}}\left[\textcolor{magenta}{b} \cdot \frac{\partial \ln \pi (\textcolor{red}{A} | \textcolor{green}{s}; \theta)}{\partial \theta}\right]\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="2240" y="270" width="460" height="50" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-125" value="\(\frac{\partial V(\textcolor{green}{s}; \theta)}{\partial \theta} = \mathbb{E}_{\textcolor{red}{A}}\left\{\frac{\partial \ln \pi (\textcolor{red}{A}&amp;nbsp;| \textcolor{green}{s}; \theta)}{\partial \theta} \cdot \left[Q_{\pi}(\textcolor{green}{s}, \textcolor{red}{A}) -\textcolor{magenta}{b}\right]\right\}\)&lt;br&gt;使用带基线的策略梯度可以降低方差，加快收敛速度" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="2240" y="360" width="460" height="60" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-126" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-125" target="KOUpriuUwOJteqnQQ4VB-130" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2395" y="755" as="sourcePoint" />
            <mxPoint x="2770" y="590" as="targetPoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-127" value="使用状态价值函数作为 baseline&amp;nbsp;\(\textcolor{magenta}{b} =&amp;nbsp;V_{\pi}(\textcolor{green}{s})\)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;fillColor=none;gradientColor=none;" parent="KOUpriuUwOJteqnQQ4VB-126" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-128" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-130" target="KOUpriuUwOJteqnQQ4VB-132" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-129" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-130" target="KOUpriuUwOJteqnQQ4VB-139" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-130" value="\(\frac{\partial V(\textcolor{green}{s}; \theta)}{\partial \theta} = \mathbb{E}_{\textcolor{red}{A}}\left\{\frac{\partial \ln \pi (\textcolor{red}{A}&amp;nbsp;| \textcolor{green}{s}; \theta)}{\partial \theta} \cdot \left[Q_{\pi}(\textcolor{green}{s}, \textcolor{red}{A}) - V_{\pi}(\textcolor{green}{s})\right]\right\}\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="2240" y="470" width="460" height="50" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-131" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-132" target="KOUpriuUwOJteqnQQ4VB-135" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-132" value="&lt;h1&gt;使用蒙特卡罗方法估计策略梯度&lt;/h1&gt;&lt;p&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;根据策略 \(\pi (\cdot |\textcolor{green}{s}; \theta)\) 随机抽样动作 \(\textcolor{red}{\hat{a}}\)&lt;/li&gt;&lt;li&gt;计算随机策略梯度 \(g(\textcolor{red}{\hat{a}}, \theta) =&amp;nbsp;\frac{\partial \ln \pi (\textcolor{red}{\hat{a}}&amp;nbsp;| \textcolor{green}{s}; \theta)}{\partial \theta} \cdot \left[Q_{\pi}(\textcolor{green}{s}, \textcolor{red}{\hat{a}}) -&amp;nbsp;V_{\pi}(\textcolor{green}{s})\right]\)&lt;/li&gt;&lt;/ol&gt;&lt;br&gt;&lt;p&gt;&lt;/p&gt;" style="text;html=1;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontFamily=更纱黑体 SC;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="2740" y="445" width="400" height="100" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-133" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;resizable=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-135" target="KOUpriuUwOJteqnQQ4VB-137" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-134" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;resizable=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-135" target="KOUpriuUwOJteqnQQ4VB-136" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-135" value="如何计算 \(Q_{\pi}(\textcolor{green}{s}, \textcolor{red}{\hat{a}})\) 以及 \(V_{\pi}(\textcolor{green}{s})\) ？" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="3180" y="475" width="240" height="40" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-136" value="&lt;h1&gt;REINFORCE with baseline&lt;/h1&gt;&lt;p&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;完成一整局游戏 \(\textcolor{green}{s_1},\textcolor{red}{a_1}, \textcolor{blue}{r_1}, \textcolor{green}{s_2},\textcolor{red}{a_2}, \textcolor{blue}{r_2}, \cdots, \textcolor{green}{s_T},\textcolor{red}{a_T}, \textcolor{blue}{r_T}\)&lt;/li&gt;&lt;li&gt;使用 \(u_t = \sum\limits_{k=t}^{T} \gamma^{k-t} \textcolor{blue}{r_k}\) 近似 \(Q_{\pi}(\textcolor{green}{s_t}, \textcolor{red}{a_t})\)&lt;/li&gt;&lt;li&gt;使用神经网络 \(v(\textcolor{green}{s}; \omega)\) 近似 \(V_{\pi}(\textcolor{green}{s})\)&lt;/li&gt;&lt;/ol&gt;记 \(v(\textcolor{green}{s_t}; \omega_t) - u_t = \delta_t\)&lt;br&gt;&lt;br&gt;更新策略网络&amp;nbsp;\(\pi (\textcolor{red}{a}&amp;nbsp;|\textcolor{green}{s}; \theta)\) ：&lt;br&gt;&lt;ol&gt;&lt;li&gt;\(\theta_{t+1} \leftarrow \theta_t + \beta \cdot g(\textcolor{red}{a_t}, \theta_t) = \theta_t - \beta \cdot \delta_t \cdot \frac{\partial \ln \pi (\textcolor{red}{a_t}|\textcolor{green}{s_t};\theta)}{\partial \theta}&amp;nbsp;|_{\theta = \theta_t}\)&lt;br&gt;&lt;/li&gt;&lt;/ol&gt;更新价值网络 \(v(\textcolor{green}{s}; \omega)\) ：&lt;br&gt;&lt;ol&gt;&lt;li&gt;最小化损失函数 \(L_t = \frac{1}{2} \delta_t^2\) 使价值网络拟合价值函数（即：折扣回报）&lt;/li&gt;&lt;li&gt;梯度下降更新网络参数 \(\omega_{t+1} \leftarrow \omega_t - \alpha \cdot \frac{\partial}{\partial \omega} L_t = \omega_t - \alpha \cdot \delta_t \cdot \frac{\partial v(\textcolor{green}{s_t}; \omega)}{\partial \omega} |_{\omega = \omega_t}\)&lt;/li&gt;&lt;/ol&gt;一整局游戏 \(\textcolor{green}{s_1},\textcolor{red}{a_1}, \textcolor{blue}{r_1}, \textcolor{green}{s_2},\textcolor{red}{a_2}, \textcolor{blue}{r_2}, \cdots, \textcolor{green}{s_T},\textcolor{red}{a_T}, \textcolor{blue}{r_T}\)&amp;nbsp;结束后，进行 \(T\) 轮更新，分别使用 \(t = 1, 2, \dots, T\) 更新策略网络和价值网络；然后进行下一局游戏&lt;br&gt;&lt;p&gt;&lt;/p&gt;" style="text;html=1;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="3540" y="320" width="440" height="350" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-137" value="&lt;h1&gt;Advantage Actor-Critic (A2C)&lt;/h1&gt;&lt;p&gt;&lt;/p&gt;使用 \(\textcolor{blue}{r_t} + \gamma \cdot&amp;nbsp;V_{\pi}(\textcolor{green}{s_{t+1}})\) 近似 \(Q_{\pi}(\textcolor{green}{s_t}, \textcolor{red}{a_t})\) ：&lt;br&gt;\(g(\textcolor{red}{a_t}, \theta) \approx \frac{\partial \ln \pi (\textcolor{red}{a_t}&amp;nbsp;| \textcolor{green}{s_t}; \theta)}{\partial \theta} \cdot \left[\textcolor{blue}{r_t} + \gamma \cdot&amp;nbsp;V_{\pi}(\textcolor{green}{s_{t+1}})&amp;nbsp;-&amp;nbsp;V_{\pi}(\textcolor{green}{s})\right]\)&lt;br&gt;使用神经网络 \(v(\textcolor{green}{s}; \omega)\) 近似&amp;nbsp;\(V_{\pi}(\textcolor{green}{s})\) ：&lt;br&gt;\(g(\textcolor{red}{a_t}, \theta) \approx \frac{\partial \ln \pi (\textcolor{red}{a_t}&amp;nbsp;| \textcolor{green}{s_t}; \theta)}{\partial \theta} \cdot \left[\textcolor{blue}{r_t} + \gamma \cdot v(\textcolor{green}{s_{t+1}}; \omega)&amp;nbsp;- v(\textcolor{green}{s_t}; \omega)\right]\)&lt;br&gt;&lt;br&gt;训练流程：&lt;br&gt;&lt;ol&gt;&lt;li&gt;观察得到轨迹 \((\textcolor{green}{s_t},\textcolor{red}{a_t}, \textcolor{blue}{r_t}, \textcolor{green}{s_{t+1}})\)&lt;/li&gt;&lt;li&gt;计算 TD target \(y_t = \textcolor{blue}{r_t} + \gamma \cdot v(\textcolor{green}{s_{t+1}}; \omega_t)\)&lt;/li&gt;&lt;li&gt;计算 TD error \(\delta_t = v(\textcolor{green}{s_t}; \omega_t) - y_t\)&lt;/li&gt;&lt;li&gt;使用梯度上升更新策略网络 \(\theta_{t+1} \leftarrow \theta_t + \beta \cdot g(\textcolor{red}{a_t}, \theta_t) = \theta_t - \beta \cdot \delta_t \cdot \frac{\partial \ln \pi (\textcolor{red}{a_t}|\textcolor{green}{s_t};\theta)}{\partial \theta}&amp;nbsp;|_{\theta = \theta_t}\)&lt;/li&gt;&lt;li&gt;使用梯度下降更新价值网络 \(\omega_{t+1} \leftarrow \omega_t - \alpha \cdot \frac{\partial}{\partial \omega} L_t = \omega_t - \alpha \cdot \delta_t \cdot \frac{\partial v(\textcolor{green}{s_t}; \omega)}{\partial \omega} |_{\omega = \omega_t}\) 其中损失函数 \(L_t = \frac{1}{2} \delta_t^2\)&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;/p&gt;" style="text;html=1;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;movable=1;resizable=1;rotatable=1;deletable=1;editable=1;locked=0;connectable=1;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="3090" y="595" width="420" height="300" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-138" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;dashed=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-139" target="KOUpriuUwOJteqnQQ4VB-137" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="3760" y="880" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-139" value="记 \(Q_{\pi}(\textcolor{green}{s}, \textcolor{red}{a}) - V_{\pi}(\textcolor{green}{s}) = A_{\pi}(\textcolor{green}{s}, \textcolor{red}{a})\) 为&lt;b&gt;&lt;font color=&quot;#7f00ff&quot;&gt;优势函数&lt;/font&gt;&lt;/b&gt; (Advantage Function)&lt;div&gt;优势函数可以指出当前动作 \(\textcolor{red}{a_t}\) 所获得的回报 \(Q_{\pi}(\textcolor{green}{s_t}, \textcolor{red}{a_t})\) 与当前状态 \(\textcolor{green}{s_t}\) 所期待的回报 \(V_{\pi}(\textcolor{green}{s_t})\) 之间的差距&lt;/div&gt;&lt;div&gt;优势函数大于0说明当前动作比预期的效果好；优势函数小于0说明当前动作比预期的效果差&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="2115" y="560" width="710" height="80" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-140" value="\(Q_{\pi}(\textcolor{green}{s_t}, \textcolor{red}{a_t}) = \mathbb{E}_{\textcolor{green}{S_{t+1}}, \textcolor{red}{A_{t+1}}}\left[\textcolor{blue}{R_t} + \gamma \cdot Q_{\pi}(\textcolor{green}{S_{t+1}}, \textcolor{red}{A_{t+1}})&amp;nbsp;\middle| \textcolor{green}{S_t = s_t}, \textcolor{red}{A_t = a_t}\right]\)&lt;br&gt;使用了递归定义：\(U_t = \textcolor{blue}{R_t} + \gamma \cdot U_{t+1}\) 然后等式两边求期望" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="1500" y="400" width="520" height="50" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-141" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=0.9;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;exitPerimeter=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-21" target="KOUpriuUwOJteqnQQ4VB-140" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="835" y="230" as="sourcePoint" />
            <mxPoint x="835" y="315" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-142" value="&lt;span&gt;推导 A2C&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;" parent="KOUpriuUwOJteqnQQ4VB-141" vertex="1" connectable="0">
          <mxGeometry x="-0.5" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-143" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-140" target="KOUpriuUwOJteqnQQ4VB-145" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1860" y="905" as="sourcePoint" />
            <mxPoint x="1830" y="900" as="targetPoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-144" value="\(\textcolor{blue}{R_t}\) 与 \(\textcolor{red}{A_{t+1}}\) 无关，对 \(\textcolor{red}{A_{t+1}}\) 求期望可以放到里面&lt;br&gt;省略 \( | \textcolor{green}{S_t = s_t}, \textcolor{red}{A_t = a_t}&lt;br&gt;\)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;fillColor=none;gradientColor=none;" parent="KOUpriuUwOJteqnQQ4VB-143" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-145" value="\(Q_{\pi}(\textcolor{green}{s_t}, \textcolor{red}{a_t}) = \mathbb{E}_{\textcolor{green}{S_{t+1}}}\left\{\textcolor{blue}{R_t} + \gamma \cdot \mathbb{E}_{\textcolor{red}{A_{t+1}}} \left[&amp;nbsp;Q_{\pi}(\textcolor{green}{S_{t+1}}, \textcolor{red}{A_{t+1}})\right]\right\}\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="1500" y="530" width="520" height="50" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-146" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-145" target="KOUpriuUwOJteqnQQ4VB-149" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2185" y="920" as="sourcePoint" />
            <mxPoint x="1830" y="1035" as="targetPoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-147" value="&lt;span style=&quot;font-size: 10px;&quot;&gt;\(V_{\pi}(\textcolor{green}{S_{t+1}}) = \mathbb{E}_{\textcolor{red}{A_{t+1}}}\left[Q_{\pi}(\textcolor{green}{S_{t+1}}, \textcolor{red}{A_{t+1}})\right]\)&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;fillColor=none;gradientColor=none;" parent="KOUpriuUwOJteqnQQ4VB-146" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-148" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-149" target="KOUpriuUwOJteqnQQ4VB-150" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-149" value="\(Q_{\pi}(\textcolor{green}{s_t}, \textcolor{red}{a_t}) = \mathbb{E}_{\textcolor{green}{S_{t+1}}}\left[\textcolor{blue}{R_t} + \gamma \cdot&amp;nbsp;V_{\pi}(\textcolor{green}{S_{t+1}})\right]\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="1500" y="660" width="520" height="50" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-150" value="\(\begin{split}V_{\pi}(\textcolor{green}{s_t}) = \mathbb{E}_{\textcolor{red}{A_t}}\left[Q_{\pi}(\textcolor{green}{s_t}, \textcolor{red}{A_t})\right] &amp;amp;=\mathbb{E}_{\textcolor{red}{A_t}} \left\{\mathbb{E}_{\textcolor{green}{S_{t+1}}}\left[\textcolor{blue}{R_t} + \gamma \cdot V_{\pi}(\textcolor{green}{S_{t+1}})\right]\right\} \\ &amp;amp;=\mathbb{E}_{\textcolor{red}{A_t},&lt;br&gt;\textcolor{green}{S_{t+1}}}\left[\textcolor{blue}{R_t} + \gamma \cdot V_{\pi}(\textcolor{green}{S_{t+1}})\right]&lt;br&gt;\end{split}\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="1500" y="790" width="520" height="60" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-151" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-149" target="KOUpriuUwOJteqnQQ4VB-153" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2430" y="865" as="sourcePoint" />
            <mxPoint x="2585" y="1070" as="targetPoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-152" value="根据轨迹 \((\textcolor{green}{s_t},\textcolor{red}{a_t}, \textcolor{blue}{r_t}, \textcolor{green}{s_{t+1}})\) 使用蒙特卡洛近似" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;fillColor=none;gradientColor=none;" parent="KOUpriuUwOJteqnQQ4VB-151" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-153" value="\(Q_{\pi}(\textcolor{green}{s_t}, \textcolor{red}{a_t}) \approx \textcolor{blue}{r_t} + \gamma \cdot&amp;nbsp;V_{\pi}(\textcolor{green}{s_{t+1}})\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="2320" y="660" width="260" height="50" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-154" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.75;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-153" target="KOUpriuUwOJteqnQQ4VB-137" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2440" y="900" as="sourcePoint" />
            <mxPoint x="2920" y="900" as="targetPoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-155" value="用于近似 \(Q_{\pi}(\textcolor{green}{s_t}, \textcolor{red}{a_t})\)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;fillColor=none;gradientColor=none;" parent="KOUpriuUwOJteqnQQ4VB-154" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-156" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-150" target="KOUpriuUwOJteqnQQ4VB-158" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2145" y="1169.58" as="sourcePoint" />
            <mxPoint x="2570" y="1170" as="targetPoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-157" value="根据轨迹 \((\textcolor{green}{s_t},\textcolor{red}{a_t}, \textcolor{blue}{r_t}, \textcolor{green}{s_{t+1}})\) 使用蒙特卡洛近似" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;fillColor=none;gradientColor=none;" parent="KOUpriuUwOJteqnQQ4VB-156" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-158" value="\(V_{\pi}(\textcolor{green}{s_t}) \approx \textcolor{blue}{r_t} + \gamma \cdot V_{\pi}(\textcolor{green}{s_{t+1}})\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="2320" y="795" width="260" height="50" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-159" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.75;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-158" target="KOUpriuUwOJteqnQQ4VB-137" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2955" y="1170" as="sourcePoint" />
            <mxPoint x="3875" y="1055" as="targetPoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-160" value="用于 TD 算法更新 \(V_{\pi}(\textcolor{green}{s_t})\)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;fillColor=none;gradientColor=none;" parent="KOUpriuUwOJteqnQQ4VB-159" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-161" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;resizable=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-163" target="KOUpriuUwOJteqnQQ4VB-136" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-162" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;resizable=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-163" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="3510" y="710" as="targetPoint" />
            <Array as="points">
              <mxPoint x="3650" y="710" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-163" value="&lt;h1&gt;Multi-Step TD Target&lt;/h1&gt;&lt;p&gt;&lt;/p&gt;连续观察 \(m\) 条轨迹 \(\left\{(\textcolor{green}{s_{t+i}},\textcolor{red}{a_{t+i}}, \textcolor{blue}{r_{t+i}}, \textcolor{green}{s_{t+1+i}})\right\}_{i=0}^{m-1}\)&lt;br&gt;计算 TD target 时使用 \(m\) 个已知奖励 \(y_t = \sum\limits_{i=0}^{m-1} \gamma^i \cdot \textcolor{blue}{r_{t+i}} + \gamma^m \cdot v(\textcolor{green}{s_{t+m}}; \omega)\)&lt;br&gt;其他计算、更新公式均保持不变&lt;br&gt;&lt;p&gt;&lt;/p&gt;" style="text;html=1;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;dashed=1;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="3540" y="755" width="440" height="140" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-164" value="连续控制" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=20;fontStyle=1;strokeColor=default;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="370" y="-375" width="180" height="50" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-165" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-299" target="KOUpriuUwOJteqnQQ4VB-164" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="145" y="170" as="sourcePoint" />
            <mxPoint x="1025" y="-90" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-166" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-164" target="KOUpriuUwOJteqnQQ4VB-168" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1090" y="-305" as="sourcePoint" />
            <mxPoint x="1455" y="-635" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-167" value="&lt;div style=&quot;font-size: 12px;&quot;&gt;策略函数直接输出动作值，而非概率分布&lt;br style=&quot;font-size: 12px;&quot;&gt;&lt;/div&gt;使用神经网络近似确定策略函数和动作价值函数" style="edgeLabel;resizable=0;html=1;;align=center;verticalAlign=middle;fontSize=12;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-166" connectable="0" vertex="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-168" value="\(\textcolor{red}{a} = \pi (\textcolor{green}{s}; \theta) \qquad q (\textcolor{green}{s}, \textcolor{red}{a}; \omega)\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="-270" y="-370" width="320" height="40" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-169" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;entryX=0.5;entryY=1;entryDx=0;entryDy=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-168" target="KOUpriuUwOJteqnQQ4VB-171" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="735" y="-700" as="sourcePoint" />
            <mxPoint x="2040" y="-635" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-170" value="使用确定策略梯度最大化&lt;div style=&quot;font-size: 12px;&quot;&gt;\(q (\textcolor{green}{s}, \textcolor{red}{a}; \omega) = q (\textcolor{green}{s}, \pi (\textcolor{green}{s}; \theta); \omega)\)&lt;/div&gt;&lt;div style=&quot;font-size: 12px;&quot;&gt;即：最大化动作的评分&lt;/div&gt;" style="edgeLabel;resizable=0;html=1;;align=center;verticalAlign=middle;fontSize=12;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-169" connectable="0" vertex="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-171" value="\(\theta_{t+1} \leftarrow \theta_t + \beta \cdot \frac{\partial&amp;nbsp;q (\textcolor{green}{s}, \pi (\textcolor{green}{s}; \theta); \omega)}{\partial \theta}\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="-270" y="-520" width="320" height="40" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-172" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;entryX=0.5;entryY=1;entryDx=0;entryDy=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-171" target="KOUpriuUwOJteqnQQ4VB-175" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-255" y="-1105" as="sourcePoint" />
            <mxPoint x="2640" y="-640" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-173" value="计算确定策略梯度" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-172" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-174" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;resizable=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-175" target="KOUpriuUwOJteqnQQ4VB-177" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-175" value="确定策略梯度 \(\frac{\partial&amp;nbsp;q (\textcolor{green}{s}, \pi (\textcolor{green}{s}; \theta); \omega)}{\partial \theta} = \frac{\partial \textcolor{red}{a}}{\partial \theta} \cdot \frac{\partial q (\textcolor{green}{s}, \textcolor{red}{a}; \omega)}{\partial \textcolor{red}{a}}\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="-270" y="-620" width="320" height="40" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-176" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;resizable=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-177" target="KOUpriuUwOJteqnQQ4VB-282" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-177" value="&lt;h1&gt;深度确定策略梯度 (Deep Deterministic Policy Gradient, DDPG)&lt;/h1&gt;&lt;p&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;策略网络 \(\pi (\textcolor{green}{s}; \theta)\) ；价值网络&amp;nbsp;&lt;span style=&quot;text-align: center;&quot;&gt;\(q (\textcolor{green}{s}, \textcolor{red}{a}; \omega)\) ；target network&amp;nbsp;&lt;/span&gt;\(\pi (\textcolor{green}{s}; \theta^-)\) ，\(q (\textcolor{green}{s}, \textcolor{red}{a}; \omega^-)\) ；其中 \(\theta^- = \theta\) ，\(\omega^- = \omega\)&lt;/li&gt;&lt;li&gt;根据当前状态 \(\textcolor{green}{s_t}\) 执行动作 \(\textcolor{red}{a_t} = \pi (\textcolor{green}{s_t}; \theta_t)\) ，得到奖励 \(\textcolor{blue}{r_t}\) 和下一个状态 \(\textcolor{green}{s_{t+1}}\)&lt;/li&gt;&lt;li&gt;计算确定策略梯度&amp;nbsp;\(g= \frac{\partial \textcolor{red}{a}}{\partial \theta} \cdot \frac{\partial q (\textcolor{green}{s}, \textcolor{red}{a}; \omega)}{\partial \textcolor{red}{a}} = \frac{\partial&amp;nbsp;\pi (\textcolor{green}{s_t}; \theta)}{\partial \theta} |_{\theta = \theta_t} \cdot \frac{\partial q (\textcolor{green}{s_t}, \textcolor{red}{a}; \omega_t)}{\partial \textcolor{red}{a}} |_{\textcolor{red}{a} = \textcolor{red}{a_t}}\)&lt;/li&gt;&lt;li&gt;使用策略梯度上升更新策略网络 \(\theta_{t+1} \leftarrow \theta_t + \beta \cdot g\)&lt;/li&gt;&lt;li&gt;使用价值网络计算 \(q_t = q (\textcolor{green}{s_t}, \textcolor{red}{a_t}; \omega_t)\)&lt;/li&gt;&lt;li&gt;使用 target network 计算 \(q_{t+1} = q (\textcolor{green}{s_{t+1}}, \textcolor{red}{a&#39;_{t+1}}; \omega_t^-)\) ，其中 \(\textcolor{red}{a&#39;_{t+1}} = \pi (\textcolor{green}{s_{t+1}}; \theta_t^-)\)&lt;/li&gt;&lt;li&gt;计算 TD target \(y_t = \textcolor{blue}{r_t} + \gamma \cdot q_{t+1}\)&lt;/li&gt;&lt;li&gt;计算 TD error \(\delta_t = q_t - y_t\)&lt;/li&gt;&lt;li&gt;使用梯度下降更新价值网络 \(\omega_{t+1} \leftarrow \omega_t - \alpha \cdot \delta_t \cdot \frac{\partial q (\textcolor{green}{s_t}, \textcolor{red}{a_t}; \omega)}{\partial \omega} |_{\omega = \omega_t}\)&lt;/li&gt;&lt;/ol&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;每 \(N_{update}\) 个 step 后更新 target network 的参数：&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;ul&gt;&lt;li&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;\(\theta^- \leftarrow \tau \cdot \theta + (1-\tau) \cdot \theta^-\)&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;\(\omega^- \leftarrow \tau \cdot \omega&amp;nbsp;+ (1-\tau) \cdot \omega^-\)&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;" style="text;html=1;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="-440" y="-960" width="660" height="300" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-178" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-59" target="KOUpriuUwOJteqnQQ4VB-181" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1445" y="-285" as="sourcePoint" />
            <mxPoint x="1670" y="-395" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-179" value="使用置信域 (Trust Region) 最大化 \(J(\theta)\)" style="edgeLabel;resizable=0;html=1;;align=center;verticalAlign=middle;fontSize=12;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-178" connectable="0" vertex="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint y="2" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-180" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-181" target="KOUpriuUwOJteqnQQ4VB-185" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-181" value="\(J(\theta) = \mathbb{E}_{\textcolor{green}{S}}\left\{\mathbb{E}_{\textcolor{red}{A}} \left[\frac{\pi (\textcolor{red}{A}|\textcolor{green}{S}; \theta)}{\pi (\textcolor{red}{A}|\textcolor{green}{S}; \theta_{\text{old}})} \cdot Q_{\pi}(\textcolor{green}{S}, \textcolor{red}{A})\right]\right\} = \mathbb{E}_{\textcolor{green}{S}, \textcolor{red}{A}} \left[\frac{\pi (\textcolor{red}{A}|\textcolor{green}{S}; \theta)}{\pi (\textcolor{red}{A}|\textcolor{green}{S}; \theta_{\text{old}})} \cdot Q_{\pi}(\textcolor{green}{S}, \textcolor{red}{A})\right]\)&lt;div&gt;其中 \(\textcolor{red}{A} \sim \pi (\textcolor{red}{\cdot}|\textcolor{green}{s}; \theta_{\text{old}})\)&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="920" y="-265" width="580" height="60" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-182" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-184" target="KOUpriuUwOJteqnQQ4VB-181" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-183" value="&lt;font style=&quot;font-size: 12px;&quot;&gt;&lt;span style=&quot;font-size: 12px;&quot;&gt;代入 \(J(\theta)\)&lt;/span&gt;&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=更纱黑体 SC;fontSize=12;" parent="KOUpriuUwOJteqnQQ4VB-182" vertex="1" connectable="0">
          <mxGeometry x="0.0974" y="-2" relative="1" as="geometry">
            <mxPoint x="3" y="-2" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-184" value="\(\begin{split}&lt;br&gt;V(\textcolor{green}{s}; \theta) =&amp;amp; \sum\limits_{\textcolor{red}{a}} \pi (\textcolor{red}{a}|\textcolor{green}{s}; \theta) \cdot Q_{\pi}(\textcolor{green}{s}, \textcolor{red}{a}) \\&lt;br&gt;=&amp;amp; \sum\limits_{\textcolor{red}{a}} \pi (\textcolor{red}{a}|\textcolor{green}{s}; \theta_{\text{old}}) \cdot \frac{\pi (\textcolor{red}{a}|\textcolor{green}{s}; \theta)}{\pi (\textcolor{red}{a}|\textcolor{green}{s}; \theta_{\text{old}})} \cdot Q_{\pi}(\textcolor{green}{s}, \textcolor{red}{a}) \\&lt;br&gt;=&amp;amp; \mathbb{E}_{\textcolor{red}{A} \sim \pi (\textcolor{red}{\cdot}|\textcolor{green}{s}; \theta_{\text{old}})} \left[\frac{\pi (\textcolor{red}{A}|\textcolor{green}{s}; \theta)}{\pi (\textcolor{red}{A}|\textcolor{green}{s}; \theta_{\text{old}})} \cdot Q_{\pi}(\textcolor{green}{s}, \textcolor{red}{A})\right]\end{split}\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="500" y="-180" width="400" height="160" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-185" value="&lt;h1&gt;置信域策略优化 (Trust Region Policy Optimization, TRPO)&lt;/h1&gt;&lt;p&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;使用策略 \(\textcolor{red}{A} \sim \pi (\textcolor{red}{\cdot}|\textcolor{green}{s}; \theta_{\text{old}})\) 完成一整局游戏 \(\textcolor{green}{s_1},\textcolor{red}{a_1}, \textcolor{blue}{r_1}, \textcolor{green}{s_2},\textcolor{red}{a_2}, \textcolor{blue}{r_2}, \cdots, \textcolor{green}{s_T},\textcolor{red}{a_T}, \textcolor{blue}{r_T}\)&lt;/li&gt;&lt;li&gt;计算每一步 \(i = 1, 2, \dots, T\) 的折扣回报 \(\textcolor{blue}{u_i} = \sum\limits_{k=i}^{T} \gamma^{k-i} \cdot \textcolor{blue}{r_k}\)&lt;/li&gt;&lt;li&gt;使用均值估计期望近似目标函数 \(J(\theta) \approx L(\theta | \theta_{\text{old}}) = \frac{1}{T} \sum\limits_{i=1}^{T}&amp;nbsp;\frac{\pi (\textcolor{red}{a_i}|\textcolor{green}{s_i}; \theta)}{\pi (\textcolor{red}{a_i}|\textcolor{green}{s_i}; \theta_{\text{old}})} \cdot \textcolor{blue}{u_i}\)&lt;/li&gt;&lt;li&gt;求解带约束条件的优化问题 \(\theta_{\text{new}} \leftarrow \mathop{\text{argmax}}\limits_{\theta} L(\theta | \theta_{\text{old}}); \quad \text{s.t.} \theta \in \mathcal{N}(\theta_{\text{old}}).\) 其中邻域 \(\mathcal{N}(\theta_{\text{old}})\) 可以选择：&lt;/li&gt;&lt;ul&gt;&lt;li&gt;\(||\theta - \theta_{\text{old}}||_2 &amp;lt; \Delta\)&lt;/li&gt;&lt;li&gt;\(\frac{1}{T} \sum\limits_{i=1}^{T} D_{KL}\left[\pi(\cdot|\textcolor{green}{s_i}; \theta_{old}) || \pi(\cdot|\textcolor{green}{s_i}; \theta)\right] &amp;lt; \Delta\)&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;每个 Episode 重复迭代上述 4 步&lt;/li&gt;&lt;/ol&gt;&lt;div&gt;TRPO 限制了策略网络参数 \(\theta\) 的更新范围，使得策略网络不会因为更新幅度过大导致策略网络发散&lt;/div&gt;&lt;p&gt;&lt;/p&gt;" style="text;html=1;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="1720" y="-390" width="540" height="310" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-186" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-164" target="KOUpriuUwOJteqnQQ4VB-188" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1140" y="-915" as="sourcePoint" />
            <mxPoint x="1450" y="-915" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-187" value="使用高斯函数作为策略函数&lt;div style=&quot;font-size: 12px;&quot;&gt;每个动作分量从正态分布中采样得到&lt;/div&gt;" style="edgeLabel;resizable=0;html=1;;align=center;verticalAlign=middle;fontSize=12;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-186" connectable="0" vertex="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-188" value="&lt;div&gt;假设动作空间维度为 \(d\)&lt;/div&gt;&lt;div&gt;\(\mathbf{\textcolor{red}{a}} = \left[\textcolor{red}{a_1}, \textcolor{red}{a_2}, \dots, \textcolor{red}{a_d}\right]\)&lt;/div&gt;\(\textcolor{red}{a_i} \sim N(\mu_i, \sigma_i^2), \; i = 1, 2, \dots, d\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="320" y="-960" width="280" height="60" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-189" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-188" target="KOUpriuUwOJteqnQQ4VB-191" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1720" y="-920" as="sourcePoint" />
            <mxPoint x="1860" y="-925" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-190" value="动作 \(\textcolor{red}{a}\) 相互独立" style="edgeLabel;resizable=0;html=1;;align=center;verticalAlign=middle;fontSize=12;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-189" connectable="0" vertex="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-191" value="\(\pi (\mathbf{\textcolor{red}{a}}|\textcolor{green}{s}) = \prod\limits_{i=1}^{d} \frac{1}{\sqrt{2 \pi} \sigma_i} \cdot \exp\left(-\frac{(\textcolor{red}{a_i} - \mu_i)^2}{2 \sigma_i^2}\right)\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="880" y="-960" width="300" height="60" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-192" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-191" target="KOUpriuUwOJteqnQQ4VB-194" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2170" y="-925.29" as="sourcePoint" />
            <mxPoint x="2315" y="-925.29" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-193" value="为了求策略梯度&lt;div style=&quot;font-size: 12px;&quot;&gt;对策略函数取对数&lt;/div&gt;" style="edgeLabel;resizable=0;html=1;;align=center;verticalAlign=middle;fontSize=12;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-192" connectable="0" vertex="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-194" value="\(\ln \pi (\mathbf{\textcolor{red}{a}}|\textcolor{green}{s}) = \sum\limits_{i=1}^{d} \left[- \ln \sigma_i - \frac{(\textcolor{red}{a_i} - \mu_i)^2}{2 \sigma_i^2}\right] + \text{const}\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="1400" y="-960" width="360" height="60" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-195" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-196" target="KOUpriuUwOJteqnQQ4VB-200" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-196" value="\(\ln \pi (\mathbf{\textcolor{red}{a}}|\textcolor{green}{s}) = \sum\limits_{i=1}^{d} \left[- \frac{\rho_i}{2} - \frac{(\textcolor{red}{a_i} - \mu_i)^2}{2 \cdot \exp (\rho_i)}\right] + \text{const}\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="2030" y="-960" width="340" height="60" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-197" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-194" target="KOUpriuUwOJteqnQQ4VB-196" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2360" y="-1185" as="sourcePoint" />
            <mxPoint x="2710" y="-1155" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-198" value="记 \(\rho_i = \ln \sigma_i^2, \; i = 1, 2, \dots, d\)" style="edgeLabel;resizable=0;html=1;;align=center;verticalAlign=middle;fontSize=12;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-197" connectable="0" vertex="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-199" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-200" target="KOUpriuUwOJteqnQQ4VB-203" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-200" value="定义辅助函数 \(f(\textcolor{green}{s}, \mathbf{\textcolor{red}{a}}) = \sum\limits_{i=1}^{d} \left[- \frac{\rho_i}{2} - \frac{(\textcolor{red}{a_i} - \mu_i)^2}{2 \cdot \exp (\rho_i)}\right]\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="2470" y="-960" width="360" height="60" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-201" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-203" target="KOUpriuUwOJteqnQQ4VB-204" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-202" value="计算策略梯度" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-201" vertex="1" connectable="0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-203" value="\(\ln \pi (\mathbf{\textcolor{red}{a}}|\textcolor{green}{s}) = f(\textcolor{green}{s}, \mathbf{\textcolor{red}{a}})&amp;nbsp;+ \text{const}\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="2930" y="-960" width="240" height="60" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-204" value="&lt;h1&gt;随机高斯策略网络&lt;/h1&gt;&lt;div&gt;&lt;span style=&quot;text-align: center;&quot;&gt;使用神经网络 \(\mu(\textcolor{green}{s}; \theta^\mu)\) 输出给定状态下各个动作分量的均值&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;text-align: center;&quot;&gt;使用神经网络 \(\rho(\textcolor{green}{s}; \theta^\rho)\) 输出给定状态下各个动作分量的方差对数&lt;/span&gt;&lt;span style=&quot;text-align: center;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;text-align: center;&quot;&gt;记两个网络的参数为 \(\theta = (\theta^\mu,&amp;nbsp;\theta^\rho)\) 则&amp;nbsp;\(\ln \pi (\mathbf{\textcolor{red}{a}}|\textcolor{green}{s}; \theta) = f(\textcolor{green}{s},&amp;nbsp;\mathbf{\textcolor{red}{a}}; \theta)&amp;nbsp;+ \text{const}\)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;text-align: center;&quot;&gt;等式两边分别对 \(\theta\) 求偏导，可得策略梯度中对数策略函数对网络参数的偏导等于辅助函数对网络函数的偏导：&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;text-align: center;&quot;&gt;\(\frac{\partial \ln \pi (\mathbf{\textcolor{red}{a}}|\textcolor{green}{s}; \theta)}{\partial \theta} = \frac{\partial f(\textcolor{green}{s}, \mathbf{\textcolor{red}{a}}; \theta)}{\partial \theta}\)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;text-align: center;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;text-align: center;&quot;&gt;随机策略梯度 \(g(\mathbf{\textcolor{red}{a}}, \theta) = \frac{\partial \ln \pi (\mathbf{\textcolor{red}{a}} | \textcolor{green}{s}; \theta)}{\partial \theta} \cdot Q_{\pi}(\textcolor{green}{s}, \mathbf{\textcolor{red}{a}}) = \frac{\partial f(\textcolor{green}{s}, \mathbf{\textcolor{red}{a}}; \theta)}{\partial \theta} \cdot Q_{\pi}(\textcolor{green}{s}, \mathbf{\textcolor{red}{a}})\)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;ul&gt;&lt;li&gt;&lt;span style=&quot;text-align: center;&quot;&gt;使用 REINFORCE 更新参数 \(\theta\)&lt;/span&gt;&lt;/li&gt;&lt;li style=&quot;&quot;&gt;使用 Actor-Critic 更新参数 \(\theta\)&lt;/li&gt;&lt;/ul&gt;带基线的策略梯度 \(g(\mathbf{\textcolor{red}{a}}, \theta) = \frac{\partial \ln \pi (\mathbf{\textcolor{red}{a}} | \textcolor{green}{s}; \theta)}{\partial \theta} \cdot Q_{\pi}(\textcolor{green}{s}, \mathbf{\textcolor{red}{a}}) = \frac{\partial f(\textcolor{green}{s}, \mathbf{\textcolor{red}{a}}; \theta)}{\partial \theta} \cdot \left[Q_{\pi}(\textcolor{green}{s}, \mathbf{\textcolor{red}{a}}) - V_{\pi}(\textcolor{green}{s})\right]\)&lt;/div&gt;&lt;div&gt;&lt;ul&gt;&lt;li&gt;使用 REINFORCE with baseline 更新参数 \(\theta\)&lt;/li&gt;&lt;li&gt;使用 A2C 更新参数 \(\theta\)&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;" style="text;html=1;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="2800" y="-800" width="500" height="300" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-205" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-206" target="KOUpriuUwOJteqnQQ4VB-185" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-206" value="实际使用优势函数 \(J(\theta) = \mathbb{E}_{\textcolor{green}{S}, \textcolor{red}{A}} \left[\frac{\pi (\textcolor{red}{A}|\textcolor{green}{S}; \theta)}{\pi (\textcolor{red}{A}|\textcolor{green}{S}; \theta_{\text{old}})} \cdot A_{\pi}(\textcolor{green}{S}, \textcolor{red}{A})\right]\)&lt;div&gt;当 \(A_\pi &amp;gt; 0\) 时，\(\theta\) 的更新使 \(\pi (\textcolor{red}{a_t}|\textcolor{green}{s_t}; \theta)\) 的值增大，会让智能体在 \(\textcolor{green}{s_t}\) 状态下更倾向于选择动作 \(\textcolor{red}{a_t}\)&lt;/div&gt;&lt;div&gt;当 \(A_\pi &amp;lt; 0\) 时，\(\theta\) 的更新使 \(\pi (\textcolor{red}{a_t}|\textcolor{green}{s_t}; \theta)\) 的值减小，会让智能体在 \(\textcolor{green}{s_t}\) 状态下更不可能选择动作 \(\textcolor{red}{a_t}\)&lt;/div&gt;&lt;div&gt;（优势函数的含义参见紫色加粗定义处）&lt;/div&gt;&lt;div&gt;（ \(A_\pi\) 中的价值函数 \(V_\pi\) 使用神经网络近似，训练方法与带基线的策略梯度相同）&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=default;dashed=1;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="2300" y="-325" width="470" height="180" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-207" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-181" target="KOUpriuUwOJteqnQQ4VB-210" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1380" y="-525" as="sourcePoint" />
            <mxPoint x="1405" y="-605" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-208" value="令 \(r(\theta) =&amp;nbsp;\frac{\pi (\textcolor{red}{A}|\textcolor{green}{S}; \theta)}{\pi (\textcolor{red}{A}|\textcolor{green}{S}; \theta_{\text{old}})}\), \(\theta\) 离 \(\theta_{\text{old}}\) 越远，\(r(\theta)\) 越远离\(1\), \(r(\theta_{\text{old}}) = 1\)&lt;div&gt;将动作价值函数 \(Q_{\pi}(\textcolor{green}{S}, \textcolor{red}{A})\) 替换为优势函数 \(A_{\pi}(\textcolor{green}{S}, \textcolor{red}{A})\)&lt;/div&gt;" style="edgeLabel;resizable=0;html=1;;align=center;verticalAlign=middle;fontSize=12;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-207" connectable="0" vertex="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-209" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;resizable=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-210" target="KOUpriuUwOJteqnQQ4VB-211" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-210" value="PPO 最大化目标函数 \(J(\theta) = \mathbb{E}_{\textcolor{green}{S}, \textcolor{red}{A}} \left\{\min \left[r(\theta) \cdot A_{\pi}(\textcolor{green}{S}, \textcolor{red}{A}), \text{clip}(r(\theta), 1-\epsilon, 1+\epsilon) \cdot A_{\pi}(\textcolor{green}{S}, \textcolor{red}{A})\right]\right\}\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="920" y="-630" width="580" height="60" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-211" value="&lt;h1&gt;近端策略优化 (Proximal Policy Optimization, PPO)&lt;/h1&gt;&lt;p&gt;&lt;/p&gt;目标函数中取最小值的第一项是 TRPO 中的目标函数&lt;div&gt;目标函数中取最小值的第二项是 TRPO 目标函数的 clipped version ( \(\epsilon\) 通常取 0.2)&lt;/div&gt;&lt;div&gt;\(\text{clip}(x, a, b) = \begin{cases}&lt;br&gt;a, &amp;amp; \text{if } x &amp;lt; a;\\&lt;br&gt;x, &amp;amp; \text{if } a \leq x \leq b;\\&lt;br&gt;b, &amp;amp; \text{if } x &amp;gt; b.\end{cases}\)&lt;br&gt;&lt;br&gt;训练流程：&lt;/div&gt;&lt;div&gt;&lt;ol&gt;&lt;li&gt;使用神经网络&amp;nbsp;\(v(\textcolor{green}{s}; \omega)\)&amp;nbsp;近似状态价值函数 \(V_{\pi}(\textcolor{green}{s})\)&lt;/li&gt;&lt;li&gt;使用策略 \(\textcolor{red}{A} \sim \pi (\textcolor{red}{\cdot}|\textcolor{green}{s}; \theta_{\text{old}})\) 完成一整局游戏 \(\textcolor{green}{s_1},\textcolor{red}{a_1}, \textcolor{blue}{r_1}, \textcolor{green}{s_2},\textcolor{red}{a_2}, \textcolor{blue}{r_2}, \cdots, \textcolor{green}{s_T},\textcolor{red}{a_T}, \textcolor{blue}{r_T}\)&lt;/li&gt;&lt;li&gt;使用 REINFORCE with baseline 或 A2C 的方法估计每一步的优势函数值 \(\hat{A}_i\) ，其中 \(i=1, 2, \dots, T\)&lt;/li&gt;&lt;li&gt;使用均值估计期望近似目标函数 \(J(\theta) \approx L(\theta) = \frac{1}{T} \sum\limits_{i=1}^{T} \min \left[r(\theta) \cdot \hat{A}_i, \text{clip}(r(\theta), 1-\epsilon, 1+\epsilon) \cdot \hat{A}_i\right]\)&lt;/li&gt;&lt;li&gt;求解无约束优化问题 \(\theta_{\text{new}} \leftarrow \mathop{\text{argmax}}\limits_{\theta} L(\theta)\)&lt;/li&gt;&lt;li&gt;每个 Episode 重复迭代 2-5 步&lt;/li&gt;&lt;/ol&gt;&lt;div&gt;PPO 无需计算&amp;nbsp;&lt;span style=&quot;text-align: center;&quot;&gt;KL 散度 \(D_{KL}\) ，因此与 TRPO 相比减少了计算量；&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;同时 PPO 目标函数中的 clip 函数同样限制了策略网络参数 \(\theta\) 的更新幅度&lt;/div&gt;&lt;p&gt;&lt;/p&gt;&lt;/div&gt;" style="text;html=1;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="1720" y="-800" width="540" height="400" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-212" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-210" target="KOUpriuUwOJteqnQQ4VB-214" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1055" y="-1355" as="sourcePoint" />
            <mxPoint x="1405" y="-825" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-213" value="算法解读" style="edgeLabel;resizable=0;html=1;;align=center;verticalAlign=middle;fontSize=12;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-212" connectable="0" vertex="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-214" value="使用 REINFORCE with baseline 或 A2C 的方法估计完优势函数 \(A_{\pi}(\textcolor{green}{s}, \textcolor{red}{a}) \approx A\) 后&lt;div&gt;目标函数 \(J\) 的值只与 \(r\) 有关 \(J = \min \left[r \cdot A, \text{clip}(r, 1-\epsilon, 1+\epsilon) \cdot A\right]\)&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;fillColor=none;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="920" y="-880" width="580" height="60" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-215" value="" style="swimlane;startSize=0;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="2300" y="-800" width="470" height="465" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-216" value="" style="group" parent="KOUpriuUwOJteqnQQ4VB-215" vertex="1" connectable="0">
          <mxGeometry x="5" y="5" width="455" height="225" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-217" value="" style="endArrow=classic;html=1;rounded=0;" parent="KOUpriuUwOJteqnQQ4VB-216" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="55" y="165" as="sourcePoint" />
            <mxPoint x="55" y="5" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-218" value="" style="endArrow=classic;html=1;rounded=0;" parent="KOUpriuUwOJteqnQQ4VB-216" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="55" y="165" as="sourcePoint" />
            <mxPoint x="235" y="165" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-219" value="\(r\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-216" vertex="1">
          <mxGeometry x="235" y="155" width="15" height="20" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-220" value="" style="endArrow=none;html=1;rounded=0;" parent="KOUpriuUwOJteqnQQ4VB-216" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="55" y="165" as="sourcePoint" />
            <mxPoint x="205" y="15" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-221" value="\(y_1=r \cdot A\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-216" vertex="1">
          <mxGeometry x="175" width="60" height="15" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-222" value="\(A&amp;gt;0\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;" parent="KOUpriuUwOJteqnQQ4VB-216" vertex="1">
          <mxGeometry x="302.5" y="75" width="50" height="20" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-223" value="" style="endArrow=none;html=1;rounded=0;" parent="KOUpriuUwOJteqnQQ4VB-216" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="140" y="170" as="sourcePoint" />
            <mxPoint x="140" y="160" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-224" value="" style="endArrow=none;html=1;rounded=0;" parent="KOUpriuUwOJteqnQQ4VB-216" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="94.96000000000004" y="170" as="sourcePoint" />
            <mxPoint x="94.96000000000004" y="160" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-225" value="" style="endArrow=none;html=1;rounded=0;" parent="KOUpriuUwOJteqnQQ4VB-216" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="184.95000000000005" y="170" as="sourcePoint" />
            <mxPoint x="184.95000000000005" y="160" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-226" value="\(1\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-216" vertex="1">
          <mxGeometry x="135" y="170" width="10" height="15" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-227" value="\(1-\epsilon\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-216" vertex="1">
          <mxGeometry x="90" y="170" width="10" height="15" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-228" value="\(1+\epsilon\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-216" vertex="1">
          <mxGeometry x="180" y="170" width="10" height="15" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-229" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;rounded=0;" parent="KOUpriuUwOJteqnQQ4VB-216" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="94.96000000000004" y="165" as="sourcePoint" />
            <mxPoint x="95" y="125" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-230" value="" style="endArrow=none;html=1;rounded=0;dashed=1;strokeColor=#007FFF;strokeWidth=2;" parent="KOUpriuUwOJteqnQQ4VB-216" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="95" y="125" as="sourcePoint" />
            <mxPoint x="55" y="125" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-231" value="\((1-\epsilon)A\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-216" vertex="1">
          <mxGeometry y="115" width="50" height="20" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-232" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;rounded=0;" parent="KOUpriuUwOJteqnQQ4VB-216" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="184.95000000000005" y="165" as="sourcePoint" />
            <mxPoint x="185" y="35" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-233" value="" style="endArrow=none;html=1;rounded=0;dashed=1;strokeColor=#007FFF;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;strokeWidth=2;" parent="KOUpriuUwOJteqnQQ4VB-216" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="235" y="35" as="sourcePoint" />
            <mxPoint x="185" y="34.960000000000036" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-234" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;rounded=0;" parent="KOUpriuUwOJteqnQQ4VB-216" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="55" y="35" as="sourcePoint" />
            <mxPoint x="185" y="35" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-235" value="\((1+\epsilon)A\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-216" vertex="1">
          <mxGeometry y="25" width="50" height="20" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-236" value="" style="endArrow=none;html=1;rounded=0;dashed=1;strokeColor=#007FFF;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;strokeWidth=2;" parent="KOUpriuUwOJteqnQQ4VB-216" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="95" y="125" as="sourcePoint" />
            <mxPoint x="185" y="35" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-237" value="\(y_2 = \text{clip}(r, 1-\epsilon, 1+\epsilon) \cdot A\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontColor=#007FFF;" parent="KOUpriuUwOJteqnQQ4VB-216" vertex="1">
          <mxGeometry x="255" y="15" width="145" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-238" value="为了增大 \(J\) ，应当更新 \(\theta\) 的值使 \(r\) 增大；&lt;div&gt;如果&amp;nbsp;&lt;span style=&quot;background-color: initial;&quot;&gt;\(r\) 变得比 \(1+\epsilon\) 大，那么\(J\) 的梯度变为0；&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;\(r\)无法继续更新，从而限制了 \(\theta\) 更新的幅度。&lt;/span&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;" parent="KOUpriuUwOJteqnQQ4VB-216" vertex="1">
          <mxGeometry x="200" y="95" width="255" height="50" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-239" value="\(r(\theta_{\text{old}})\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-216" vertex="1">
          <mxGeometry x="112.5" y="210" width="55" height="15" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-240" value="" style="endArrow=classic;html=1;rounded=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="KOUpriuUwOJteqnQQ4VB-216" source="KOUpriuUwOJteqnQQ4VB-226" target="KOUpriuUwOJteqnQQ4VB-239" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="150" y="230" as="sourcePoint" />
            <mxPoint x="200" y="180" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-241" value="" style="endArrow=none;html=1;rounded=0;fontColor=#000000;strokeColor=#FF0000;strokeWidth=1;" parent="KOUpriuUwOJteqnQQ4VB-216" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="58" y="165" as="sourcePoint" />
            <mxPoint x="235" y="37" as="targetPoint" />
            <Array as="points">
              <mxPoint x="186" y="37" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-242" value="\(J=\min (y_1, y_2)\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontColor=#FF0000;" parent="KOUpriuUwOJteqnQQ4VB-216" vertex="1">
          <mxGeometry x="190" y="35" width="105" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-243" value="" style="endArrow=classic;html=1;rounded=0;" parent="KOUpriuUwOJteqnQQ4VB-216" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="140" y="155" as="sourcePoint" />
            <mxPoint x="180" y="155" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-244" value="\(r(\theta_{\text{new}})\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-216" vertex="1">
          <mxGeometry x="135" y="135" width="45" height="15" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-245" value="" style="group;strokeColor=none;strokeWidth=2;" parent="KOUpriuUwOJteqnQQ4VB-215" vertex="1" connectable="0">
          <mxGeometry x="5" y="240" width="460" height="220" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-246" value="" style="endArrow=classic;html=1;rounded=0;" parent="KOUpriuUwOJteqnQQ4VB-245" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="55" y="220" as="sourcePoint" />
            <mxPoint x="55" y="40" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-247" value="" style="endArrow=classic;html=1;rounded=0;" parent="KOUpriuUwOJteqnQQ4VB-245" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="55" y="60" as="sourcePoint" />
            <mxPoint x="235" y="60" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-248" value="\(r\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-245" vertex="1">
          <mxGeometry x="235" y="50" width="15" height="20" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-249" value="" style="endArrow=none;html=1;rounded=0;" parent="KOUpriuUwOJteqnQQ4VB-245" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="55" y="60" as="sourcePoint" />
            <mxPoint x="210" y="215" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-250" value="\(y_1=r \cdot A\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-245" vertex="1">
          <mxGeometry x="227.5" y="205" width="30" height="15" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-251" value="\(A&amp;lt;0\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;" parent="KOUpriuUwOJteqnQQ4VB-245" vertex="1">
          <mxGeometry x="302.5" y="90" width="50" height="20" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-252" value="" style="endArrow=none;html=1;rounded=0;" parent="KOUpriuUwOJteqnQQ4VB-245" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="140" y="65" as="sourcePoint" />
            <mxPoint x="140" y="55" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-253" value="" style="endArrow=none;html=1;rounded=0;" parent="KOUpriuUwOJteqnQQ4VB-245" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="94.96000000000004" y="65" as="sourcePoint" />
            <mxPoint x="94.96000000000004" y="55" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-254" value="" style="endArrow=none;html=1;rounded=0;" parent="KOUpriuUwOJteqnQQ4VB-245" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="184.95000000000005" y="65" as="sourcePoint" />
            <mxPoint x="184.95000000000005" y="55" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-255" value="\(1\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-245" vertex="1">
          <mxGeometry x="135" y="40" width="10" height="15" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-256" value="\(1-\epsilon\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-245" vertex="1">
          <mxGeometry x="90" y="40" width="10" height="15" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-257" value="\(1+\epsilon\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-245" vertex="1">
          <mxGeometry x="180" y="40" width="10" height="15" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-258" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;rounded=0;" parent="KOUpriuUwOJteqnQQ4VB-245" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="95" y="60" as="sourcePoint" />
            <mxPoint x="95" y="100" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-259" value="" style="endArrow=none;html=1;rounded=0;dashed=1;strokeColor=#007FFF;strokeWidth=2;" parent="KOUpriuUwOJteqnQQ4VB-245" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="95" y="100" as="sourcePoint" />
            <mxPoint x="55" y="100" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-260" value="\((1-\epsilon)A\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-245" vertex="1">
          <mxGeometry y="90" width="50" height="20" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-261" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;rounded=0;" parent="KOUpriuUwOJteqnQQ4VB-245" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="185" y="190" as="sourcePoint" />
            <mxPoint x="184.97000000000003" y="60" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-262" value="" style="endArrow=none;html=1;rounded=0;dashed=1;strokeColor=#007FFF;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;strokeWidth=2;" parent="KOUpriuUwOJteqnQQ4VB-245" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="240" y="190" as="sourcePoint" />
            <mxPoint x="185" y="190" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-263" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;rounded=0;" parent="KOUpriuUwOJteqnQQ4VB-245" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="55" y="190" as="sourcePoint" />
            <mxPoint x="185" y="190" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-264" value="\((1+\epsilon)A\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-245" vertex="1">
          <mxGeometry y="180" width="50" height="20" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-265" value="" style="endArrow=none;html=1;rounded=0;dashed=1;strokeColor=#007FFF;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;strokeWidth=2;" parent="KOUpriuUwOJteqnQQ4VB-245" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="95" y="100" as="sourcePoint" />
            <mxPoint x="185" y="190" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-266" value="\(y_2=\text{clip}(r, 1-\epsilon, 1+\epsilon) \cdot A\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontColor=#007FFF;" parent="KOUpriuUwOJteqnQQ4VB-245" vertex="1">
          <mxGeometry x="257.5" y="165" width="145" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-267" value="为了增大 \(J\) ，应当更新 \(\theta\) 的值使 \(r\) 减小；&lt;div&gt;如果&amp;nbsp;&lt;span style=&quot;background-color: initial;&quot;&gt;\(r\) 变得比 \(1-\epsilon\) 小，那么\(J\) 的梯度变为 \(0\)；&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;\(r\)无法继续更新，从而限制了 \(\theta\) 更新的幅度&lt;/span&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fillColor=none;strokeColor=default;" parent="KOUpriuUwOJteqnQQ4VB-245" vertex="1">
          <mxGeometry x="200" y="110" width="260" height="50" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-268" value="\(r(\theta_{\text{old}})\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-245" vertex="1">
          <mxGeometry x="112.5" width="55" height="15" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-269" value="" style="endArrow=classic;html=1;rounded=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;" parent="KOUpriuUwOJteqnQQ4VB-245" source="KOUpriuUwOJteqnQQ4VB-255" target="KOUpriuUwOJteqnQQ4VB-268" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="140" y="65" as="sourcePoint" />
            <mxPoint x="140" y="40" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-270" value="" style="endArrow=none;html=1;rounded=0;fontColor=#000000;strokeColor=#FF0000;strokeWidth=1;" parent="KOUpriuUwOJteqnQQ4VB-245" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="56" y="102" as="sourcePoint" />
            <mxPoint x="208" y="216" as="targetPoint" />
            <Array as="points">
              <mxPoint x="94" y="102" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-271" value="\(J=\min (y_1, y_2)\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontColor=#FF0000;" parent="KOUpriuUwOJteqnQQ4VB-245" vertex="1">
          <mxGeometry x="95" y="160" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-272" value="" style="endArrow=classic;html=1;rounded=0;" parent="KOUpriuUwOJteqnQQ4VB-245" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="140" y="70" as="sourcePoint" />
            <mxPoint x="100" y="70" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-273" value="\(r(\theta_{\text{new}})\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-245" vertex="1">
          <mxGeometry x="100" y="75" width="45" height="15" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-274" value="" style="endArrow=none;dashed=1;html=1;rounded=0;fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;resizable=0;" parent="KOUpriuUwOJteqnQQ4VB-215" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="5" y="235" as="sourcePoint" />
            <mxPoint x="465" y="235" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-275" value="" style="endArrow=classic;html=1;rounded=0;fontSize=10;fontFamily=更纱黑体 SC;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-214" target="KOUpriuUwOJteqnQQ4VB-278" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1410" y="-865" as="sourcePoint" />
            <mxPoint x="1400" y="-880" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-276" value="等价形式" style="edgeLabel;resizable=0;html=1;;align=center;verticalAlign=middle;fontSize=12;fontFamily=更纱黑体 SC;" parent="KOUpriuUwOJteqnQQ4VB-275" connectable="0" vertex="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-277" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-278" target="KOUpriuUwOJteqnQQ4VB-215" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-278" value="\(J = \min \left[r \cdot A, h(\epsilon, A)\right], \quad \text{where} \, h(\epsilon, A) = \begin{cases}&lt;br&gt;&amp;nbsp; &amp;nbsp; (1 + \epsilon) \cdot A, &amp;amp; A \geqslant 0; \\&lt;br&gt;&amp;nbsp; &amp;nbsp; (1 - \epsilon) \cdot A, &amp;amp; A &amp;lt; 0.\end{cases}\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="1720" y="-880" width="540" height="60" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-279" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;resizable=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-282" target="KOUpriuUwOJteqnQQ4VB-284" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="-740" y="-810" />
              <mxPoint x="-740" y="-575" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-280" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;resizable=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-282" target="KOUpriuUwOJteqnQQ4VB-286" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="-740" y="-810" />
              <mxPoint x="-740" y="-440" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-281" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;resizable=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-282" target="KOUpriuUwOJteqnQQ4VB-288" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="-740" y="-810" />
              <mxPoint x="-740" y="-290" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-282" value="解决 DDPG 的高估问题" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="-680" y="-830" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-283" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;resizable=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-284" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-300" y="-180" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-284" value="&lt;h1&gt;&lt;span style=&quot;box-sizing: border-box;&quot;&gt;Clipped Double-Q Learning&lt;/span&gt;&lt;/h1&gt;&lt;div&gt;&lt;ul&gt;&lt;li&gt;&lt;span style=&quot;box-sizing: border-box;&quot;&gt;使用两个价值网络&amp;nbsp;\(q (\textcolor{green}{s}, \textcolor{red}{a}; \omega_1)\) 和&amp;nbsp;\(q (\textcolor{green}{s}, \textcolor{red}{a}; \omega_2)\)&lt;/span&gt;&lt;/li&gt;&lt;li&gt;对应两个 target network \(q (\textcolor{green}{s}, \textcolor{red}{a}; \omega_1^-)\) 和&amp;nbsp;\(q (\textcolor{green}{s}, \textcolor{red}{a}; \omega_2^-)\)&lt;/li&gt;&lt;li&gt;在计算 TD target 时，\(q_{t+1}\) 的值选取两个 target network 输出中较小的值 \(q_{t+1} = \min\limits_{i=1,2} q(\textcolor{green}{s_{t+1}},\textcolor{red}{a&#39;_{t+1}};\omega_i^-)\)&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;" style="text;html=1;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;dashed=1;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="-720" y="-640" width="400" height="130" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-285" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;resizable=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-286" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-300" y="-180" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-286" value="&lt;h1&gt;&lt;span style=&quot;box-sizing: border-box;&quot;&gt;&quot;Delayed&quot; Policy Updates&lt;/span&gt;&lt;br&gt;&lt;/h1&gt;&lt;div&gt;&lt;ul&gt;&lt;li&gt;策略网络的更新频率比价值网络低&lt;/li&gt;&lt;li&gt;每更新两次价值网络之后，更新一次策略网络&lt;/li&gt;&lt;li&gt;每更新两次价值网络的 target network 之后，更新一次策略网络的 target network&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;" style="text;html=1;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;dashed=1;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="-720" y="-500" width="400" height="120" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-287" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;resizable=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-288" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-300" y="-180" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-288" value="&lt;h1&gt;&lt;span style=&quot;box-sizing: border-box;&quot;&gt;Target Policy Smoothing&lt;/span&gt;&lt;br&gt;&lt;/h1&gt;&lt;div&gt;&lt;ul&gt;&lt;li&gt;在计算 \(q_{t+1}\) 时所用到的 target action \(\textcolor{red}{a&#39;_{t+1}}\) 上添加截断的高斯噪声 \(\textcolor{red}{a&#39;_{t+1}} =&amp;nbsp;\pi (\textcolor{green}{s_{t+1}}; \theta_t^-) + \text{clip}(\epsilon, -c, c)\) ，其中 \(\epsilon \sim N(0, \sigma^2)\)&lt;/li&gt;&lt;li&gt;通过给 \(\textcolor{red}{a&#39;_{t+1}}\) 添加噪声，可以避免由价值网络估计误差导致的过度自信的问题&lt;/li&gt;&lt;li&gt;如果价值网络在更新过程中对某个动作的评分过高，那么策略网络会误以为该动作最好。这时给策略网络输出的动作添加噪声可以避免选中该动作，从而规避该问题。&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;" style="text;html=1;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;dashed=1;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="-720" y="-370" width="400" height="160" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-289" value="&lt;h1&gt;孪生延迟深度确定性策略梯度&amp;nbsp;(Twin Delayed DDPG, TD3)&lt;/h1&gt;&lt;p&gt;&lt;/p&gt;初始化策略网络 \(\pi (\textcolor{green}{s}; \theta)\) ；两个价值网络&amp;nbsp;&lt;span style=&quot;text-align: center;&quot;&gt;\(q (\textcolor{green}{s}, \textcolor{red}{a}; \omega_1)\) ，&lt;/span&gt;&lt;span style=&quot;text-align: center;&quot;&gt;\(q (\textcolor{green}{s}, \textcolor{red}{a}; \omega_2)\)&lt;/span&gt;&lt;div&gt;&lt;span style=&quot;text-align: center;&quot;&gt;三个网络对应的 target network&amp;nbsp;&lt;/span&gt;\(\pi (\textcolor{green}{s}; \theta^-)\) ，\(q (\textcolor{green}{s}, \textcolor{red}{a}; \omega_1^-)\) ，\(q (\textcolor{green}{s}, \textcolor{red}{a}; \omega_2^-)\)；其中 \(\theta^- = \theta\) ，\(\omega_1^- = \omega_1\) ，\(\omega_2^- = \omega_2\)&lt;/div&gt;&lt;div&gt;设置策略网络、所有 target network 的更新频率为&lt;span style=&quot;background-color: initial;&quot;&gt;\(N_{update}\)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;ol&gt;&lt;li&gt;根据当前状态 \(\textcolor{green}{s_t}\) 执行动作 \(\textcolor{red}{a_t} = \pi (\textcolor{green}{s_t}; \theta_t)\) ，得到奖励 \(\textcolor{blue}{r_t}\) 和下一个状态 \(\textcolor{green}{s_{t+1}}\)&lt;/li&gt;&lt;li&gt;选择 target action&amp;nbsp;\(\textcolor{red}{a&#39;_{t+1}} =&amp;nbsp;\pi (\textcolor{green}{s_{t+1}}; \theta_t^-) + \text{clip}(\epsilon, -c, c)\) ，其中 \(\epsilon \sim N(0, \sigma^2)\)&lt;/li&gt;&lt;li&gt;使用 target network 计算&amp;nbsp;\(q_{t+1} = \min\limits_{i=1,2} q(\textcolor{green}{s_{t+1}},\textcolor{red}{a&#39;_{t+1}};\omega_{i,t}^-)\)&lt;br&gt;&lt;/li&gt;&lt;li&gt;计算 TD target \(y_t = \textcolor{blue}{r_t} + \gamma \cdot q_{t+1}\)&lt;/li&gt;&lt;li&gt;分别计算两个价值网络的 TD error \(\delta_{i,t} = q(\textcolor{green}{s_t}, \textcolor{red}{a_t}; \omega_{i,t}) - y_t\) ，其中 \(i=1,2\)&lt;/li&gt;&lt;li&gt;使用梯度下降更新两个价值网络 \(\omega_{i,t+1} \leftarrow \omega_{i,t} - \alpha \cdot \delta_{i,t} \cdot \frac{\partial q (\textcolor{green}{s_t}, \textcolor{red}{a_t}; \omega)}{\partial \omega} |_{\omega = \omega_{i,t}}\) ，其中 \(i=1,2\)&lt;/li&gt;&lt;li&gt;如果当前 step 计数 % \(N_{update}\) == 0&lt;/li&gt;&lt;ol&gt;&lt;li&gt;使用第一个价值网络计算确定策略梯度&amp;nbsp;\(g= \frac{\partial \textcolor{red}{a}}{\partial \theta} \cdot \frac{\partial q (\textcolor{green}{s}, \textcolor{red}{a}; \omega)}{\partial \textcolor{red}{a}} = \frac{\partial&amp;nbsp;\pi (\textcolor{green}{s_t}; \theta)}{\partial \theta} |_{\theta = \theta_t} \cdot \frac{\partial q (\textcolor{green}{s_t}, \textcolor{red}{a}; \omega_{1,t})}{\partial \textcolor{red}{a}} |_{\textcolor{red}{a} = \textcolor{red}{a_t}}\)&lt;/li&gt;&lt;li&gt;使用策略梯度上升更新策略网络 \(\theta_{t+1} \leftarrow \theta_t + \beta \cdot g\)&lt;/li&gt;&lt;li&gt;更新所有 target network 参数&lt;/li&gt;&lt;/ol&gt;&lt;ul&gt;&lt;ul&gt;&lt;li&gt;\(\theta^- \leftarrow \tau \cdot \theta + (1-\tau) \cdot \theta^-\)&lt;/li&gt;&lt;li&gt;\(\omega_i^- \leftarrow \tau \cdot \omega_i + (1-\tau) \cdot \omega_i^-\) ，其中 \(i=1,2\)&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;/ol&gt;&lt;div&gt;实现算法时应当先判断、更新策略网络，再更新价值网络。因为更新策略网络需要用到价值网络更新前的参数 \(\omega_{1,t}\)&lt;/div&gt;&lt;/div&gt;" style="text;html=1;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;movable=1;resizable=1;rotatable=1;deletable=1;editable=1;locked=0;connectable=1;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="-720" y="-180" width="640" height="350" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-290" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-291" target="KOUpriuUwOJteqnQQ4VB-164" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-291" value="注：对于有范围限制的动作 \(\textcolor{red}{a} \in \left[a_{Low}, a_{High}\right]\) ，&lt;div&gt;&lt;/div&gt;&lt;div&gt;在计算动作值时都应该使用 clip 函数限制范围：\(\textcolor{red}{a} = \text{clip} (\pi,&amp;nbsp;a_{Low},&amp;nbsp;a_{High})\) ；&lt;/div&gt;&lt;div&gt;无论是使用确定策略还是通过分布抽样，抑或是计算 target action 时。&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=15;strokeColor=#CCCCCC;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="600" y="-400" width="340" height="100" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-292" value="&lt;h1&gt;&lt;span style=&quot;box-sizing: border-box; font-size: 25px;&quot;&gt;参考资料&lt;/span&gt;&lt;br&gt;&lt;/h1&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/wangshusen/DRL/tree/master/Notes_CN&quot;&gt;《深度强化学习》王树森&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/wangshusen/DRL&quot;&gt;深度强化学习课程&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://stable-baselines3.readthedocs.io/&quot;&gt;Stable-Baselines3&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://spinningup.openai.com/en/latest/index.html&quot;&gt;Open AI Spinning Up in Deep RL&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://www.youtube.com/watch?v=5P7I-xPq8u8&quot;&gt;PPO explanation&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;" style="text;html=1;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontFamily=更纱黑体 SC;strokeColor=#B3B3B3;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="-720" y="300" width="360" height="180" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-293" value="&lt;p&gt;This work by &lt;a href=&quot;https://github.com/liuzhaoze&quot; rel=&quot;cc:attributionURL dct:creator&quot;&gt;liuzhaoze&lt;/a&gt; is licensed under &lt;a style=&quot;display:inline-block;&quot; rel=&quot;license noopener noreferrer&quot; target=&quot;_blank&quot; href=&quot;https://creativecommons.org/licenses/by-nc-nd/4.0/?ref=chooser-v1&quot;&gt;CC BY-NC-ND 4.0&lt;img alt=&quot;&quot; src=&quot;https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1&quot; style=&quot;height:25px!important;margin-left:3px;vertical-align:text-bottom;&quot;&gt;&lt;img alt=&quot;&quot; src=&quot;https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1&quot; style=&quot;height:25px!important;margin-left:3px;vertical-align:text-bottom;&quot;&gt;&lt;img alt=&quot;&quot; src=&quot;https://mirrors.creativecommons.org/presskit/icons/nc.svg?ref=chooser-v1&quot; style=&quot;height:25px!important;margin-left:3px;vertical-align:text-bottom;&quot;&gt;&lt;img alt=&quot;&quot; src=&quot;https://mirrors.creativecommons.org/presskit/icons/nd.svg?ref=chooser-v1&quot; style=&quot;height:25px!important;margin-left:3px;vertical-align:text-bottom;&quot;&gt;&lt;/a&gt;&lt;/p&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=25;strokeColor=default;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="3080" y="1020" width="900" height="100" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-294" value="&lt;a href=&quot;https://liuzhaoze.github.io/&quot; style=&quot;font-size: 25px;&quot;&gt;个人主页&lt;/a&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;fontSize=25;strokeColor=#B3B3B3;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="-720" y="250" width="360" height="50" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-295" value="价值学习" style="shape=ext;double=1;rounded=0;whiteSpace=wrap;html=1;fontFamily=更纱黑体 SC;fontStyle=1;fontSize=20;fillColor=none;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="60" y="565" width="180" height="50" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-296" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.66;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-104" target="KOUpriuUwOJteqnQQ4VB-108" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-297" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.33;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-30" target="KOUpriuUwOJteqnQQ4VB-108" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-298" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;resizable=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-299" target="KOUpriuUwOJteqnQQ4VB-58" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-299" value="策略学习" style="shape=ext;double=1;rounded=0;whiteSpace=wrap;html=1;fontFamily=更纱黑体 SC;fontStyle=1;fontSize=20;fillColor=none;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="1120" y="95" width="180" height="50" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-300" value="&lt;b&gt;DQN高级技巧：Double DQN&lt;/b&gt;&lt;br&gt;在计算 TD target 时&lt;br&gt;&lt;ul&gt;&lt;li&gt;先使用 DQN 选择动作 \(\textcolor{red}{a^{\star}} = \mathop{\text{argmax}}\limits_{\textcolor{red}{a}} \, Q(\textcolor{green}{s_{t+1}}, \textcolor{red}{a}; \omega_t)\)&lt;/li&gt;&lt;li&gt;再使用 target network 计算 TD target \(y_t = \textcolor{blue}{r_t} + \gamma \cdot Q(\textcolor{green}{s_{t+1}}, \textcolor{red}{a^{\star}}; \omega_t^-)\)&lt;/li&gt;&lt;/ul&gt;缓解自举（bootstrap）更新网络参数导致的高估问题" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=更纱黑体 SC;strokeColor=default;dashed=1;" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="-720" y="830" width="500" height="120" as="geometry" />
        </mxCell>
        <mxCell id="KOUpriuUwOJteqnQQ4VB-301" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.75;entryDx=0;entryDy=0;entryPerimeter=0;fontFamily=更纱黑体 SC;fontSize=12;fontColor=default;labelBackgroundColor=default;resizable=0;" parent="KOUpriuUwOJteqnQQ4VB-1" source="KOUpriuUwOJteqnQQ4VB-300" target="KOUpriuUwOJteqnQQ4VB-46" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-0" value="1" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="40" y="255" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-1" value="2" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="170" y="255" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-2" value="3" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="460" y="260" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-3" value="4" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="405" y="385" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-4" value="5" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="405" y="525" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-5" value="6" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="1060" y="385" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-6" value="7" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="35" y="495" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-7" value="8" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="35" y="565" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-8" value="9" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="-140" y="615" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-9" value="10" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="1020" y="260" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-10" value="11" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="1095" y="125" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-11" value="12" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="920" y="65" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-12" value="13" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="920" y="-15" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-13" value="14" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="1720" y="-10" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-14" value="15" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="2240" y="-10" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-15" value="16" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="2240" y="115" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-16" value="17" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="2360" y="205" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-17" value="18" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="2740" y="250" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-18" value="19" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="3180" y="200" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-19" value="20" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="3055" y="-110" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-20" value="21" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="3515" y="-40" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-21" value="22" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="595" y="860" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-22" value="23" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="-745" y="530" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-23" value="24" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="-745" y="680" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-24" value="25" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="-745" y="830" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-25" value="26" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="1060" y="525" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-26" value="27" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="805" y="575" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-27" value="28" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="860" y="665" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-28" value="29" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="830" y="780" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-29" value="30" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="480" y="745" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-30" value="31" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="445" y="880" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-31" value="32" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="1755" y="60" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-32" value="33" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="2240" y="325" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-33" value="34" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="2240" y="425" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-34" value="35" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="2240" y="525" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-35" value="36" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="2740" y="420" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-36" value="37" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="3180" y="520" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-37" value="38" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="3515" y="320" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-38" value="39" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="1475" y="430" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-39" value="40" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="1475" y="530" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-40" value="41" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="1475" y="660" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-41" value="42" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="1475" y="790" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-42" value="43" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="2320" y="715" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-43" value="44" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="2320" y="850" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-44" value="45" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="3065" y="875" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-45" value="46" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="3540" y="900" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-46" value="47" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="500" y="-15" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-47" value="48" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="920" y="-200" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-48" value="49" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="1695" y="-390" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-49" value="50" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="370" y="-320" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-51" value="51" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="-270" y="-325" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-52" value="52" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="-270" y="-475" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-53" value="53" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="-270" y="-575" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-54" value="54" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="-465" y="-960" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-55" value="55" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="295" y="-960" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-56" value="56" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="855" y="-960" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-57" value="57" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="1375" y="-960" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-58" value="58" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="2005" y="-960" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-59" value="59" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="2445" y="-960" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-60" value="60" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="2905" y="-960" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="2ms52rcBJpAuIR6ilgLE-61" value="61" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=更纱黑体 SC;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" parent="KOUpriuUwOJteqnQQ4VB-1" vertex="1">
          <mxGeometry x="2800" y="-825" width="20" height="20" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
